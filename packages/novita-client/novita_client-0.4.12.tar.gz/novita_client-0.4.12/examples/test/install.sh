#!/bin/bash

apt update 
apt install -y openssh-server bash wget 

echo "PermitRootLogin yes
PubkeyAuthentication yes
PasswordAuthentication yes" >> /etc/ssh/sshd_config

mkdir -p /root/.ssh/

echo "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDLxkaH+d0Q4jhri8xYaBcmCunZZtaMtqqk1mnIlKXZMfA5PdeUiFUpr231uDvUjyoNGzl5lDFBBmq/TCUSlSHg7W/t6zP76pSwC2gjFIjasg1/vv3Z1Wa2RDMEGIuA0RQ+IC1Inv9cDshZ57JlN+zKqoKGNY82ao0mQydmCN58WsdtDh3tVtMHuFzDHtgizFfCo6M0Zzb3HwGVPC0ryZIk193jsHnGicL+OJ/pIQA9G7vosNsslc5T/2x3pd6dxJVBubx8fGHOxhTGHcIErq3eysdNAaq9fbgmOqw10FUZhDJ0wNCWOZbz05y20ZeC/njvNzekp84bH0X+OtsOkJu77RfCoWEU9OI3dmBEcv8nxJ4fkTVXykcf7KpcAFdyBARwFuZe14s+JdZTnk6DoM2I04e8r44fugnYkrgVAkSUSteIyARkLyoffHNGJAg6RvJlpYZszX9F07LDWsSafJI91QQYZHRanwUAb5UW09NqKrGBFDvPaVcu136AxRZON8E= yanghu@localhost
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDOdVNAjbPNJdaRYlKr35szB4DT426cmGFTY3SP0M+ediI/NBZVlA2rLbtA1ZhoyVPtVeewAiCgUVYE8c0T8KQr9hhnnPwxyW4TeAH752RA0Uuec98d4S4MCggwPrQKQZox6uVzVBDHdConrK1CFcmOG9vyhUScHl4f8WQc+o0S3+s6XXrUNEF19HLleo+fnSaIm6g2RNRZUWe4657ExqN7sUwBSnyHPH+6nnEBQ3Fm0+R0VkMEqx8wco/Flgn7beBVP/RpUXiSEpAiSC8ap1WFrkUld9SkEVQraSwIEHW//VCv7/QjHfhlD5Zq9ba93DJQyXxiviCcXmArF712+xBf kaite@pplabs.org
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC6ls1XfJoeEav0CyWvi2QfdPaDlVWt9fnTW4uW9yhEdh+OkmGIVwpFbkNSIuQh1AHF9fzCs/PLFzMUKETCrQna7mF/smTNBnS8F36MdnC/Gl5vbL5cmSTcVt1/h7XpUazXwVJGf2tu0RDZdFxao8Z8tSfeh7//c9wgNQN089zailbziSELhTAEAXbEPi61g6/ksVGZ+Ck/LqfbYSd2DXMAbuzFH7ilOE+ML/xaEzu+Bks56QEJaXTRnhqnkzZif2V918izwQyt88+2VILT4fdMn5R3wF2GeWUGj6tpQQHCuK4xT1R6S+0kxb5JU9NfZzJEWEq7lj1bZ02ZWBymBKBf junmoxiao-mac
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDnDyCoZ6j6/kN+mVrnjaFlaefB2yhN8BXOIDsAo+i2YBhIb7/CGdzy9xxpq4d0qs2TLGcrFqrZONTlwZGtI7meUWrGzbTmOhshgPSWkkdfWm5LdOLCXH/iOuVIUEKtnHeOa2aR9O62nWB5QI+EHaNpSqnuxaVqczMMdBW2kxs99bGSRR0JybVLCPtgnTZud5wNKPUcnvgFNLgrSFhkChn6s1ZBms0Q+bmVwE15yGIoZ4pvuMcbSFFifIezdUAIaKkK6/c68+iDbGVnwegvbs8D023a16fyTFyFBiH7/xjPt6QbvVYZjumEwgvoz+Kj8m51G2xHi17pWiU1OHMkzu4jkIuJxQ3PHhkEwH/W0jdv2LP5D4ZBKysoidWj9ZUXpG8FcR9PD3FuIrIRGb5mVrY2IsY7C3qn73qw3ojyBcK8KFk0v87jHZ1+UkKL8MFwCv9JEgn6cQPzrKxbhfImqGfnRjMq2fnlophqB5JMN2JUXiauU9jzh1gf+F1FTiRGZgs= viktorhu@foxmail.com
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC6f9tSnnFnEzMifZWrkdTKAY03xrmPtcCM6LjEh0UkOXtfv58nYLO1TuJAdXlF+R0DyVBoSNNHguBo/Y2u68jjKBCSgk2w6gKraXaMdzqpXPOHcJ7iPaBVXrpwyE+ta2EeQWGac5MJoqtCyM1IsLF7MVJyq1R9pA5qct0O4rqqAU/k+k7/DVW2eFhCn8S/meV/eM76uSEVtb0djG+8Vl/JSAE9o48wIaHbqiuQm/DZy0Jol5nMiL4GQZ/6qDTWujAPraz+8ACbdwL0QWP8JS6Q83LrQ0IeKx1w8iIg5dvl67qelVFHUSfapI6yeD1zQLMHFNcd0hRz40NjInerlABHhDQE5XGcFiRwsHtZ4nafsPXWL4cot51KGiErr55ct3ijrhzs0ihcFd8B2vaQIe3mQpqBwlXlEFIzDpwoy9K0o3EgqUgLUkpvuUsjeLgJGsVtkG1w/ngbwUmk7gFV0wJ5shZBqNo0TYLN/3fopVfwzIBZAshYFKA/3YgDvX6DYq0= PC@LAPTOP-3SQA9IG8" > ~/.ssh/authorized_keys


cat > /workspace/github-pull <<EOF
-----BEGIN OPENSSH PRIVATE KEY-----
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
Lm5ldA==
-----END OPENSSH PRIVATE KEY-----
EOF


wget https://infra-aigc-prod-sd.s3.ap-southeast-1.amazonaws.com/npipe/bin/npipe -O /usr/local/bin/npipe
chmod +x /usr/local/bin/npipe

# /usr/local/bin/npipe p -s kcp://k8s-npipe-npiperel-0d8d225ac0-0ec90ff4d05a715d.elb.ap-southeast-1.amazonaws.com:7184 -n huggingface-001

