{"version":3,"file":"draftReviewRequestModelTests.js","names":["suite","draft","callbacks","beforeEach","reviewRequest","RB","ReviewRequest","id","links","href","success","error","spyOn","and","callFake","options","context","ready","call","it","expect","url","toBe","callThrough","$","request","data","public","stat","set","targetGroups","name","summary","description","publish","not","toHaveBeenCalled","apiCall","ajax","parse","branch","bugs_closed","changedescription","changedescription_text_type","description_text_type","target_groups","target_people","testing_done","testing_done_text_type","submitter","undefined","bugsClosed","changeDescription","changeDescriptionRichText","descriptionRichText","targetPeople","testingDone","testingDoneRichText"],"sources":["draftReviewRequestModelTests.es6.js"],"sourcesContent":["suite('rb/resources/models/DraftReviewRequest', function() {\n    let draft;\n    let callbacks;\n\n    beforeEach(function() {\n        const reviewRequest = new RB.ReviewRequest({\n            id: 1,\n            links: {\n                draft: {\n                    href: '/api/review-requests/123/draft/',\n                },\n            },\n        });\n\n        draft = reviewRequest.draft;\n\n        callbacks = {\n            success: function() {},\n            error: function() {},\n        };\n\n        spyOn(callbacks, 'success');\n        spyOn(callbacks, 'error');\n\n        spyOn(reviewRequest, 'ready').and.callFake(\n            (options, context) => options.ready.call(context));\n\n        spyOn(reviewRequest, 'ensureCreated').and.callFake(\n            (options, context) => options.success.call(context));\n\n        spyOn(draft, 'ready').and.callFake(\n            (options, context) => options.ready.call(context));\n    });\n\n    it('url', function() {\n        expect(draft.url()).toBe('/api/review-requests/123/draft/');\n    });\n\n    it('publish', function() {\n        spyOn(RB, 'apiCall').and.callThrough();\n        spyOn($, 'ajax').and.callFake(request => {\n            expect(request.data.public).toBe(1);\n\n            request.success({\n                stat: 'ok',\n                draft: {\n                    id: 1,\n                    links: {},\n                },\n            });\n        });\n\n        /* Set some fields in order to pass validation. */\n        draft.set({\n            targetGroups: [{\n                name: 'mygroup',\n                url: '/groups/mygroup',\n            }],\n            summary: 'My summary',\n            description: 'My description',\n        });\n\n        draft.publish({\n            success: callbacks.success,\n            error: callbacks.error,\n        });\n\n        expect(callbacks.error).not.toHaveBeenCalled();\n        expect(callbacks.success).toHaveBeenCalled();\n        expect(RB.apiCall).toHaveBeenCalled();\n        expect($.ajax).toHaveBeenCalled();\n    });\n\n    it('parse', function() {\n        const data = draft.parse({\n            stat: 'ok',\n            draft: {\n                id: 1,\n                branch: 'branch',\n                bugs_closed: 'bugsClosed',\n                changedescription: 'changeDescription',\n                changedescription_text_type: 'markdown',\n                description: 'description',\n                'public': 'public',\n                description_text_type: 'markdown',\n                summary: 'summary',\n                target_groups: 'targetGroups',\n                target_people: 'targetPeople',\n                testing_done: 'testingDone',\n                testing_done_text_type: 'plain',\n                links: {\n                    submitter: 'submitter',\n                },\n            },\n        });\n\n        expect(data).not.toBe(undefined);\n        expect(data.id).toBe(1);\n        expect(data.branch).toBe('branch');\n        expect(data.bugsClosed).toBe('bugsClosed');\n        expect(data.changeDescription).toBe('changeDescription');\n        expect(data.changeDescriptionRichText).toBe(true);\n        expect(data.description).toBe('description');\n        expect(data.descriptionRichText).toBe(true);\n        expect(data.public).toBe('public');\n        expect(data.summary).toBe('summary');\n        expect(data.submitter).toBe('submitter');\n        expect(data.targetGroups).toBe('targetGroups');\n        expect(data.targetPeople).toBe('targetPeople');\n        expect(data.testingDone).toBe('testingDone');\n        expect(data.testingDoneRichText).toBe(false);\n    });\n});\n"],"mappings":"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"}