{"version":3,"file":"reviewablePageView.js","names":["UpdatesBubbleView","Backbone","View","extend","id","template","_","join","events","initialize","options","render","$el","html","defaults","updatePageText","gettext","ignoreText","updateInfo","hide","open","css","fadeIn","close","trigger","fadeOut","bind","remove","_onUpdatePageClicked","e","preventDefault","stopPropagation","_onIgnoreClicked","RB","ReviewablePageView","PageView","prototype","apply","arguments","DnDUploader","create","reviewRequestEditorView","ReviewRequestEditorView","el","$","model","reviewRequestEditor","_updatesBubble","_favIconURL","_favIconNotifyURL","_logoNotificationsURL","forEach","attrName","get","listenTo","NotificationManager","instance","setup","UserSession","_starManager","StarManagerView","StarManager","parent","_onReviewRequestUpdated","call","$favicon","find","attr","STATIC_URLS","pendingReview","draftReviewBanner","DraftReviewBannerView","hideAndReload","_super","info","_updateFavIcon","shouldNotify","_showDesktopNotification","_showUpdatesBubble","reviewRequest","window","location","appendTo","notify","title","summary","body","interpolate","user","fullname","username","iconURL","onClick","url","end","append","href","rel","type","_onEditReviewClicked","ReviewDialogView","review","_onAddCommentClicked","comment","createGeneralComment","undefined","show","CommentDialogView","_onShipItClicked","confirm","markShipIt","_onMenuClicked"],"sources":["reviewablePageView.es6.js"],"sourcesContent":["(function() {\n\n\n/**\n * An update bubble showing an update to the review request or a review.\n */\nconst UpdatesBubbleView = Backbone.View.extend({\n    id: 'updates-bubble',\n\n    template: _.template([\n        '<span id=\"updates-bubble-summary\"><%- summary %></span>',\n        ' by ',\n        '<a href=\"<%- user.url %>\" id=\"updates-bubble-user\">',\n        '<%- user.fullname || user.username %>',\n        '</a>',\n        '<span id=\"updates-bubble-buttons\">',\n        ' <a href=\"#\" class=\"update-page\"><%- updatePageText %></a>',\n        ' | ',\n        ' <a href=\"#\" class=\"ignore\"><%- ignoreText %></a>',\n    ].join('')),\n\n    events: {\n        'click .update-page': '_onUpdatePageClicked',\n        'click .ignore': '_onIgnoreClicked',\n    },\n\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     updateInfo (object):\n     *         Information about the update, fetched from the server.\n     */\n    initialize(options) {\n        this.options = options;\n    },\n\n    /**\n     * Render the bubble with the information provided during construction.\n     *\n     * The bubble starts hidden. The caller must call open() to display it.\n     *\n     * Returns:\n     *     UpdatesBubbleView:\n     *     This object, for chaining.\n     */\n    render() {\n        this.$el\n            .html(this.template(_.defaults({\n                updatePageText: gettext('Update Page'),\n                ignoreText: gettext('Ignore'),\n            }, this.options.updateInfo)))\n            .hide();\n\n        return this;\n    },\n\n    /**\n     * Open the bubble on the screen.\n     */\n    open() {\n        this.$el\n            .css('position', 'fixed')\n            .fadeIn();\n    },\n\n    /**\n     * Close the update bubble.\n     *\n     * After closing, the bubble will be removed from the DOM.\n     */\n    close() {\n        this.trigger('closed');\n        this.$el.fadeOut(_.bind(this.remove, this));\n    },\n\n    /**\n     * Handle clicks on the \"Update Page\" link.\n     *\n     * Loads the review request page.\n     *\n     * Args:\n     *     e (Event):\n     *         The event which triggered the action.\n     */\n    _onUpdatePageClicked(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        this.trigger('updatePage');\n    },\n\n    /*\n     * Handle clicks on the \"Ignore\" link.\n     *\n     * Ignores the update and closes the page.\n     *\n     * Args:\n     *     e (Event):\n     *         The event which triggered the action.\n     */\n    _onIgnoreClicked(e) {\n        e.preventDefault();\n        e.stopPropagation();\n\n        this.close();\n    },\n});\n\n\n/**\n * A page managing reviewable content for a review request.\n *\n * This provides common functionality for any page associated with a review\n * request, such as the diff viewer, review UI, or the review request page\n * itself.\n */\nRB.ReviewablePageView = RB.PageView.extend({\n    events: _.defaults({\n        'click #review-action': '_onEditReviewClicked',\n        'click #ship-it-action': '_onShipItClicked',\n        'click #general-comment-action': '_onAddCommentClicked',\n        'click .has-menu .has-menu': '_onMenuClicked',\n    }, RB.PageView.prototype.events),\n\n    /**\n     * Initialize the page.\n     *\n     * This will construct a ReviewRequest, CommentIssueManager,\n     * ReviewRequestEditor, and other required objects, based on data\n     * provided during construction.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the view.\n     *\n     * Option Args:\n     *     reviewRequestData (object):\n     *         The model attributes for a new RB.ReviewRequest instance.\n     *\n     *     editorData (object):\n     *         The model attributes for a new RB.ReviewRequestEditor instance.\n     *\n     *     lastActivityTimestamp (string):\n     *         The last known timestamp for activity on this review request.\n     *\n     *     checkUpdatesType (string, optional):\n     *         The type of updates to check for.\n     */\n    initialize(options) {\n        RB.PageView.prototype.initialize.apply(this, arguments);\n\n        this.options = options;\n\n        RB.DnDUploader.create();\n\n        this.reviewRequestEditorView = new RB.ReviewRequestEditorView({\n            el: $('#review-request'),\n            model: this.model.reviewRequestEditor,\n        });\n\n        this._updatesBubble = null;\n        this._favIconURL = null;\n        this._favIconNotifyURL = null;\n        this._logoNotificationsURL = null;\n\n        /*\n         * Some extensions, like Power Pack and rbstopwatch, expect a few legacy\n         * attributes on the view. Set these here so these extensions can access\n         * them. Note that extensions should ideally use the new form, if\n         * they're able to support Review Board 3.0+.\n         */\n        ['reviewRequest', 'pendingReview'].forEach(attrName => {\n            this[attrName] = this.model.get(attrName);\n\n            this.listenTo(this.model, `change:${attrName}`, () => {\n                this[attrName] = this.model.get(attrName);\n            });\n        });\n\n        /*\n         * Allow the browser to report notifications, if the user has this\n         * enabled.\n         */\n        RB.NotificationManager.instance.setup();\n\n        if (RB.UserSession.instance.get('authenticated')) {\n            this._starManager = new RB.StarManagerView({\n                model: new RB.StarManager(),\n                el: this.$('.star').parent(),\n            });\n        }\n\n        this.listenTo(this.model, 'reviewRequestUpdated',\n                      this._onReviewRequestUpdated);\n    },\n\n    /**\n     * Render the page.\n     *\n     * Returns:\n     *     RB.ReviewablePageView:\n     *     This object, for chaining.\n     */\n    render() {\n        RB.PageView.prototype.render.call(this);\n\n        const $favicon = $('head').find('link[rel=\"shortcut icon\"]');\n\n        this._favIconURL = $favicon.attr('href');\n        this._favIconNotifyURL = STATIC_URLS['rb/images/favicon_notify.ico'];\n        this._logoNotificationsURL = STATIC_URLS['rb/images/logo.png'];\n\n        const pendingReview = this.model.get('pendingReview');\n\n        this.draftReviewBanner = RB.DraftReviewBannerView.create({\n            el: $('#review-banner'),\n            model: pendingReview,\n            reviewRequestEditor: this.model.reviewRequestEditor,\n        });\n\n        this.listenTo(pendingReview, 'destroy published',\n                      () => this.draftReviewBanner.hideAndReload());\n\n        this.reviewRequestEditorView.render();\n\n        return this;\n    },\n\n    /**\n     * Remove this view from the page.\n     */\n    remove() {\n        this.draftReviewBanner.remove();\n        _super(this).remove.call(this);\n    },\n\n    /**\n     * Catch the review updated event and send the user a visual update.\n     *\n     * This function will handle the review updated event and decide whether\n     * to send a notification depending on browser and user settings.\n     *\n     * Args:\n     *     info (object):\n     *         The last update information for the request.\n     */\n    _onReviewRequestUpdated(info) {\n        this._updateFavIcon(this._favIconNotifyURL);\n\n        if (RB.NotificationManager.instance.shouldNotify()) {\n            this._showDesktopNotification(info);\n        }\n\n        this._showUpdatesBubble(info);\n    },\n\n    /**\n     * Create the updates bubble showing information about the last update.\n     *\n     * Args:\n     *     info (object):\n     *         The last update information for the request.\n     */\n    _showUpdatesBubble(info) {\n        if (this._updatesBubble) {\n            this._updatesBubble.remove();\n        }\n\n        const reviewRequest = this.model.get('reviewRequest');\n\n        this._updatesBubble = new UpdatesBubbleView({\n            updateInfo: info,\n            reviewRequest: reviewRequest,\n        });\n\n        this.listenTo(this._updatesBubble, 'closed',\n                      () => this._updateFavIcon(this._favIconURL));\n\n        this.listenTo(this._updatesBubble, 'updatePage', () => {\n            window.location = reviewRequest.get('reviewURL');\n        });\n\n        this._updatesBubble.render().$el.appendTo(this.$el);\n        this._updatesBubble.open();\n    },\n\n    /**\n     * Show the user a desktop notification for the last update.\n     *\n     * This function will create a notification if the user has not\n     * disabled desktop notifications and the browser supports HTML5\n     * notifications.\n     *\n     *  Args:\n     *     info (object):\n     *         The last update information for the request.\n     */\n    _showDesktopNotification(info) {\n        const reviewRequest = this.model.get('reviewRequest');\n\n        RB.NotificationManager.instance.notify({\n            title: info.summary,\n            body: interpolate(gettext('Review request #%s, by %s'), [\n                reviewRequest.id,\n                info.user.fullname || info.user.username,\n            ]),\n            iconURL: this._logoNotificationsURL,\n            onClick: () => {\n                window.location = reviewRequest.get('reviewURL');\n            },\n        });\n    },\n\n    /**\n     * Update the favicon for the page.\n     *\n     * This is used to change the favicon shown on the page based on whether\n     * there's a server-side update notification for the review request.\n     */\n    _updateFavIcon(url) {\n        $('head')\n            .find('link[rel=\"shortcut icon\"]')\n                .remove()\n            .end()\n            .append($('<link/>')\n                .attr({\n                    href: url,\n                    rel: 'shortcut icon',\n                    type: 'image/x-icon',\n                }));\n    },\n\n    /**\n     * Handle a click on the \"Edit Review\" button.\n     *\n     * Displays a review dialog.\n     *\n     * Returns:\n     *    boolean:\n     *    false, always.\n     */\n    _onEditReviewClicked() {\n        RB.ReviewDialogView.create({\n            review: this.model.get('pendingReview'),\n            reviewRequestEditor: this.model.reviewRequestEditor,\n        });\n\n        return false;\n    },\n\n    /**\n     * Handle a click on the \"Add Comment\" button.\n     *\n     * Displays a comment dialog.\n     *\n     * Returns:\n     *    boolean:\n     *    false, always.\n     */\n    _onAddCommentClicked() {\n        const pendingReview = this.model.get('pendingReview');\n        const comment = pendingReview.createGeneralComment(\n            undefined,\n            RB.UserSession.instance.get('commentsOpenAnIssue'));\n\n        this.listenTo(comment, 'saved',\n                      () => RB.DraftReviewBannerView.instance.show());\n\n        RB.CommentDialogView.create({\n            comment: comment,\n            reviewRequestEditor: this.model.reviewRequestEditor,\n        });\n\n        return false;\n    },\n\n    /**\n     * Handle a click on the \"Ship It\" button.\n     *\n     * Confirms that the user wants to post the review, and then posts it\n     * and reloads the page.\n     *\n     * Returns:\n     *    boolean:\n     *    false, always.\n     */\n    _onShipItClicked() {\n        if (confirm(gettext('Are you sure you want to post this review?'))) {\n            this.model.markShipIt();\n        }\n\n        return false;\n    },\n\n    /**\n     * Generic handler for menu clicks.\n     *\n     * This simply prevents the click from bubbling up or invoking the\n     * default action. This function is used for dropdown menu titles\n     * so that their links do not send a request to the server when one\n     * of their dropdown actions are clicked.\n     *\n     * Args:\n     *     e (Event):\n     *         The event which triggered the action.\n     */\n    _onMenuClicked(e) {\n        e.preventDefault();\n        e.stopPropagation();\n    },\n});\n\n\n})();\n"],"mappings":"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"}