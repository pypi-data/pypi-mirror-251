{"version":3,"file":"diffCommentsHintView.js","names":["RB","DiffCommentsHintView","Backbone","View","extend","events","template","_","initialize","listenTo","model","render","revisionText","gettext","interdiffText","get","$el","html","unpublishedCommentsHeader","unpublishedCommentsText","$ul","$","forEach","diffset","$li","addClass","data","revision","text","interpolate","appendTo","isCurrent","interdiff","oldRevision","newRevision","empty","_onRevisionSelected","ev","$target","currentTarget","hasClass","trigger","_onInterdiffSelected"],"sources":["../../../../../../static/rb/js/diffviewer/views/diffCommentsHintView.es6.js"],"sourcesContent":["/**\n * A view which gives the user hints about comments in other revisions.\n */\nRB.DiffCommentsHintView = Backbone.View.extend({\n    events: {\n        'click .revision': '_onRevisionSelected',\n        'click .interdiff': '_onInterdiffSelected',\n    },\n\n    template: _.template(dedent`\n        <div class=\"box-container\">\n         <div class=\"box important\">\n          <div class=\"box-inner comments-hint\">\n           <h1><%- unpublishedCommentsHeader %></h1>\n           <p><%- unpublishedCommentsText %></p>\n           <ul>\n           </ul>\n          </div>\n         </div>\n        </div>\n    `),\n\n    /**\n     * Initialize the view.\n     */\n    initialize() {\n        this.listenTo(this.model, 'change', this.render);\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.DiffCommentsHintView:\n     *     This object, for chaining.\n     */\n    render() {\n        const revisionText = gettext('Revision %s');\n        const interdiffText = gettext('Interdiff revision %(oldRevision)s - %(newRevision)s');\n\n        if (this.model.get('hasOtherComments')) {\n            this.$el.html(this.template({\n                unpublishedCommentsHeader: gettext('You have unpublished comments on other revisions'),\n                unpublishedCommentsText: gettext('Your review consists of comments on the following revisions:')\n            }));\n\n            const $ul = this.$('ul');\n\n            this.model.get('diffsetsWithComments').forEach(diffset => {\n                const $li = $('<li/>')\n                    .addClass('revision')\n                    .data('revision', diffset.revision)\n                    .text(interpolate(revisionText, [diffset.revision]))\n                    .appendTo($ul);\n\n                if (diffset.isCurrent) {\n                    $li.addClass('current');\n                }\n            });\n\n            this.model.get('interdiffsWithComments').forEach(interdiff => {\n                const $li = $('<li/>')\n                    .addClass('interdiff')\n                    .data({\n                        'first-revision': interdiff.oldRevision,\n                        'second-revision': interdiff.newRevision\n                    })\n                    .text(interpolate(\n                        interdiffText,\n                        {\n                            oldRevision: interdiff.oldRevision,\n                            newRevision: interdiff.newRevision\n                        },\n                        true))\n                    .appendTo($ul);\n\n                if (interdiff.isCurrent) {\n                    $li.addClass('current');\n                }\n            });\n        } else {\n            this.$el.empty();\n        }\n\n        return this;\n    },\n\n    /**\n     * Callback for when a single revision is selected.\n     *\n     * Args:\n     *     ev (Event):\n     *         The click event.\n     */\n    _onRevisionSelected(ev) {\n        const $target = $(ev.currentTarget);\n\n        if (!$target.hasClass('current')) {\n            this.trigger('revisionSelected', [0, $target.data('revision')]);\n        }\n    },\n\n    /**\n     * Callback for when an interdiff is selected.\n     *\n     * Args:\n     *     ev (Event):\n     *         The click event.\n     */\n    _onInterdiffSelected(ev) {\n        const $target = $(ev.currentTarget);\n\n        if (!$target.hasClass('current')) {\n            this.trigger('revisionSelected',\n                         [$target.data('first-revision'),\n                          $target.data('second-revision')]);\n        }\n    }\n});\n"],"mappings":"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"}