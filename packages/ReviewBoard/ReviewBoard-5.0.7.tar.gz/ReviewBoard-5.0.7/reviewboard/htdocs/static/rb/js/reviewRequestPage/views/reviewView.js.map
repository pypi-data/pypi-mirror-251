{"version":3,"file":"reviewView.js","names":["RB","ReviewRequestPage","ReviewView","Backbone","View","extend","initialize","options","entryModel","_bannerView","_draftBannerShown","_openIssueCount","_reviewReply","_replyEditors","_replyEditorViews","_replyDraftsCount","_diffFragmentViews","_$reviewComments","_$bodyTop","_$bodyBottom","model","set","_setupNewReply","listenTo","get","forEach","view","hideControls","render","reviewRequestEditor","$","$comment","find","on","hasDraft","_showReplyDraftBanner","_hideReplyDraftBanner","_","each","el","$issueState","length","issueStatus","data","BaseComment","isStateOpen","issueBar","CommentIssueBarView","reviewID","id","canVerify","commentID","commentType","interactive","oldStatus","newStatus","oldOpen","newOpen","trigger","$el","editor","ReviewReplyEditor","anchorPrefix","contextID","contextType","review","reviewReply","ReviewReplyEditorView","push","page","PageManager","getPage","diffCommentsData","i","diffCommentData","queueLoadDiff","reviewRequest","bugTrackerURL","formatText","_onBodyTopChanged","_onBodyBottomChanged","_onBodyTopRichTextChanged","_onBodyBottomRichTextChanged","html","bodyTop","addClass","removeClass","bodyBottom","closest","setVisible","hasOpenIssues","getOpenIssueCount","getReviewReplyEditorView","undefined","getReviewReply","createReply","stopListening","ReviewReplyDraftBannerView","$floatContainer","$bannerFloatContainer","noFloatContainerClass","bannerNoFloatContainerClass","appendTo","$bannerParent","remove"],"sources":["../../../../../../static/rb/js/reviewRequestPage/views/reviewView.es6.js"],"sourcesContent":["/**\n * Handles interaction for a review on the review request page. These can be\n * contained within the main review entries, but also for status updates in\n * change description entries or the initial status updates entry.\n */\nRB.ReviewRequestPage.ReviewView = Backbone.View.extend({\n    /**\n     * Initialize the view.\n     */\n    initialize(options) {\n        this.options = options;\n        this.entryModel = options.entryModel;\n\n        this._bannerView = null;\n        this._draftBannerShown = false;\n        this._openIssueCount = 0;\n        this._reviewReply = null;\n        this._replyEditors = [];\n        this._replyEditorViews = [];\n        this._replyDraftsCount = 0;\n        this._diffFragmentViews = [];\n\n        this._$reviewComments = null;\n        this._$bodyTop = null;\n        this._$bodyBottom = null;\n\n        this.model.set('includeTextTypes', 'html,raw,markdown');\n\n        this._setupNewReply();\n\n        this.listenTo(this.entryModel, 'change:collapsed', () => {\n            if (!this.entryModel.get('collapsed')) {\n                this._diffFragmentViews.forEach(\n                    view => view.hideControls(false));\n            }\n        });\n    },\n\n    /**\n     * Render the view.\n     *\n     * Returns:\n     *     RB.ReviewRequestPage.ReviewView:\n     *     This object, for chaining.\n     */\n    render() {\n        const reviewRequestEditor = this.entryModel.get('reviewRequestEditor');\n\n        this._$reviewComments = this.$('.review-comments');\n\n        const $comment = this._$reviewComments.find(\n            '.review-comment-details .review-comment');\n        this._$bodyTop = $comment.find('.body_top');\n        this._$bodyBottom = $comment.find('.body_bottom');\n\n        this._replyDraftsCount = 0;\n\n        this.on('hasDraftChanged', hasDraft => {\n            if (hasDraft) {\n                this._showReplyDraftBanner();\n            } else {\n                this._hideReplyDraftBanner();\n            }\n        });\n\n        _.each(this._$reviewComments.find('.issue-indicator'), el => {\n            const $issueState = $('.issue-state', el);\n\n            /*\n             * Not all issue-indicator divs have an issue-state div for the\n             * issue bar.\n             */\n            if ($issueState.length > 0) {\n                const issueStatus = $issueState.data('issue-status');\n\n                if (RB.BaseComment.isStateOpen(issueStatus)) {\n                    this._openIssueCount++;\n                }\n\n                const issueBar = new RB.CommentIssueBarView({\n                    el: el,\n                    reviewID: this.model.id,\n                    canVerify: $issueState.data('can-verify'),\n                    commentID: $issueState.data('comment-id'),\n                    commentType: $issueState.data('comment-type'),\n                    interactive: $issueState.data('interactive'),\n                    issueStatus: issueStatus,\n                });\n\n                issueBar.render();\n\n                this.listenTo(issueBar, 'statusChanged',\n                              (oldStatus, newStatus) => {\n                    const oldOpen = RB.BaseComment.isStateOpen(oldStatus);\n                    const newOpen = RB.BaseComment.isStateOpen(newStatus);\n\n                    if (oldOpen !== newOpen) {\n                        if (newOpen) {\n                            this._openIssueCount++;\n                        } else {\n                            this._openIssueCount--;\n                        }\n                    }\n\n                    this.trigger('openIssuesChanged');\n                });\n            }\n        });\n\n        _.each(this.$('.comment-section'), el => {\n            const $el = $(el);\n            const editor = new RB.ReviewRequestPage.ReviewReplyEditor({\n                anchorPrefix: $el.data('reply-anchor-prefix'),\n                contextID: $el.data('context-id'),\n                contextType: $el.data('context-type'),\n                review: this.model,\n                reviewReply: this._reviewReply,\n            });\n\n            const view = new RB.ReviewRequestPage.ReviewReplyEditorView({\n                el: el,\n                model: editor,\n                reviewRequestEditor: reviewRequestEditor,\n            });\n            view.render();\n\n            this.listenTo(editor, 'change:hasDraft', (model, hasDraft) => {\n                if (hasDraft) {\n                    this._replyDraftsCount++;\n                    this.trigger('hasDraftChanged', true);\n                } else {\n                    this._replyDraftsCount--;\n\n                    if (this._replyDraftsCount === 0) {\n                        this.trigger('hasDraftChanged', false);\n                    }\n                }\n            });\n\n            this._replyEditors.push(editor);\n            this._replyEditorViews.push(view);\n\n            if (editor.get('hasDraft')) {\n                this._replyDraftsCount++;\n            }\n        });\n\n        if (this._replyDraftsCount > 0) {\n            this.trigger('hasDraftChanged', true);\n        }\n\n        /*\n         * Load any diff fragments for comments made on this review. Each\n         * will be queued up and loaded when the page is rendered.\n         */\n        this._diffFragmentViews = [];\n\n        const page = RB.PageManager.getPage();\n        const diffCommentsData = this.entryModel.get('diffCommentsData');\n\n        for (let i = 0; i < diffCommentsData.length; i++) {\n            const diffCommentData = diffCommentsData[i];\n\n            page.queueLoadDiff(diffCommentData[0], diffCommentData[1],\n                               view => this._diffFragmentViews.push(view));\n        }\n\n        /*\n         * Do this last, after ReviewReplyEditorView has already set up the\n         * inline editors.\n         */\n        const reviewRequest = this.model.get('parentObject');\n        const bugTrackerURL = reviewRequest.get('bugTrackerURL');\n        _.each(this.$('pre.reviewtext'), el => {\n            RB.formatText($(el), { bugTrackerURL: bugTrackerURL });\n        });\n\n        this.listenTo(this.model, 'change:bodyTop',\n                      this._onBodyTopChanged);\n        this.listenTo(this.model, 'change:bodyBottom',\n                      this._onBodyBottomChanged);\n        this.listenTo(this.model, 'change:bodyTopRichText',\n                      this._onBodyTopRichTextChanged);\n        this.listenTo(this.model, 'change:bodyBottomRichText',\n                      this._onBodyBottomRichTextChanged);\n\n        return this;\n    },\n\n    /**\n     * Handler for when the Body Top field of a review changes.\n     *\n     * Updates the HTML for the field to show the new content.\n     */\n    _onBodyTopChanged() {\n        this._$bodyTop.html(this.model.get('htmlTextFields').bodyTop);\n    },\n\n    /**\n     * Handler for when the Body Top's Rich Text field of a review changes.\n     *\n     * Updates the class on the field to reflect the Rich Text state.\n     */\n    _onBodyTopRichTextChanged() {\n        if (this.model.get('bodyTopRichText')) {\n            this._$bodyTop.addClass('rich-text');\n        } else {\n            this._$bodyTop.removeClass('rich-text');\n        }\n    },\n\n    /**\n     * Handler for when the Body Bottom field of a review changes.\n     *\n     * Updates the HTML for the field to show the new content. The visibility\n     * of the body section will also be dependent on whether there is any\n     * content (mimicking the logic used when rendering the page).\n     */\n    _onBodyBottomChanged() {\n        const html = this.model.get('htmlTextFields').bodyBottom;\n\n        this._$bodyBottom\n            .html(html)\n            .closest('li').setVisible(html && html.length > 0);\n    },\n\n    /**\n     * Handler for when the Body Bottom's Rich Text field of a review changes.\n     *\n     * Updates the class on the field to reflect the Rich Text state.\n     */\n    _onBodyBottomRichTextChanged() {\n        if (this.model.get('bodyBottomRichText')) {\n            this._$bodyBottom.addClass('rich-text');\n        } else {\n            this._$bodyBottom.removeClass('rich-text');\n        }\n    },\n\n    /**\n     * Return whether there are any open issues in the review.\n     *\n     * Returns:\n     *     boolean:\n     *     true if there are any open issues.\n     */\n    hasOpenIssues() {\n        return this._openIssueCount > 0;\n    },\n\n    /**\n     * Return the number of open issues in the review.\n     *\n     * Returns:\n     *     number:\n     *     The number of open issues.\n     */\n    getOpenIssueCount() {\n        return this._openIssueCount;\n    },\n\n    /**\n     * Return the ReviewReplyEditorView with the given context type and ID.\n     *\n     * Args:\n     *     contextType (string):\n     *         The type of object being replied to (such as ``body_top`` or\n     *         ``diff_comments``)\n     *\n     *     contextID (number, optional):\n     *         The ID of the comment being replied to, if appropriate.\n     *\n     * Returns:\n     *     RB.ReviewRequestPage.ReviewReplyEditorView:\n     *     The matching editor view.\n     */\n    getReviewReplyEditorView(contextType, contextID) {\n        if (contextID === undefined) {\n            contextID = null;\n        }\n\n        return _.find(this._replyEditorViews, view => {\n            const editor = view.model;\n            return editor.get('contextID') === contextID &&\n                   editor.get('contextType') === contextType;\n        });\n    },\n\n    /**\n     * Return the active reply.\n     *\n     * Returns:\n     *     RB.ReviewReply:\n     *     The active draft reply, or null if none exists.\n     */\n    getReviewReply() {\n        return this._reviewReply;\n    },\n\n    /**\n     * Set up a new ReviewReply for the editors.\n     *\n     * The new ReviewReply will be used for any new comments made on this\n     * review.\n     *\n     * A ReviewReply is set until it's either destroyed or published, at\n     * which point a new one is set.\n     *\n     * Args:\n     *     reviewReply (RB.ReviewReply, optional):\n     *         The reply object. If this is ``null``, a new ``RB.ReviewReply``\n     *         will be created. Note that this argument is only expected to be\n     *         used for unit testing.\n     */\n    _setupNewReply(reviewReply) {\n        if (!reviewReply) {\n            reviewReply = this.model.createReply();\n        }\n\n        if (this._reviewReply !== null) {\n            this.stopListening(this._reviewReply);\n\n            // Update all the existing editors to point to the new object.\n            this._replyEditors.forEach(\n                editor => editor.set('reviewReply', reviewReply));\n\n            this.trigger('hasDraftChanged', false);\n        }\n\n        this.listenTo(reviewReply, 'destroyed published',\n                      () => this._setupNewReply());\n\n        this._reviewReply = reviewReply;\n    },\n\n    /**\n     * Show the reply draft banner.\n     *\n     * This will be called in response to any new replies made on a review,\n     * or if there are pending replies that already exist on the review.\n     */\n    _showReplyDraftBanner() {\n        if (!this._draftBannerShown) {\n            this._bannerView =\n                new RB.ReviewRequestPage.ReviewReplyDraftBannerView({\n                    model: this._reviewReply,\n                    $floatContainer: this.options.$bannerFloatContainer,\n                    noFloatContainerClass:\n                        this.options.bannerNoFloatContainerClass,\n                    reviewRequestEditor: this.entryModel.get(\n                        'reviewRequestEditor'),\n                });\n\n            this._bannerView.render();\n            this._bannerView.$el.appendTo(this.options.$bannerParent);\n            this._draftBannerShown = true;\n        }\n    },\n\n    /**\n     * Hide the reply draft banner.\n     */\n    _hideReplyDraftBanner() {\n        if (this._draftBannerShown) {\n            this._bannerView.remove();\n            this._bannerView = null;\n            this._draftBannerShown = false;\n        }\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACAA,EAAE,CAACC,iBAAiB,CAACC,UAAU,GAAGC,QAAQ,CAACC,IAAI,CAACC,MAAM,CAAC;EACnD;AACJ;AACA;EACIC,UAAUA,CAACC,OAAO,EAAE;IAChB,IAAI,CAACA,OAAO,GAAGA,OAAO;IACtB,IAAI,CAACC,UAAU,GAAGD,OAAO,CAACC,UAAU;IAEpC,IAAI,CAACC,WAAW,GAAG,IAAI;IACvB,IAAI,CAACC,iBAAiB,GAAG,KAAK;IAC9B,IAAI,CAACC,eAAe,GAAG,CAAC;IACxB,IAAI,CAACC,YAAY,GAAG,IAAI;IACxB,IAAI,CAACC,aAAa,GAAG,EAAE;IACvB,IAAI,CAACC,iBAAiB,GAAG,EAAE;IAC3B,IAAI,CAACC,iBAAiB,GAAG,CAAC;IAC1B,IAAI,CAACC,kBAAkB,GAAG,EAAE;IAE5B,IAAI,CAACC,gBAAgB,GAAG,IAAI;IAC5B,IAAI,CAACC,SAAS,GAAG,IAAI;IACrB,IAAI,CAACC,YAAY,GAAG,IAAI;IAExB,IAAI,CAACC,KAAK,CAACC,GAAG,CAAC,kBAAkB,EAAE,mBAAmB,CAAC;IAEvD,IAAI,CAACC,cAAc,CAAC,CAAC;IAErB,IAAI,CAACC,QAAQ,CAAC,IAAI,CAACf,UAAU,EAAE,kBAAkB,EAAE,MAAM;MACrD,IAAI,CAAC,IAAI,CAACA,UAAU,CAACgB,GAAG,CAAC,WAAW,CAAC,EAAE;QACnC,IAAI,CAACR,kBAAkB,CAACS,OAAO,CAC3BC,IAAI,IAAIA,IAAI,CAACC,YAAY,CAAC,KAAK,CAAC,CAAC;MACzC;IACJ,CAAC,CAAC;EACN,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIC,MAAMA,CAAA,EAAG;IACL,MAAMC,mBAAmB,GAAG,IAAI,CAACrB,UAAU,CAACgB,GAAG,CAAC,qBAAqB,CAAC;IAEtE,IAAI,CAACP,gBAAgB,GAAG,IAAI,CAACa,CAAC,CAAC,kBAAkB,CAAC;IAElD,MAAMC,QAAQ,GAAG,IAAI,CAACd,gBAAgB,CAACe,IAAI,CACvC,yCAAyC,CAAC;IAC9C,IAAI,CAACd,SAAS,GAAGa,QAAQ,CAACC,IAAI,CAAC,WAAW,CAAC;IAC3C,IAAI,CAACb,YAAY,GAAGY,QAAQ,CAACC,IAAI,CAAC,cAAc,CAAC;IAEjD,IAAI,CAACjB,iBAAiB,GAAG,CAAC;IAE1B,IAAI,CAACkB,EAAE,CAAC,iBAAiB,EAAEC,QAAQ,IAAI;MACnC,IAAIA,QAAQ,EAAE;QACV,IAAI,CAACC,qBAAqB,CAAC,CAAC;MAChC,CAAC,MAAM;QACH,IAAI,CAACC,qBAAqB,CAAC,CAAC;MAChC;IACJ,CAAC,CAAC;IAEFC,CAAC,CAACC,IAAI,CAAC,IAAI,CAACrB,gBAAgB,CAACe,IAAI,CAAC,kBAAkB,CAAC,EAAEO,EAAE,IAAI;MACzD,MAAMC,WAAW,GAAGV,CAAC,CAAC,cAAc,EAAES,EAAE,CAAC;;MAEzC;AACZ;AACA;AACA;MACY,IAAIC,WAAW,CAACC,MAAM,GAAG,CAAC,EAAE;QACxB,MAAMC,WAAW,GAAGF,WAAW,CAACG,IAAI,CAAC,cAAc,CAAC;QAEpD,IAAI3C,EAAE,CAAC4C,WAAW,CAACC,WAAW,CAACH,WAAW,CAAC,EAAE;UACzC,IAAI,CAAC/B,eAAe,EAAE;QAC1B;QAEA,MAAMmC,QAAQ,GAAG,IAAI9C,EAAE,CAAC+C,mBAAmB,CAAC;UACxCR,EAAE,EAAEA,EAAE;UACNS,QAAQ,EAAE,IAAI,CAAC5B,KAAK,CAAC6B,EAAE;UACvBC,SAAS,EAAEV,WAAW,CAACG,IAAI,CAAC,YAAY,CAAC;UACzCQ,SAAS,EAAEX,WAAW,CAACG,IAAI,CAAC,YAAY,CAAC;UACzCS,WAAW,EAAEZ,WAAW,CAACG,IAAI,CAAC,cAAc,CAAC;UAC7CU,WAAW,EAAEb,WAAW,CAACG,IAAI,CAAC,aAAa,CAAC;UAC5CD,WAAW,EAAEA;QACjB,CAAC,CAAC;QAEFI,QAAQ,CAAClB,MAAM,CAAC,CAAC;QAEjB,IAAI,CAACL,QAAQ,CAACuB,QAAQ,EAAE,eAAe,EACzB,CAACQ,SAAS,EAAEC,SAAS,KAAK;UACpC,MAAMC,OAAO,GAAGxD,EAAE,CAAC4C,WAAW,CAACC,WAAW,CAACS,SAAS,CAAC;UACrD,MAAMG,OAAO,GAAGzD,EAAE,CAAC4C,WAAW,CAACC,WAAW,CAACU,SAAS,CAAC;UAErD,IAAIC,OAAO,KAAKC,OAAO,EAAE;YACrB,IAAIA,OAAO,EAAE;cACT,IAAI,CAAC9C,eAAe,EAAE;YAC1B,CAAC,MAAM;cACH,IAAI,CAACA,eAAe,EAAE;YAC1B;UACJ;UAEA,IAAI,CAAC+C,OAAO,CAAC,mBAAmB,CAAC;QACrC,CAAC,CAAC;MACN;IACJ,CAAC,CAAC;IAEFrB,CAAC,CAACC,IAAI,CAAC,IAAI,CAACR,CAAC,CAAC,kBAAkB,CAAC,EAAES,EAAE,IAAI;MACrC,MAAMoB,GAAG,GAAG7B,CAAC,CAACS,EAAE,CAAC;MACjB,MAAMqB,MAAM,GAAG,IAAI5D,EAAE,CAACC,iBAAiB,CAAC4D,iBAAiB,CAAC;QACtDC,YAAY,EAAEH,GAAG,CAAChB,IAAI,CAAC,qBAAqB,CAAC;QAC7CoB,SAAS,EAAEJ,GAAG,CAAChB,IAAI,CAAC,YAAY,CAAC;QACjCqB,WAAW,EAAEL,GAAG,CAAChB,IAAI,CAAC,cAAc,CAAC;QACrCsB,MAAM,EAAE,IAAI,CAAC7C,KAAK;QAClB8C,WAAW,EAAE,IAAI,CAACtD;MACtB,CAAC,CAAC;MAEF,MAAMc,IAAI,GAAG,IAAI1B,EAAE,CAACC,iBAAiB,CAACkE,qBAAqB,CAAC;QACxD5B,EAAE,EAAEA,EAAE;QACNnB,KAAK,EAAEwC,MAAM;QACb/B,mBAAmB,EAAEA;MACzB,CAAC,CAAC;MACFH,IAAI,CAACE,MAAM,CAAC,CAAC;MAEb,IAAI,CAACL,QAAQ,CAACqC,MAAM,EAAE,iBAAiB,EAAE,CAACxC,KAAK,EAAEc,QAAQ,KAAK;QAC1D,IAAIA,QAAQ,EAAE;UACV,IAAI,CAACnB,iBAAiB,EAAE;UACxB,IAAI,CAAC2C,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAAC;QACzC,CAAC,MAAM;UACH,IAAI,CAAC3C,iBAAiB,EAAE;UAExB,IAAI,IAAI,CAACA,iBAAiB,KAAK,CAAC,EAAE;YAC9B,IAAI,CAAC2C,OAAO,CAAC,iBAAiB,EAAE,KAAK,CAAC;UAC1C;QACJ;MACJ,CAAC,CAAC;MAEF,IAAI,CAAC7C,aAAa,CAACuD,IAAI,CAACR,MAAM,CAAC;MAC/B,IAAI,CAAC9C,iBAAiB,CAACsD,IAAI,CAAC1C,IAAI,CAAC;MAEjC,IAAIkC,MAAM,CAACpC,GAAG,CAAC,UAAU,CAAC,EAAE;QACxB,IAAI,CAACT,iBAAiB,EAAE;MAC5B;IACJ,CAAC,CAAC;IAEF,IAAI,IAAI,CAACA,iBAAiB,GAAG,CAAC,EAAE;MAC5B,IAAI,CAAC2C,OAAO,CAAC,iBAAiB,EAAE,IAAI,CAAC;IACzC;;IAEA;AACR;AACA;AACA;IACQ,IAAI,CAAC1C,kBAAkB,GAAG,EAAE;IAE5B,MAAMqD,IAAI,GAAGrE,EAAE,CAACsE,WAAW,CAACC,OAAO,CAAC,CAAC;IACrC,MAAMC,gBAAgB,GAAG,IAAI,CAAChE,UAAU,CAACgB,GAAG,CAAC,kBAAkB,CAAC;IAEhE,KAAK,IAAIiD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,gBAAgB,CAAC/B,MAAM,EAAEgC,CAAC,EAAE,EAAE;MAC9C,MAAMC,eAAe,GAAGF,gBAAgB,CAACC,CAAC,CAAC;MAE3CJ,IAAI,CAACM,aAAa,CAACD,eAAe,CAAC,CAAC,CAAC,EAAEA,eAAe,CAAC,CAAC,CAAC,EACtChD,IAAI,IAAI,IAAI,CAACV,kBAAkB,CAACoD,IAAI,CAAC1C,IAAI,CAAC,CAAC;IAClE;;IAEA;AACR;AACA;AACA;IACQ,MAAMkD,aAAa,GAAG,IAAI,CAACxD,KAAK,CAACI,GAAG,CAAC,cAAc,CAAC;IACpD,MAAMqD,aAAa,GAAGD,aAAa,CAACpD,GAAG,CAAC,eAAe,CAAC;IACxDa,CAAC,CAACC,IAAI,CAAC,IAAI,CAACR,CAAC,CAAC,gBAAgB,CAAC,EAAES,EAAE,IAAI;MACnCvC,EAAE,CAAC8E,UAAU,CAAChD,CAAC,CAACS,EAAE,CAAC,EAAE;QAAEsC,aAAa,EAAEA;MAAc,CAAC,CAAC;IAC1D,CAAC,CAAC;IAEF,IAAI,CAACtD,QAAQ,CAAC,IAAI,CAACH,KAAK,EAAE,gBAAgB,EAC5B,IAAI,CAAC2D,iBAAiB,CAAC;IACrC,IAAI,CAACxD,QAAQ,CAAC,IAAI,CAACH,KAAK,EAAE,mBAAmB,EAC/B,IAAI,CAAC4D,oBAAoB,CAAC;IACxC,IAAI,CAACzD,QAAQ,CAAC,IAAI,CAACH,KAAK,EAAE,wBAAwB,EACpC,IAAI,CAAC6D,yBAAyB,CAAC;IAC7C,IAAI,CAAC1D,QAAQ,CAAC,IAAI,CAACH,KAAK,EAAE,2BAA2B,EACvC,IAAI,CAAC8D,4BAA4B,CAAC;IAEhD,OAAO,IAAI;EACf,CAAC;EAED;AACJ;AACA;AACA;AACA;EACIH,iBAAiBA,CAAA,EAAG;IAChB,IAAI,CAAC7D,SAAS,CAACiE,IAAI,CAAC,IAAI,CAAC/D,KAAK,CAACI,GAAG,CAAC,gBAAgB,CAAC,CAAC4D,OAAO,CAAC;EACjE,CAAC;EAED;AACJ;AACA;AACA;AACA;EACIH,yBAAyBA,CAAA,EAAG;IACxB,IAAI,IAAI,CAAC7D,KAAK,CAACI,GAAG,CAAC,iBAAiB,CAAC,EAAE;MACnC,IAAI,CAACN,SAAS,CAACmE,QAAQ,CAAC,WAAW,CAAC;IACxC,CAAC,MAAM;MACH,IAAI,CAACnE,SAAS,CAACoE,WAAW,CAAC,WAAW,CAAC;IAC3C;EACJ,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIN,oBAAoBA,CAAA,EAAG;IACnB,MAAMG,IAAI,GAAG,IAAI,CAAC/D,KAAK,CAACI,GAAG,CAAC,gBAAgB,CAAC,CAAC+D,UAAU;IAExD,IAAI,CAACpE,YAAY,CACZgE,IAAI,CAACA,IAAI,CAAC,CACVK,OAAO,CAAC,IAAI,CAAC,CAACC,UAAU,CAACN,IAAI,IAAIA,IAAI,CAAC1C,MAAM,GAAG,CAAC,CAAC;EAC1D,CAAC;EAED;AACJ;AACA;AACA;AACA;EACIyC,4BAA4BA,CAAA,EAAG;IAC3B,IAAI,IAAI,CAAC9D,KAAK,CAACI,GAAG,CAAC,oBAAoB,CAAC,EAAE;MACtC,IAAI,CAACL,YAAY,CAACkE,QAAQ,CAAC,WAAW,CAAC;IAC3C,CAAC,MAAM;MACH,IAAI,CAAClE,YAAY,CAACmE,WAAW,CAAC,WAAW,CAAC;IAC9C;EACJ,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACII,aAAaA,CAAA,EAAG;IACZ,OAAO,IAAI,CAAC/E,eAAe,GAAG,CAAC;EACnC,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACIgF,iBAAiBA,CAAA,EAAG;IAChB,OAAO,IAAI,CAAChF,eAAe;EAC/B,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIiF,wBAAwBA,CAAC5B,WAAW,EAAED,SAAS,EAAE;IAC7C,IAAIA,SAAS,KAAK8B,SAAS,EAAE;MACzB9B,SAAS,GAAG,IAAI;IACpB;IAEA,OAAO1B,CAAC,CAACL,IAAI,CAAC,IAAI,CAAClB,iBAAiB,EAAEY,IAAI,IAAI;MAC1C,MAAMkC,MAAM,GAAGlC,IAAI,CAACN,KAAK;MACzB,OAAOwC,MAAM,CAACpC,GAAG,CAAC,WAAW,CAAC,KAAKuC,SAAS,IACrCH,MAAM,CAACpC,GAAG,CAAC,aAAa,CAAC,KAAKwC,WAAW;IACpD,CAAC,CAAC;EACN,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;EACI8B,cAAcA,CAAA,EAAG;IACb,OAAO,IAAI,CAAClF,YAAY;EAC5B,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIU,cAAcA,CAAC4C,WAAW,EAAE;IACxB,IAAI,CAACA,WAAW,EAAE;MACdA,WAAW,GAAG,IAAI,CAAC9C,KAAK,CAAC2E,WAAW,CAAC,CAAC;IAC1C;IAEA,IAAI,IAAI,CAACnF,YAAY,KAAK,IAAI,EAAE;MAC5B,IAAI,CAACoF,aAAa,CAAC,IAAI,CAACpF,YAAY,CAAC;;MAErC;MACA,IAAI,CAACC,aAAa,CAACY,OAAO,CACtBmC,MAAM,IAAIA,MAAM,CAACvC,GAAG,CAAC,aAAa,EAAE6C,WAAW,CAAC,CAAC;MAErD,IAAI,CAACR,OAAO,CAAC,iBAAiB,EAAE,KAAK,CAAC;IAC1C;IAEA,IAAI,CAACnC,QAAQ,CAAC2C,WAAW,EAAE,qBAAqB,EAClC,MAAM,IAAI,CAAC5C,cAAc,CAAC,CAAC,CAAC;IAE1C,IAAI,CAACV,YAAY,GAAGsD,WAAW;EACnC,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;EACI/B,qBAAqBA,CAAA,EAAG;IACpB,IAAI,CAAC,IAAI,CAACzB,iBAAiB,EAAE;MACzB,IAAI,CAACD,WAAW,GACZ,IAAIT,EAAE,CAACC,iBAAiB,CAACgG,0BAA0B,CAAC;QAChD7E,KAAK,EAAE,IAAI,CAACR,YAAY;QACxBsF,eAAe,EAAE,IAAI,CAAC3F,OAAO,CAAC4F,qBAAqB;QACnDC,qBAAqB,EACjB,IAAI,CAAC7F,OAAO,CAAC8F,2BAA2B;QAC5CxE,mBAAmB,EAAE,IAAI,CAACrB,UAAU,CAACgB,GAAG,CACpC,qBAAqB;MAC7B,CAAC,CAAC;MAEN,IAAI,CAACf,WAAW,CAACmB,MAAM,CAAC,CAAC;MACzB,IAAI,CAACnB,WAAW,CAACkD,GAAG,CAAC2C,QAAQ,CAAC,IAAI,CAAC/F,OAAO,CAACgG,aAAa,CAAC;MACzD,IAAI,CAAC7F,iBAAiB,GAAG,IAAI;IACjC;EACJ,CAAC;EAED;AACJ;AACA;EACI0B,qBAAqBA,CAAA,EAAG;IACpB,IAAI,IAAI,CAAC1B,iBAAiB,EAAE;MACxB,IAAI,CAACD,WAAW,CAAC+F,MAAM,CAAC,CAAC;MACzB,IAAI,CAAC/F,WAAW,GAAG,IAAI;MACvB,IAAI,CAACC,iBAAiB,GAAG,KAAK;IAClC;EACJ;AACJ,CAAC,CAAC"}