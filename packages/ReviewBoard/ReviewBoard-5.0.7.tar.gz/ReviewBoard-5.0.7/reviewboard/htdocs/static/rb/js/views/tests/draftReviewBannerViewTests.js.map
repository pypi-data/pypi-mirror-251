{"version":3,"file":"draftReviewBannerViewTests.js","names":["suite","template","model","view","beforeEach","RB","DraftReview","DraftReviewBannerView","el","$","appendTo","$testsScratch","render","afterEach","remove","describe","$buttons","it","expect","prop","toBe","trigger","spyOn","ReviewDialogView","click","create","toHaveBeenCalled","calls","argsFor","review","publish","and","callThrough","_onPublishClicked","toHaveBeenCalledWith","publishAndArchive","fn","callFake","options","buttons","forEach","$btn","add","modalBox","cmd","filter","destroy","$el","hasClass","show","addClass","hide"],"sources":["../../../../../../static/rb/js/views/tests/draftReviewBannerViewTests.es6.js"],"sourcesContent":["suite('rb/views/DraftReviewBannerView', function() {\n    const template = dedent`\n        <div id=\"review-banner\" hidden class=\"hidden\">\n         <div class=\"banner\">\n          <h1>You have a pending review.</h1>\n          <input id=\"review-banner-edit\" type=\"button\"\n                 value=\"Edit Review\" />\n          <input id=\"review-banner-publish-container\" type=\"button\"\n                 value=\"Publish\" />\n          <input id=\"review-banner-discard\" type=\"button\"\n                 value=\"Discard\" />\n         </div>\n        </div>'\n    `;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.DraftReview();\n        view = new RB.DraftReviewBannerView({\n            el: $(template).appendTo($testsScratch),\n            model: model,\n        });\n\n        view.render();\n    });\n\n    afterEach(function() {\n        view.remove();\n    });\n\n    describe('Button states', function() {\n        let $buttons;\n\n        beforeEach(function() {\n            $buttons = view.$('input');\n        });\n\n        describe('Enabled', function() {\n            it('Default', function() {\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n\n            it('When saved', function() {\n                $buttons.prop('disabled', true);\n                model.trigger('saved');\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n\n            it('When destroyed', function() {\n                $buttons.prop('disabled', true);\n                model.trigger('destroyed');\n                expect($buttons.prop('disabled')).toBe(false);\n            });\n        });\n\n        describe('Disabled', function() {\n            it('When saving', function() {\n                model.trigger('saving');\n                expect($buttons.prop('disabled')).toBe(true);\n            });\n\n            it('When destroying', function() {\n                model.trigger('destroying');\n                expect($buttons.prop('disabled')).toBe(true);\n            });\n        });\n    });\n\n    describe('Button events', function() {\n        it('Edit Review', function() {\n            spyOn(RB.ReviewDialogView, 'create');\n\n            view.$('#review-banner-edit').click();\n\n            expect(RB.ReviewDialogView.create).toHaveBeenCalled();\n            expect(RB.ReviewDialogView.create.calls.argsFor(0)[0].review)\n                .toBe(model);\n        });\n\n        it('Publish', function() {\n            spyOn(model, 'publish');\n\n            view.$('#review-banner-publish').click();\n\n            expect(model.publish).toHaveBeenCalled();\n        });\n\n        it('Publish to Submitter Only', function() {\n            spyOn(model, 'publish');\n\n            /*\n             * The alternative buttons from the split button are added to the\n             * <body>.\n             */\n            $('#review-banner-publish-submitter-only').click();\n\n            expect(model.publish).toHaveBeenCalled();\n        });\n\n        it('Publish and Archive', function() {\n            spyOn(model, 'publish');\n            spyOn(view, '_onPublishClicked').and.callThrough();\n\n            /*\n             * The alternative buttons from the split button are added to the\n             * <body>.\n             */\n            $('#review-banner-publish-and-archive').click();\n\n            expect(model.publish).toHaveBeenCalled();\n            expect(view._onPublishClicked).toHaveBeenCalledWith({\n                publishAndArchive: true\n            });\n        });\n\n        it('Discard', function() {\n            let $buttons = $();\n\n            spyOn(model, 'destroy');\n            spyOn($.fn, 'modalBox').and.callFake(options => {\n                options.buttons.forEach($btn => {\n                    $buttons = $buttons.add($btn);\n                });\n\n                /* Simulate the modalBox API for what we need. */\n                return {\n                    modalBox: cmd => {\n                        expect(cmd).toBe('buttons');\n                        return $buttons;\n                    }\n                };\n            });\n\n            view.$('#review-banner-discard').click();\n            expect($.fn.modalBox).toHaveBeenCalled();\n\n            $buttons.filter('input[value=\"Discard\"]').click();\n            expect(model.destroy).toHaveBeenCalled();\n        });\n    });\n\n    describe('Methods', function() {\n        it('show', function() {\n            expect(view.$el.hasClass('hidden')).toBe(true);\n            expect(view.$el.prop('hidden')).toBe(true);\n\n            view.show();\n            expect(view.$el.hasClass('hidden')).toBe(false);\n            expect(view.$el.prop('hidden')).toBe(false);\n        });\n\n        it('hide', function() {\n            view.$el\n                .addClass('hidden')\n                .prop('hidden', true);\n\n            view.hide();\n            expect(view.$el.hasClass('hidden')).toBe(true);\n            expect(view.$el.prop('hidden')).toBe(true);\n        });\n    });\n});\n"],"mappings":"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"}