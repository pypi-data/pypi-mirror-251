{"version":3,"file":"screenshotThumbnailViewTests.js","names":["suite","model","view","beforeEach","RB","Screenshot","url","id","attributes","set","template","ScreenshotThumbnail","el","$","appendTo","$testsScratch","render","spyOn","and","callThrough","describe","it","$caption","inlineEditor","expect","trigger","toHaveBeenCalledWith","done","$el","find","val","triggerHandler","_","defer","get","toBe","save","toHaveBeenCalled","callFake","options","success","cb","ajax","destroy","calls","argsFor","fadeOut","click"],"sources":["../../../../../../static/rb/js/views/tests/screenshotThumbnailViewTests.es6.js"],"sourcesContent":["suite('rb/views/ScreenshotThumbnail', function() {\n    let model;\n    let view;\n\n    beforeEach(function() {\n        model = new RB.Screenshot();\n        model.url = '/screenshots/123/';\n        model.id = 123;\n        model.attributes.id = 123;\n        model.set('loaded', true);\n\n        const template =\n            '<div><a class=\"edit\"></a><a class=\"delete\">X</a></div>';\n\n        view = new RB.ScreenshotThumbnail({\n            el: $(template).appendTo($testsScratch),\n            model: model,\n        });\n        view.render();\n\n        spyOn(model, 'trigger').and.callThrough();\n        spyOn(view, 'trigger').and.callThrough();\n    });\n\n    describe('Actions', function() {\n        it('Begin caption editing', function() {\n            view.$caption.inlineEditor('startEdit');\n            expect(view.trigger).toHaveBeenCalledWith('beginEdit');\n        });\n\n        it('Cancel caption editing', function() {\n            view.$caption.inlineEditor('startEdit');\n            expect(view.trigger).toHaveBeenCalledWith('beginEdit');\n\n            view.$caption.inlineEditor('cancel');\n            expect(view.trigger).toHaveBeenCalledWith('endEdit');\n        });\n\n        it('Save caption', function(done) {\n            spyOn(model, 'save');\n\n            view.$caption.inlineEditor('startEdit');\n            expect(view.trigger).toHaveBeenCalledWith('beginEdit');\n\n            view.$el.find('input')\n                .val('Foo')\n                .triggerHandler('keyup');\n            view.$caption.inlineEditor('submit');\n\n            _.defer(() => {\n                expect(view.trigger).toHaveBeenCalledWith('endEdit');\n                expect(model.get('caption')).toBe('Foo');\n                expect(model.save).toHaveBeenCalled();\n                done();\n            });\n        });\n\n        it('Delete', function(done) {\n            spyOn(model, 'destroy').and.callThrough();\n            spyOn($, 'ajax').and.callFake(options => options.success());\n            spyOn(view.$el, 'fadeOut').and.callFake(cb => cb());\n\n            spyOn(view, 'remove').and.callFake(() => {\n                expect($.ajax).toHaveBeenCalled();\n                expect(model.destroy).toHaveBeenCalled();\n                expect(model.trigger.calls.argsFor(0)[0]).toBe('destroying');\n                expect(view.$el.fadeOut).toHaveBeenCalled();\n\n                done();\n            });\n\n            view.$el.find('a.delete').click();\n        });\n    });\n});\n"],"mappings":"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"}