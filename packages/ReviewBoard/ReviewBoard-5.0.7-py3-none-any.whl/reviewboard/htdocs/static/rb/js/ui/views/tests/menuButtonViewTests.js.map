{"version":3,"file":"menuButtonViewTests.js","names":["suite","describe","it","view","RB","MenuButtonView","ariaMenuLabel","menuItems","text","onPrimaryButtonClick","render","expect","el","toHaveClass","$el","attr","toBe","$primaryButton","length","$","$toggleButton","id","menu","children","toBeNull","toBeUndefined","trim","sendDropDownButtonEvent","name","options","evt","Event","_$dropDownButton","trigger","sendKeyDown","keyCode","which","beforeEach","spyOn","openMenuTests","_openDirection","isOpen","toBeTrue","focusLastItem","toHaveBeenCalled","focusFirstItem","ui","RETURN","SPACE","DOWN","UP","open","animate","ESCAPE","toBeFalse","relatedTarget","$testsScratch","isPropagationStopped"],"sources":["../../../../../../../static/rb/js/ui/views/tests/menuButtonViewTests.es6.js"],"sourcesContent":["suite('rb/ui/views/MenuButtonView', function() {\n    describe('Rendering', function() {\n        it('With primary button', function() {\n            const view = new RB.MenuButtonView({\n                ariaMenuLabel: 'Test ARIA label',\n                menuItems: [\n                    {text: 'Item 1'},\n                    {text: 'Item 2'},\n                    {text: 'Item 3'},\n                ],\n                onPrimaryButtonClick: () => {},\n                text: 'Button label',\n            });\n            view.render();\n\n            expect(view.el).toHaveClass('rb-c-menu-button');\n            expect(view.$el.attr('role')).toBe('group');\n            expect(view.$primaryButton.length).toBe(1);\n\n            const $primaryButton = view.$('.rb-c-menu-button__primary');\n            expect($primaryButton.length).toBe(1);\n\n            const $toggleButton = view.$('.rb-c-menu-button__toggle');\n            expect($toggleButton.length).toBe(1);\n            expect($toggleButton[0].id)\n                .toBe(view.menu.$el.attr('aria-labelledby'));\n            expect($toggleButton.attr('aria-label')).toBe('Test ARIA label');\n            expect($toggleButton.children()[0])\n                .toHaveClass('rb-icon-dropdown-arrow');\n\n            expect(view.menu.el.children.length).toBe(3);\n        });\n\n        it('Without primary button', function() {\n            const view = new RB.MenuButtonView({\n                ariaMenuLabel: 'Test ARIA label',\n                menuItems: [\n                    {text: 'Item 1'},\n                    {text: 'Item 2'},\n                ],\n                text: 'Button label',\n            });\n            view.render();\n\n            expect(view.el).toHaveClass('rb-c-menu-button');\n            expect(view.$el.attr('role')).toBe('group');\n            expect(view.$primaryButton).toBeNull();\n\n            const $primaryButton = view.$('.rb-c-menu-button__primary');\n            expect($primaryButton.length).toBe(0);\n\n            const $toggleButton = view.$('.rb-c-menu-button__toggle');\n            expect($toggleButton.length).toBe(1);\n            expect($toggleButton[0].id)\n                .toBe(view.menu.$el.attr('aria-labelledby'));\n            expect($toggleButton.attr('aria-label')).toBeUndefined();\n            expect($toggleButton.text().trim()).toBe('Button label');\n            expect($toggleButton.children()[0])\n                .toHaveClass('rb-icon-dropdown-arrow');\n\n            expect(view.menu.el.children.length).toBe(2);\n        });\n    });\n\n    describe('Events', function() {\n        let view;\n\n        function sendDropDownButtonEvent(name, options) {\n            const evt = $.Event(name, options);\n            view._$dropDownButton.trigger(evt);\n            return evt;\n        }\n\n        function sendKeyDown(keyCode) {\n            sendDropDownButtonEvent('keydown', {\n                which: keyCode,\n            });\n        }\n\n        beforeEach(function() {\n            view = new RB.MenuButtonView();\n            view.render();\n\n            /* Don't let this override any state we set. */\n            spyOn(view, '_updateMenuPosition');\n        });\n\n        describe('keydown', function() {\n            function openMenuTests(keyCode) {\n                it('With openDirection=up', function() {\n                    view._openDirection = 'up';\n                    spyOn(view.menu, 'focusLastItem');\n\n                    sendKeyDown(keyCode);\n\n                    expect(view.menu.isOpen).toBeTrue();\n                    expect(view.menu.focusLastItem).toHaveBeenCalled();\n                });\n\n                it('With openDirection=down', function() {\n                    view._openDirection = 'down';\n                    spyOn(view.menu, 'focusFirstItem');\n\n                    sendKeyDown(keyCode);\n\n                    expect(view.menu.isOpen).toBeTrue();\n                    expect(view.menu.focusFirstItem).toHaveBeenCalled();\n                });\n            }\n\n            describe('Return key opens menu', function() {\n                openMenuTests($.ui.keyCode.RETURN);\n            });\n\n            describe('Space key opens menu', function() {\n                openMenuTests($.ui.keyCode.SPACE);\n            });\n\n            describe('Down key opens menu', function() {\n                openMenuTests($.ui.keyCode.DOWN);\n            });\n\n            describe('Up key opens menu', function() {\n                openMenuTests($.ui.keyCode.UP);\n            });\n\n            it('Escape key closes menu', function() {\n                view.menu.open({\n                    animate: false,\n                });\n                expect(view.menu.isOpen).toBeTrue();\n\n                sendKeyDown($.ui.keyCode.ESCAPE);\n\n                expect(view.menu.isOpen).toBeFalse();\n            });\n        });\n\n        it('focusout closes menu', function() {\n            view.menu.open({\n                animate: false,\n            });\n\n            expect(view.menu.isOpen).toBeTrue();\n\n            sendDropDownButtonEvent('focusout', {\n                relatedTarget: $testsScratch[0],\n            });\n\n            expect(view.menu.isOpen).toBeFalse();\n        });\n\n        it('clicking the toggle stops event propagation', function() {\n            const evt = sendDropDownButtonEvent('click');\n            expect(evt.isPropagationStopped()).toBeTrue();\n        });\n    });\n});\n"],"mappings":"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"}