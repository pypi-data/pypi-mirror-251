{"version":3,"file":"userSessionModelTests.js","names":["suite","describe","it","RB","UserSession","instance","session","create","username","expect","toBe","console","assert","toHaveBeenCalled","calls","argsFor","toBeTruthy","toThrow","toBeFalsy","beforeEach","spyOn","$","and","returnValue","cookie","toHaveBeenCalledWith","get","attributes","diffsShowExtraWhitespace","set","path","SITE_ROOT"],"sources":["../../../../../../static/rb/js/models/tests/userSessionModelTests.es6.js"],"sourcesContent":["suite('rb/models/UserSession', function() {\n    describe('create', function() {\n        it('Instance is set', function() {\n            RB.UserSession.instance = null;\n            const session = RB.UserSession.create({\n                username: 'testuser'\n            });\n\n            expect(session).toBe(RB.UserSession.instance);\n        });\n\n        it('Second attempt fails', function() {\n            RB.UserSession.instance = null;\n            RB.UserSession.create({\n                username: 'testuser'\n            });\n\n            expect(console.assert).toHaveBeenCalled();\n            expect(console.assert.calls.argsFor(0)[0]).toBeTruthy();\n\n            expect(() => RB.UserSession.create({ username: 'foo' })).toThrow();\n\n            expect(console.assert).toHaveBeenCalled();\n            expect(console.assert.calls.argsFor(1)[0]).toBeFalsy();\n        });\n    });\n\n    describe('Attributes', function() {\n        let session;\n\n        beforeEach(function() {\n            session = RB.UserSession.instance;\n        });\n\n        describe('diffsShowExtraWhitespace', function() {\n            describe('Loads from cookie', function() {\n                it('When \"true\"', function() {\n                    spyOn($, 'cookie').and.returnValue('true');\n\n                    RB.UserSession.instance = null;\n                    session = RB.UserSession.create({\n                        username: 'testuser'\n                    });\n\n                    expect($.cookie).toHaveBeenCalledWith('show_ew');\n                    expect(session.get('diffsShowExtraWhitespace')).toBe(true);\n                });\n\n                it('When \"false\"', function() {\n                    spyOn($, 'cookie').and.returnValue('false');\n\n                    RB.UserSession.instance = null;\n                    session = RB.UserSession.create({\n                        username: 'testuser'\n                    });\n\n                    expect($.cookie).toHaveBeenCalledWith('show_ew');\n                    expect(session.get('diffsShowExtraWhitespace')).toBe(false);\n                });\n            });\n\n            describe('Sets cookie', function() {\n                beforeEach(function() {\n                    spyOn($, 'cookie');\n                });\n\n                it('When true', function() {\n                    session.attributes.diffsShowExtraWhitespace = false;\n                    session.set('diffsShowExtraWhitespace', true);\n\n                    expect($.cookie).toHaveBeenCalledWith('show_ew', 'true', {\n                        path: SITE_ROOT\n                    });\n                });\n\n                it('When false', function() {\n                    session.attributes.diffsShowExtraWhitespace = true;\n                    session.set('diffsShowExtraWhitespace', false);\n\n                    expect($.cookie).toHaveBeenCalledWith('show_ew', 'false', {\n                        path: SITE_ROOT\n                    });\n                });\n            });\n        });\n    });\n});\n"],"mappings":";;AAAAA,KAAK,CAAC,uBAAuB,EAAE,YAAW;EACtCC,QAAQ,CAAC,QAAQ,EAAE,YAAW;IAC1BC,EAAE,CAAC,iBAAiB,EAAE,YAAW;MAC7BC,EAAE,CAACC,WAAW,CAACC,QAAQ,GAAG,IAAI;MAC9B,MAAMC,OAAO,GAAGH,EAAE,CAACC,WAAW,CAACG,MAAM,CAAC;QAClCC,QAAQ,EAAE;MACd,CAAC,CAAC;MAEFC,MAAM,CAACH,OAAO,CAAC,CAACI,IAAI,CAACP,EAAE,CAACC,WAAW,CAACC,QAAQ,CAAC;IACjD,CAAC,CAAC;IAEFH,EAAE,CAAC,sBAAsB,EAAE,YAAW;MAClCC,EAAE,CAACC,WAAW,CAACC,QAAQ,GAAG,IAAI;MAC9BF,EAAE,CAACC,WAAW,CAACG,MAAM,CAAC;QAClBC,QAAQ,EAAE;MACd,CAAC,CAAC;MAEFC,MAAM,CAACE,OAAO,CAACC,MAAM,CAAC,CAACC,gBAAgB,CAAC,CAAC;MACzCJ,MAAM,CAACE,OAAO,CAACC,MAAM,CAACE,KAAK,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACC,UAAU,CAAC,CAAC;MAEvDP,MAAM,CAAC,MAAMN,EAAE,CAACC,WAAW,CAACG,MAAM,CAAC;QAAEC,QAAQ,EAAE;MAAM,CAAC,CAAC,CAAC,CAACS,OAAO,CAAC,CAAC;MAElER,MAAM,CAACE,OAAO,CAACC,MAAM,CAAC,CAACC,gBAAgB,CAAC,CAAC;MACzCJ,MAAM,CAACE,OAAO,CAACC,MAAM,CAACE,KAAK,CAACC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAACG,SAAS,CAAC,CAAC;IAC1D,CAAC,CAAC;EACN,CAAC,CAAC;EAEFjB,QAAQ,CAAC,YAAY,EAAE,YAAW;IAC9B,IAAIK,OAAO;IAEXa,UAAU,CAAC,YAAW;MAClBb,OAAO,GAAGH,EAAE,CAACC,WAAW,CAACC,QAAQ;IACrC,CAAC,CAAC;IAEFJ,QAAQ,CAAC,0BAA0B,EAAE,YAAW;MAC5CA,QAAQ,CAAC,mBAAmB,EAAE,YAAW;QACrCC,EAAE,CAAC,aAAa,EAAE,YAAW;UACzBkB,KAAK,CAACC,CAAC,EAAE,QAAQ,CAAC,CAACC,GAAG,CAACC,WAAW,CAAC,MAAM,CAAC;UAE1CpB,EAAE,CAACC,WAAW,CAACC,QAAQ,GAAG,IAAI;UAC9BC,OAAO,GAAGH,EAAE,CAACC,WAAW,CAACG,MAAM,CAAC;YAC5BC,QAAQ,EAAE;UACd,CAAC,CAAC;UAEFC,MAAM,CAACY,CAAC,CAACG,MAAM,CAAC,CAACC,oBAAoB,CAAC,SAAS,CAAC;UAChDhB,MAAM,CAACH,OAAO,CAACoB,GAAG,CAAC,0BAA0B,CAAC,CAAC,CAAChB,IAAI,CAAC,IAAI,CAAC;QAC9D,CAAC,CAAC;QAEFR,EAAE,CAAC,cAAc,EAAE,YAAW;UAC1BkB,KAAK,CAACC,CAAC,EAAE,QAAQ,CAAC,CAACC,GAAG,CAACC,WAAW,CAAC,OAAO,CAAC;UAE3CpB,EAAE,CAACC,WAAW,CAACC,QAAQ,GAAG,IAAI;UAC9BC,OAAO,GAAGH,EAAE,CAACC,WAAW,CAACG,MAAM,CAAC;YAC5BC,QAAQ,EAAE;UACd,CAAC,CAAC;UAEFC,MAAM,CAACY,CAAC,CAACG,MAAM,CAAC,CAACC,oBAAoB,CAAC,SAAS,CAAC;UAChDhB,MAAM,CAACH,OAAO,CAACoB,GAAG,CAAC,0BAA0B,CAAC,CAAC,CAAChB,IAAI,CAAC,KAAK,CAAC;QAC/D,CAAC,CAAC;MACN,CAAC,CAAC;MAEFT,QAAQ,CAAC,aAAa,EAAE,YAAW;QAC/BkB,UAAU,CAAC,YAAW;UAClBC,KAAK,CAACC,CAAC,EAAE,QAAQ,CAAC;QACtB,CAAC,CAAC;QAEFnB,EAAE,CAAC,WAAW,EAAE,YAAW;UACvBI,OAAO,CAACqB,UAAU,CAACC,wBAAwB,GAAG,KAAK;UACnDtB,OAAO,CAACuB,GAAG,CAAC,0BAA0B,EAAE,IAAI,CAAC;UAE7CpB,MAAM,CAACY,CAAC,CAACG,MAAM,CAAC,CAACC,oBAAoB,CAAC,SAAS,EAAE,MAAM,EAAE;YACrDK,IAAI,EAAEC;UACV,CAAC,CAAC;QACN,CAAC,CAAC;QAEF7B,EAAE,CAAC,YAAY,EAAE,YAAW;UACxBI,OAAO,CAACqB,UAAU,CAACC,wBAAwB,GAAG,IAAI;UAClDtB,OAAO,CAACuB,GAAG,CAAC,0BAA0B,EAAE,KAAK,CAAC;UAE9CpB,MAAM,CAACY,CAAC,CAACG,MAAM,CAAC,CAACC,oBAAoB,CAAC,SAAS,EAAE,OAAO,EAAE;YACtDK,IAAI,EAAEC;UACV,CAAC,CAAC;QACN,CAAC,CAAC;MACN,CAAC,CAAC;IACN,CAAC,CAAC;EACN,CAAC,CAAC;AACN,CAAC,CAAC"}