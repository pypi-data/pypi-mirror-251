{"version":3,"file":"centeredElementManager.js","names":["RB","CenteredElementManager","Backbone","View","extend","initialize","options","arguments","length","undefined","_elements","elements","Map","_$window","$","window","_updatePositionThrottled","_","throttle","updatePosition","on","remove","prototype","call","off","setElements","size","windowTop","scrollTop","windowHeight","height","windowBottom","forEach","containers","el","$el","$topContainer","$top","$bottomContainer","$bottom","containerTop","offset","top","containerBottom","css","position","left","Math","round","outerHeight","max","bottom","min","elTop"],"sources":["centeredElementManager.es6.js"],"sourcesContent":["/**\n * A view which ensures that the specified elements are vertically centered.\n */\nRB.CenteredElementManager = Backbone.View.extend({\n    /**\n     * Initialize the view.\n     *\n     * Args:\n     *     options (object):\n     *         Options passed to this view.\n     *\n     * Option Args:\n     *     elements (Array, optional):\n     *         An initial array of elements to center.\n     */\n    initialize(options={}) {\n        this._elements = options.elements || new Map();\n        this._$window = $(window);\n\n        this._updatePositionThrottled = _.throttle(() => this.updatePosition(),\n                                                   10);\n\n        this._$window.on('resize', this._updatePositionThrottled);\n        this._$window.on('scroll', this._updatePositionThrottled);\n    },\n\n    /**\n     * Remove the CenteredElementManager.\n     *\n     * This will result in the event handlers being removed.\n     */\n    remove() {\n        Backbone.View.prototype.remove.call(this);\n\n        this._$window.off('resize', this._updatePositionThrottled);\n        this._$window.off('scroll', this._updatePositionThrottled);\n    },\n\n    /**\n     * Set the elements and their containers.\n     *\n     * Args:\n     *     elements (Map<Element, Element or jQuery>):\n     *         The elements to center within their respective containers.\n     */\n    setElements(elements) {\n        this._elements = elements;\n    },\n\n    /**\n     * Update the position of the elements.\n     *\n     * This should only be done when the set of elements changed, as the view\n     * will handle updating on window resizing and scrolling.\n     */\n    updatePosition() {\n        if (this._elements.size === 0) {\n            return;\n        }\n\n        const windowTop = this._$window.scrollTop();\n        const windowHeight = this._$window.height();\n        const windowBottom = windowTop + windowHeight;\n\n        this._elements.forEach((containers, el) => {\n            const $el = $(el);\n            const $topContainer = containers.$top;\n            const $bottomContainer = containers.$bottom || $topContainer;\n            const containerTop = $topContainer.offset().top;\n            const containerBottom = $bottomContainer.offset().top +\n                                    $bottomContainer.height();\n\n            /*\n             * We don't have to vertically center the element when its\n             * container is not on screen.\n             */\n            if (containerTop < windowBottom && containerBottom > windowTop) {\n                /*\n                 * When a container takes up the entire viewport, we can switch\n                 * the CSS to use position: fixed. This way, we do not have to\n                 * re-compute its position.\n                 */\n                if (windowTop >= containerTop &&\n                    windowBottom <= containerBottom) {\n                    if ($el.css('position') !== 'fixed') {\n                        $el.css({\n                            position: 'fixed',\n                            left: $el.offset().left,\n                            top: Math.round(\n                                (windowHeight - $el.outerHeight()) / 2),\n                        });\n                    }\n                } else {\n                    const top = Math.max(windowTop, containerTop);\n                    const bottom = Math.min(windowBottom, containerBottom);\n                    const elTop = top - containerTop + Math.round(\n                        (bottom - top - $el.outerHeight()) / 2);\n\n                    $el.css({\n                        position: 'absolute',\n                        left: '',\n                        top: elTop,\n                    });\n                }\n            }\n        });\n    },\n});\n"],"mappings":"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"}