{"version":3,"file":"draftReviewModel.js","names":["RB","DraftReview","Review","extend","_","defaults","publishAndArchive","publishToOwnerOnly","prototype","attrToJsonMap","serializedAttrs","concat","serializers","JSONSerializers","onlyIfValue","publish","options","arguments","length","undefined","context","trigger","ready","set","save","attrs","success","isFunction","call","error","model","xhr","errorText","DraftResourceModelMixin"],"sources":["draftReviewModel.es6.js"],"sourcesContent":["/**\n * A draft review.\n *\n * Draft reviews are more complicated than most objects. A draft may already\n * exist on the server, in which case we need to be able to get its ID. A\n * special resource exists at /reviews/draft/ which will redirect to the\n * existing draft if one exists, and return 404 if not.\n */\nRB.DraftReview = RB.Review.extend(_.extend({\n    defaults: _.defaults({\n        publishAndArchive: false,\n        publishToOwnerOnly: false,\n    }, RB.Review.prototype.defaults()),\n\n    attrToJsonMap: _.defaults({\n        publishAndArchive: 'publish_and_archive',\n        publishToOwnerOnly: 'publish_to_owner_only',\n    }, RB.Review.prototype.attrToJsonMap),\n\n    serializedAttrs: [\n        'publishAndArchive',\n        'publishToOwnerOnly',\n    ].concat(RB.Review.prototype.serializedAttrs),\n\n    serializers: _.defaults({\n        publishAndArchive: RB.JSONSerializers.onlyIfValue,\n        publishToOwnerOnly: RB.JSONSerializers.onlyIfValue,\n    }, RB.Review.prototype.serializers),\n\n\n    /**\n     * Publish the review.\n     *\n     * Before publish, the \"publishing\" event will be triggered.\n     *\n     * After the publish has succeeded, the \"published\" event will be\n     * triggered.\n     *\n     * Args:\n     *     options (object):\n     *         Options for the operation, including callbacks.\n     *\n     *     context (object):\n     *         Context to bind when calling callbacks.\n     */\n    publish(options={}, context=undefined) {\n        this.trigger('publishing');\n\n        this.ready({\n            ready: () => {\n                this.set('public', true);\n                this.save({\n                    attrs: options.attrs,\n                    success: () => {\n                        this.trigger('published');\n\n                        if (_.isFunction(options.success)) {\n                            options.success.call(context);\n                        }\n                    },\n                    error: (model, xhr) => {\n                        model.trigger('publishError', xhr.errorText);\n\n                        if (_.isFunction(options.error)) {\n                            options.error.call(context, model, xhr);\n                        }\n                    }\n                }, this);\n            },\n            error: error\n        }, this);\n    }\n}, RB.DraftResourceModelMixin));\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,EAAE,CAACC,WAAW,GAAGD,EAAE,CAACE,MAAM,CAACC,MAAM,CAACC,CAAC,CAACD,MAAM,CAAC;EACvCE,QAAQ,EAAED,CAAC,CAACC,QAAQ,CAAC;IACjBC,iBAAiB,EAAE,KAAK;IACxBC,kBAAkB,EAAE;EACxB,CAAC,EAAEP,EAAE,CAACE,MAAM,CAACM,SAAS,CAACH,QAAQ,CAAC,CAAC,CAAC;EAElCI,aAAa,EAAEL,CAAC,CAACC,QAAQ,CAAC;IACtBC,iBAAiB,EAAE,qBAAqB;IACxCC,kBAAkB,EAAE;EACxB,CAAC,EAAEP,EAAE,CAACE,MAAM,CAACM,SAAS,CAACC,aAAa,CAAC;EAErCC,eAAe,EAAE,CACb,mBAAmB,EACnB,oBAAoB,CACvB,CAACC,MAAM,CAACX,EAAE,CAACE,MAAM,CAACM,SAAS,CAACE,eAAe,CAAC;EAE7CE,WAAW,EAAER,CAAC,CAACC,QAAQ,CAAC;IACpBC,iBAAiB,EAAEN,EAAE,CAACa,eAAe,CAACC,WAAW;IACjDP,kBAAkB,EAAEP,EAAE,CAACa,eAAe,CAACC;EAC3C,CAAC,EAAEd,EAAE,CAACE,MAAM,CAACM,SAAS,CAACI,WAAW,CAAC;EAGnC;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIG,OAAOA,CAAA,EAAgC;IAAA,IAA/BC,OAAO,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAC,CAAC,CAAC;IAAA,IAAEG,OAAO,GAAAH,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAACE,SAAS;IACjC,IAAI,CAACE,OAAO,CAAC,YAAY,CAAC;IAE1B,IAAI,CAACC,KAAK,CAAC;MACPA,KAAK,EAAEA,CAAA,KAAM;QACT,IAAI,CAACC,GAAG,CAAC,QAAQ,EAAE,IAAI,CAAC;QACxB,IAAI,CAACC,IAAI,CAAC;UACNC,KAAK,EAAET,OAAO,CAACS,KAAK;UACpBC,OAAO,EAAEA,CAAA,KAAM;YACX,IAAI,CAACL,OAAO,CAAC,WAAW,CAAC;YAEzB,IAAIjB,CAAC,CAACuB,UAAU,CAACX,OAAO,CAACU,OAAO,CAAC,EAAE;cAC/BV,OAAO,CAACU,OAAO,CAACE,IAAI,CAACR,OAAO,CAAC;YACjC;UACJ,CAAC;UACDS,KAAK,EAAEA,CAACC,KAAK,EAAEC,GAAG,KAAK;YACnBD,KAAK,CAACT,OAAO,CAAC,cAAc,EAAEU,GAAG,CAACC,SAAS,CAAC;YAE5C,IAAI5B,CAAC,CAACuB,UAAU,CAACX,OAAO,CAACa,KAAK,CAAC,EAAE;cAC7Bb,OAAO,CAACa,KAAK,CAACD,IAAI,CAACR,OAAO,EAAEU,KAAK,EAAEC,GAAG,CAAC;YAC3C;UACJ;QACJ,CAAC,EAAE,IAAI,CAAC;MACZ,CAAC;MACDF,KAAK,EAAEA;IACX,CAAC,EAAE,IAAI,CAAC;EACZ;AACJ,CAAC,EAAE7B,EAAE,CAACiC,uBAAuB,CAAC,CAAC"}