{"version":3,"file":"regionCommentBlockModel.js","names":["RB","RegionCommentBlock","FileAttachmentCommentBlock","extend","defaults","_","x","y","width","height","AbstractCommentBlock","prototype","serializedFields","parse","fields","parseInt","undefined","canUpdateBounds","isEmpty","get","saveDraftCommentBounds","draftComment","ready","extraData","save","attrs","boundsUpdated"],"sources":["../../../../../static/rb/js/models/regionCommentBlockModel.es6.js"],"sourcesContent":["/**\n * Represents the comments on a region of an image or document.\n *\n * RegionCommentBlock deals with creating and representing comments\n * that exist in a specific region of some content.\n *\n * Model Attributes:\n *     x (number):\n *         The X position of the region being commented upon.\n *\n *     y (number):\n *         The Y position of the region being commented upon.\n *\n *     width (number):\n *         The width of the region being commented upon.\n *\n *     height (number):\n *         The height of the region being commented upon.\n *\n * See Also:\n *     :js:class:`RB.FileAttachmentCommentBlock`:\n *         For attributes defined on the base model.\n *\n *     :js:class:`RB.AbstractCommentBlock`:\n *         For attributes defined on all comment block models.\n */\nRB.RegionCommentBlock = RB.FileAttachmentCommentBlock.extend({\n    defaults: _.defaults({\n        x: null,\n        y: null,\n        width: null,\n        height: null,\n    }, RB.AbstractCommentBlock.prototype.defaults),\n\n    serializedFields: ['x', 'y', 'width', 'height'],\n\n    /**\n     * Parse the incoming attributes for the comment block.\n     *\n     * The fields are stored server-side as strings, so we need to convert\n     * them back to integers where appropriate.\n     *\n     * Args:\n     *     fields (object):\n     *         The serialized fields for the comment.\n     *\n     * Returns:\n     *     object:\n     *     The parsed data.\n     */\n    parse(fields) {\n        fields.x = parseInt(fields.x, 10) || undefined;\n        fields.y = parseInt(fields.y, 10) || undefined;\n        fields.width = parseInt(fields.width, 10) || undefined;\n        fields.height = parseInt(fields.height, 10) || undefined;\n\n        return fields;\n    },\n\n    /**\n     * Return whether the bounds of this region can be updated.\n     *\n     * If there are any existing published comments on this region, it\n     * cannot be updated.\n     *\n     * Returns:\n     *     boolean:\n     *     A value indicating whether new bounds can be set for this region.\n     */\n    canUpdateBounds() {\n        return _.isEmpty(this.get('serializedComments'));\n    },\n\n    /**\n     * Save the new bounds of the draft comment to the server.\n     *\n     * The new bounds will be stored in the comment's ``x``, ``y``,\n     * ``width``, and ``height`` keys in ``extra_data``.\n     */\n    async saveDraftCommentBounds() {\n        const draftComment = this.get('draftComment');\n\n        await draftComment.ready();\n\n        const extraData = draftComment.get('extraData');\n\n        extraData.x = this.get('x');\n        extraData.y = this.get('y');\n        extraData.width = this.get('width');\n        extraData.height = this.get('height');\n\n        await draftComment.save({\n            attrs: [\n                'extra_data.x',\n                'extra_data.y',\n                'extra_data.width',\n                'extra_data.height',\n            ],\n            boundsUpdated: true,\n        });\n    },\n});\n"],"mappings":";;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAA,EAAE,CAACC,kBAAkB,GAAGD,EAAE,CAACE,0BAA0B,CAACC,MAAM,CAAC;EACzDC,QAAQ,EAAEC,CAAC,CAACD,QAAQ,CAAC;IACjBE,CAAC,EAAE,IAAI;IACPC,CAAC,EAAE,IAAI;IACPC,KAAK,EAAE,IAAI;IACXC,MAAM,EAAE;EACZ,CAAC,EAAET,EAAE,CAACU,oBAAoB,CAACC,SAAS,CAACP,QAAQ,CAAC;EAE9CQ,gBAAgB,EAAE,CAAC,GAAG,EAAE,GAAG,EAAE,OAAO,EAAE,QAAQ,CAAC;EAE/C;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIC,KAAK,CAACC,MAAM,EAAE;IACVA,MAAM,CAACR,CAAC,GAAGS,QAAQ,CAACD,MAAM,CAACR,CAAC,EAAE,EAAE,CAAC,IAAIU,SAAS;IAC9CF,MAAM,CAACP,CAAC,GAAGQ,QAAQ,CAACD,MAAM,CAACP,CAAC,EAAE,EAAE,CAAC,IAAIS,SAAS;IAC9CF,MAAM,CAACN,KAAK,GAAGO,QAAQ,CAACD,MAAM,CAACN,KAAK,EAAE,EAAE,CAAC,IAAIQ,SAAS;IACtDF,MAAM,CAACL,MAAM,GAAGM,QAAQ,CAACD,MAAM,CAACL,MAAM,EAAE,EAAE,CAAC,IAAIO,SAAS;IAExD,OAAOF,MAAM;EACjB,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACIG,eAAe,GAAG;IACd,OAAOZ,CAAC,CAACa,OAAO,CAAC,IAAI,CAACC,GAAG,CAAC,oBAAoB,CAAC,CAAC;EACpD,CAAC;EAED;AACJ;AACA;AACA;AACA;AACA;EACI,MAAMC,sBAAsB,GAAG;IAC3B,MAAMC,YAAY,GAAG,IAAI,CAACF,GAAG,CAAC,cAAc,CAAC;IAE7C,MAAME,YAAY,CAACC,KAAK,EAAE;IAE1B,MAAMC,SAAS,GAAGF,YAAY,CAACF,GAAG,CAAC,WAAW,CAAC;IAE/CI,SAAS,CAACjB,CAAC,GAAG,IAAI,CAACa,GAAG,CAAC,GAAG,CAAC;IAC3BI,SAAS,CAAChB,CAAC,GAAG,IAAI,CAACY,GAAG,CAAC,GAAG,CAAC;IAC3BI,SAAS,CAACf,KAAK,GAAG,IAAI,CAACW,GAAG,CAAC,OAAO,CAAC;IACnCI,SAAS,CAACd,MAAM,GAAG,IAAI,CAACU,GAAG,CAAC,QAAQ,CAAC;IAErC,MAAME,YAAY,CAACG,IAAI,CAAC;MACpBC,KAAK,EAAE,CACH,cAAc,EACd,cAAc,EACd,kBAAkB,EAClB,mBAAmB,CACtB;MACDC,aAAa,EAAE;IACnB,CAAC,CAAC;EACN;AACJ,CAAC,CAAC"}