{"version":3,"file":"textBasedReviewableViewTests.js","names":["suite","template","$container","reviewRequest","model","view","beforeEach","$","appendTo","$testsScratch","RB","ReviewRequest","reviewURL","TextBasedReviewable","hasRenderedView","viewMode","fileAttachmentID","TextBasedReviewableView","el","spyOn","window","history","Backbone","and","returnValue","router","callThrough","callFake","url","options","trigger","loadUrl","render","afterEach","remove","stop","it","navigate","expect","toHaveBeenCalledWith","find","attr","toBe","get"],"sources":["../../../../../../static/rb/js/views/tests/textBasedReviewableViewTests.es6.js"],"sourcesContent":["suite('rb/views/TextBasedReviewableView', function() {\n    const template = dedent`\n      <div id=\"container\">\n       <div class=\"text-review-ui-views\">\n        <ul>\n         <li class=\"active\" data-view-mode=\"rendered\">\n          <a href=\"#rendered\">Rendered</a>\n         </li>\n         <li data-view-mode=\"source\"><a href=\"#source\">Source</a></li>\n        </ul>\n       </div>\n       <table class=\"text-review-ui-rendered-table\"></table>\n       <table class=\"text-review-ui-text-table\"></table>\n      </div>\n    `;\n\n    let $container;\n    let reviewRequest;\n    let model;\n    let view;\n\n    beforeEach(function() {\n        $container = $(template).appendTo($testsScratch);\n\n        reviewRequest = new RB.ReviewRequest({\n            reviewURL: '/r/123/',\n        });\n\n        model = new RB.TextBasedReviewable({\n            hasRenderedView: true,\n            viewMode: 'rendered',\n            fileAttachmentID: 456,\n            reviewRequest: reviewRequest,\n        });\n\n        view = new RB.TextBasedReviewableView({\n            model: model,\n            el: $container,\n        });\n\n        /*\n         * Disable the router so that the page doesn't change the URL on the\n         * page while tests run.\n         */\n        spyOn(window.history, 'pushState');\n        spyOn(window.history, 'replaceState');\n\n        /*\n         * Bypass all the actual history logic and get to the actual\n         * router handler.\n         */\n        spyOn(Backbone.history, 'matchRoot').and.returnValue(true);\n        spyOn(view.router, 'trigger').and.callThrough();\n        spyOn(view.router, 'navigate').and.callFake((url, options) => {\n            if (!options || options.trigger !== false) {\n                Backbone.history.loadUrl(url);\n            }\n        });\n\n        view.render();\n    });\n\n    afterEach(function() {\n        view.remove();\n        $container.remove();\n\n        Backbone.history.stop();\n    });\n\n    it('Router switches view modes', function() {\n        view.router.navigate('#rendered');\n        expect(view.router.trigger).toHaveBeenCalledWith('route:viewMode', 'rendered', null, null);\n        expect($container.find('.active').attr('data-view-mode')).toBe('rendered');\n        expect(model.get('viewMode')).toBe('rendered');\n\n        view.router.navigate('#source');\n        expect(view.router.trigger).toHaveBeenCalledWith('route:viewMode', 'source', null, null);\n        expect($container.find('.active').attr('data-view-mode')).toBe('source');\n        expect(model.get('viewMode')).toBe('source');\n\n        view.router.navigate('#rendered');\n        expect(view.router.trigger).toHaveBeenCalledWith('route:viewMode', 'rendered', null, null);\n        expect($container.find('.active').attr('data-view-mode')).toBe('rendered');\n        expect(model.get('viewMode')).toBe('rendered');\n    });\n});\n"],"mappings":"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"}