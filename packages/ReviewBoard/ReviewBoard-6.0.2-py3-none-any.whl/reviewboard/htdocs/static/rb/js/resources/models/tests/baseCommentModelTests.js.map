{"version":3,"file":"baseCommentModelTests.js","names":["suite","strings","RB","BaseComment","parentObject","model","beforeEach","BaseResource","expect","validate","attributes","toBe","undefined","describe","it","STATE_DROPPED","STATE_OPEN","STATE_RESOLVED","spyOn","set","destroyIfEmpty","destroy","toHaveBeenCalled","not","rspNamespace","data","parse","stat","my_comment","id","issue_opened","issue_status","text","issueOpened","issueStatus","toJSON","force_text_type","include_text_types","loaded","text_type","INVALID_ISSUE_STATUS","UNSET_PARENT_OBJECT"],"sources":["../../../../../../../static/rb/js/resources/models/tests/baseCommentModelTests.es6.js"],"sourcesContent":["suite('rb/resources/models/BaseComment', function() {\n    const strings = RB.BaseComment.strings;\n    let parentObject;\n    let model;\n\n    beforeEach(function() {\n        parentObject = new RB.BaseResource({\n            'public': true,\n        });\n\n        model = new RB.BaseComment({\n            parentObject: parentObject,\n        });\n\n        expect(model.validate(model.attributes)).toBe(undefined);\n    });\n\n    describe('State values', function() {\n        it('STATE_DROPPED', function() {\n            expect(RB.BaseComment.STATE_DROPPED).toBe('dropped');\n        });\n\n        it('STATE_OPEN', function() {\n            expect(RB.BaseComment.STATE_OPEN).toBe('open');\n        });\n\n        it('STATE_RESOLVED', function() {\n            expect(RB.BaseComment.STATE_RESOLVED).toBe('resolved');\n        });\n    });\n\n    describe('destroyIfEmpty', function() {\n        beforeEach(function() {\n            spyOn(model, 'destroy');\n        });\n\n        it('Destroying when text is empty', function() {\n            model.set('text', '');\n            model.destroyIfEmpty();\n            expect(model.destroy).toHaveBeenCalled();\n        });\n\n        it('Not destroying when text is not empty', function() {\n            model.set('text', 'foo');\n            model.destroyIfEmpty();\n            expect(model.destroy).not.toHaveBeenCalled();\n        });\n    });\n\n    describe('parse', function() {\n        beforeEach(function() {\n            model.rspNamespace = 'my_comment';\n        });\n\n        it('API payloads', function() {\n            const data = model.parse({\n                stat: 'ok',\n                my_comment: {\n                    id: 42,\n                    issue_opened: true,\n                    issue_status: 'resolved',\n                    text: 'foo',\n                },\n            });\n\n            expect(data).not.toBe(undefined);\n            expect(data.id).toBe(42);\n            expect(data.issueOpened).toBe(true);\n            expect(data.issueStatus).toBe(RB.BaseComment.STATE_RESOLVED);\n            expect(data.text).toBe('foo');\n        });\n    });\n\n    describe('toJSON', function() {\n        describe('force_text_type field', function() {\n            it('With value', function() {\n                model.set('forceTextType', 'html');\n                const data = model.toJSON();\n                expect(data.force_text_type).toBe('html');\n            });\n\n            it('Without value', function() {\n                const data = model.toJSON();\n                expect(data.force_text_type).toBe(undefined);\n            });\n        });\n\n        describe('include_text_types field', function() {\n            it('With value', function() {\n                model.set('includeTextTypes', 'html');\n                const data = model.toJSON();\n                expect(data.include_text_types).toBe('html');\n            });\n\n            it('Without value', function() {\n                const data = model.toJSON();\n\n                expect(data.include_text_types).toBe(undefined);\n            });\n        });\n\n        describe('issue_opened field', function() {\n            it('Default', function() {\n                const data = model.toJSON();\n                expect(data.issue_opened).toBe(null);\n            });\n\n            it('With value', function() {\n                model.set('issueOpened', false);\n                let data = model.toJSON();\n                expect(data.issue_opened).toBe(false);\n\n                model.set('issueOpened', true);\n                data = model.toJSON();\n                expect(data.issue_opened).toBe(true);\n            });\n        });\n\n        describe('issue_status field', function() {\n            it('When not loaded', function() {\n                model.set('issueStatus', RB.BaseComment.STATE_DROPPED);\n                const data = model.toJSON();\n                expect(data.issue_status).toBe(undefined);\n            });\n\n            it('When loaded and parent is not public', function() {\n                parentObject.set('public', false);\n\n                model.set({\n                    loaded: true,\n                    issueStatus: RB.BaseComment.STATE_DROPPED,\n                    parentObject: parentObject,\n                });\n\n                const data = model.toJSON();\n                expect(data.issue_status).toBe(undefined);\n            });\n\n            it('When loaded and parent is public', function() {\n                parentObject.set('public', true);\n\n                model.set({\n                    loaded: true,\n                    issueStatus: RB.BaseComment.STATE_DROPPED,\n                    parentObject: parentObject,\n                });\n\n                const data = model.toJSON();\n                expect(data.issue_status).toBe(RB.BaseComment.STATE_DROPPED);\n            });\n        });\n\n        describe('richText field', function() {\n            it('With true', function() {\n                model.set('richText', true);\n                const data = model.toJSON();\n                expect(data.text_type).toBe('markdown');\n            });\n\n            it('With false', function() {\n                model.set('richText', false);\n                const data = model.toJSON();\n                expect(data.text_type).toBe('plain');\n            });\n        });\n\n        describe('text field', function() {\n            it('With value', function() {\n                model.set('text', 'foo');\n                const data = model.toJSON();\n                expect(data.text).toBe('foo');\n            });\n        });\n    });\n\n    describe('validate', function() {\n        describe('issueState', function() {\n            it('STATE_DROPPED', function() {\n                expect(model.validate({\n                    issueStatus: RB.BaseComment.STATE_DROPPED,\n                })).toBe(undefined);\n            });\n\n            it('STATE_OPEN', function() {\n                expect(model.validate({\n                    issueStatus: RB.BaseComment.STATE_OPEN,\n                })).toBe(undefined);\n            });\n\n            it('STATE_RESOLVED', function() {\n                expect(model.validate({\n                    issueStatus: RB.BaseComment.STATE_RESOLVED,\n                })).toBe(undefined);\n            });\n\n            it('Unset', function() {\n                expect(model.validate({\n                    issueStatus: '',\n                })).toBe(undefined);\n\n                expect(model.validate({\n                    issueStatus: undefined,\n                })).toBe(undefined);\n\n                expect(model.validate({\n                    issueStatus: null,\n                })).toBe(undefined);\n            });\n\n            it('Invalid values', function() {\n                expect(model.validate({\n                    issueStatus: 'foobar',\n                })).toBe(strings.INVALID_ISSUE_STATUS);\n            });\n        });\n\n        describe('parentObject', function() {\n            it('With value', function() {\n                expect(model.validate({\n                    parentObject: parentObject,\n                })).toBe(undefined);\n            });\n\n            it('Unset', function() {\n                expect(model.validate({\n                    parentObject: null,\n                })).toBe(RB.BaseResource.strings.UNSET_PARENT_OBJECT);\n            });\n        });\n    });\n});\n"],"mappings":"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"}