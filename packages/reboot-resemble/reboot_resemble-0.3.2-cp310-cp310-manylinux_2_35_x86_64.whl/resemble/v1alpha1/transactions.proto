syntax = "proto3";

package resemble.v1alpha1;

////////////////////////////////////////////////////////////////////////

message PrepareRequest {
  string service = 1;
  string actor_id = 2;
  bytes transaction_id = 3;
}

////////////////////////////////////////////////////////////////////////

message PrepareResponse {}

////////////////////////////////////////////////////////////////////////

message CommitRequest {
  string service = 1;
  string actor_id = 2;
  bytes transaction_id = 3;
}

////////////////////////////////////////////////////////////////////////

message CommitResponse {}

////////////////////////////////////////////////////////////////////////

message AbortRequest {
  string service = 1;
  string actor_id = 2;
  bytes transaction_id = 3;
}

////////////////////////////////////////////////////////////////////////

message AbortResponse {}

////////////////////////////////////////////////////////////////////////

service Participant {
  rpc Prepare(PrepareRequest) returns (PrepareResponse);
  rpc Commit(CommitRequest) returns (CommitResponse);
  rpc Abort(AbortRequest) returns (AbortResponse);
}

////////////////////////////////////////////////////////////////////////

message WatchRequest {
  bytes transaction_id = 1;
}

message WatchResponse {
  bool aborted = 1;
}

////////////////////////////////////////////////////////////////////////

service Coordinator {
  rpc Watch(WatchRequest) returns (WatchResponse);
}

////////////////////////////////////////////////////////////////////////
