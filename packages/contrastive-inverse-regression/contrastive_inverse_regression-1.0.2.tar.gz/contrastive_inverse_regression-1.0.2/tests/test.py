import pandas as pd
import numpy as np
from numpy.linalg import norm
from contrastive_inverse_regression import CIR


d = 2
alpha = 0.0001
# alpha = 0.0002
# alpha = 0.0005
# alpha = 0.0000001


fg = pd.read_csv('foregroundX.csv')
bg = pd.read_csv('backgroundX.csv')
Y = pd.read_csv('foregroundY.csv')
Yt = pd.read_csv('backgroundY.csv')

fg = fg.iloc[0:, 1:]
fg = np.array(fg)
bg = bg.iloc[0:, 1:]
bg = np.array(bg)

Y = Y.iloc[0:, 1:]
Y = np.array(Y)
Yt = Yt.iloc[0:, 1:]
Yt = np.array(Yt)


V = CIR(fg, Y, bg, Yt, alpha, d)
VVt = V @ V.T


t0001_id = [[0.509663493141852,  -0.089736090248018,  -0.018074730297370,   0.047517144798328,  -0.017547771729244,  -0.030120227856856,  -0.011645320358326],
            [-0.089736090248018,   0.309754442667553,   0.027583788861158,  -
                0.221888794200687,  -0.000846033339989,   0.019198056132783,   0.020295555025844],
            [-0.018074730297370,   0.027583788861158,   0.002666579112676,  -
                0.019409801692311,   0.000295613349962,   0.002221603041668,   0.001927534715578],
            [0.047517144798328,  -0.221888794200687,  -0.019409801692311,   0.159528373003477,
                0.001222757753359,  -0.012901077405141,  -0.014338629557453],
            [-0.017547771729244,  -0.000846033339989,   0.000295613349962,   0.001222757753359,
             0.000656864912418,   0.000851010078777,   0.000156671426380],

            [-0.030120227856856,   0.019198056132783,   0.002221603041668,  -
             0.012901077405141,   0.000851010078777,   0.002436840556148,   0.001550640896169],
            [-0.011645320358326,   0.020295555025844,   0.001927534715578,  -
             0.014338629557453,   0.000156671426380,   0.001550640896169,   0.001398525252757],
            [-0.042361375186890,  -0.001884213865278,   0.000726757479312,   0.002836925533988,
             0.001583593792920,   0.002061865518030,   0.000388030996633],
            [0.000753513841936,  -0.005939239615475,  -0.000508730019824,   0.004288021316899,
             0.000051798569550,  -0.000318999412288,  -0.000377619052242],
            [0.005235277335482,  -0.003188001970808,  -0.000373785501217,
             0.002134239449113,  -0.000149909418778,  -0.000416517211942,  -0.000260281384167],

            [-0.049565389003671,   0.050782367526855,   0.005248839646999,  -
             0.035169274414876,   0.001143476468979,   0.004917127087946,   0.003742816545327],
            [-0.010912579106207,   0.047143253528468,   0.004140904537957,  -
             0.033865629663788,  -0.000229738767347,  0.002782487005390,   0.003056172729813],
            [-0.009612109641905,   0.019078265043758,   0.001784097404622,  -
             0.013524888127601,   0.000098172674522,   0.001389863623544,   0.001298733083322],
            [-0.019832045198425,   0.025258399712993,   0.002510184150641,  -
             0.017659778329251,   0.000391394301199,   0.002200914225022,   0.001804151068686],
            [-0.033293876695477,   0.033816161749771,   0.003501227796481,  -
             0.023409360802760,   0.000772043764958,   0.003288961425394,   0.002495789479246],

            [0.004807577055953,   0.153992814197172,   0.012682821343282,  -
             0.112023771102866,  -0.002238614807282,   0.007034907670777,   0.009500712334830],
            [-0.003661591152681,  -0.152952908192477,  -0.012620390001349,   0.111228684677893,
             0.002182533974776,  -0.007043941095319,  -0.009449828511228],
            [0.143699316571921,   0.015213588094227,  -0.001733011897327,  -
             0.016031539911020,  -0.005490019977695,  -0.006577312927165,  -0.000768730308273],
            [-0.068017070034558,   0.083728933063828,   0.008368445443134,  -
             0.058461418801318,   0.001381156517419,   0.007411360713881,   0.006007701501622],
            [-0.082307981741735,  -0.065020065449790,  -0.003681370609948,   0.050082053437080,   0.003898431336890,   0.001105843765384,  -0.003054489124824]]


t0002_id = [[0.570538782817438,  -0.083431299257491,  -0.019024765199097,   0.036007989019783,  -0.019853879779958,  -0.031606788500992,  -0.013874577146619],
            [-0.083431299257491,   0.373852187124665,   0.025346969041592,  -
                0.236255742962699,  -0.001079076870880,   0.012135597293638,   0.016933919489871],
            [-0.019024765199097,   0.025346969041592,   0.002042303723454,  -
                0.015613115799419,   0.000413557228434,   0.001522744397501,   0.001392635439042],
            [0.036007989019783,  -0.236255742962699,  -0.015613115799419,   0.149808025283577,
                0.001290544594530,  -0.006793815479319,  -0.010395614346996],
            [-0.019853879779958,  -0.001079076870880,   0.000413557228434,   0.001290544594530,
             0.000734736819997,   0.001017130782230,   0.000318686430481],
            [-0.031606788500992,   0.012135597293638,   0.001522744397501,  -
             0.006793815479319,   0.001017130782230,   0.001907060708949,   0.001078291372705],
            [-0.013874577146619,   0.016933919489871,   0.001392635439042,  -
             0.010395614346996,   0.000318686430481,   0.001078291372705,   0.000951697466412],
            [-0.041965970476045,  -0.002734282594307,   0.000845864058642,   0.003017463817014,
             0.001558036313699,   0.002140531921149,   0.000654934749756],
            [-0.001412079468571,  -0.008323185211759,  -0.000485115143415,   0.005358860406621,
             0.000143063455885,  -0.000098985522624,  -0.000317199978354],
            [0.001779869636630,  -0.005027957674385,  -0.000356825380724,
             0.003157492688539,  -0.000009437015625,  -0.000197654588855,  -0.000239777342240],
            [-0.051772454880463,   0.056163012377170,   0.004758231273894,  -
             0.034303741497125,   0.001266525496131,   0.003877646638074,   0.003261685810444],
            [-0.013740901560598,   0.043680513544607,   0.003058226620871,  -
             0.027482948404961,   0.000019297144651,   0.001626977881062,   0.002051578136301],
            [-0.008708465220540,   0.017256354344851,   0.001287623919181,  -
             0.010758026065197,   0.000127044357033,   0.000814492516512,   0.000870489758522],
            [-0.023817065643579,   0.020666400772717,   0.001866339373822,  -
             0.012478447759578,   0.000639579247732,   0.001676426135682,   0.001287390782684],
            [-0.033259087129138,   0.027368549210555,   0.002513211018128,  -
             0.016473191757625,   0.000909549963532,   0.002310054075163,   0.001736320696673],
            [0.004900604846291,   0.162251954236672,   0.010004861796200,  -
             0.103780181163421,  -0.001965075566566,   0.003114341878834,   0.006597361696371],
            [0.001527975980113,  -0.169475090791799,  -0.010611250796319,   0.108198955100436,
             0.001810557290761,  -0.003601010013196,  -0.007012642810301],
            [0.144874725294541,   0.022530736506685,  -0.002103258449366,  -
             0.018778504608449,  -0.005522803293480,  -0.007117546767799,  -0.001721415331806],
            [-0.069458740675284,   0.075180736748647,   0.006373208030381,  -
             0.045914852433772,   0.001701045394282,   0.005198812182958,   0.004368986801950],
            [-0.083057812286178,  -0.082736175706726,  -0.003150485353331,   0.055359956038693,   0.003935085386604,   0.002629986822942,  -0.001890602981413]]


t0005_id = [[0.36251407406331,  -0.092204037245065,  -0.014175595739193,   0.059995307556650,  -0.015476822416402,  -0.014941558653884,  -0.001769375717203],
            [-0.092204037245065,   0.194364973378427,   0.028953091705242,  -
                0.186635148785021,  -0.000252089171498,   0.028616742896836,   0.021939960079216],
            [-0.014175595739193,   0.028953091705242,   0.004313533956468,  -
                0.027762183392410,  -0.000015992368143,   0.004264709979855,   0.003256289741703],
            [0.059995307556650,  -0.186635148785021,  -0.027762183392410,   0.181768263129174,
             0.001638507802177,  -0.027356343272027,  -0.021840886908110],
            [-0.015476822416402,  -0.000252089171498,  -0.000015992368143,   0.001638507802177,
             0.000763401066936,   0.000029726213543,  -0.000451112079734],
            [-0.014941558653884,   0.028616742896836,   0.004264709979855,  -
             0.027356343272027,   0.000029726213543,   0.004219155199760,   0.003193241353051],
            [-0.001769375717203,   0.021939960079216,   0.003256289741703,  -
             0.021840886908110,  -0.000451112079734,   0.003193241353051,   0.002710690847250],
            [-0.032048170279461,   0.003514850150164,   0.000565577263104,  -
             0.000654885112479,   0.001481859134503,   0.000647701813910,  -0.000426549257271],
            [0.007122961345665,  -0.002710591127458,  -0.000411845242415,
             0.002080160311397,  -0.000282071641695,  -0.000424101878796,  -0.000147789282451],
            [0.006797786487187,  -0.002608604520208,  -0.000396270440953,
             0.002007012757379,  -0.000268661428426,  -0.000407899926956,  -0.000143778009531],
            [-0.053746711047163,   0.044931512536096,   0.006737941939183,  -
             0.040240778254529,   0.001528492546179,   0.006754349898787,   0.004192989844039],
            [0.002793214630128,  0.046061587728589,   0.006827382581565,  -
             0.046436283567676,  -0.001265489588214,   0.006676121444284,   0.005867289223316],
            [-0.008547806541852,   0.020958593985934,   0.003120116601917,  -
             0.020249950804259,  -0.000095418499385,   0.003079798503848,   0.002403605272444],
            [-0.001602557624400,   0.028008985917810,   0.004156136557220,  -
             0.027941266423084,  -0.000608007046910,   0.004073742359871,   0.003478305853235],
            [-0.030667910973354,   0.040931710780319,   0.006112841761062,  -
             0.038296545879272,   0.000497355881494,   0.006074673825608,  0.004315497096513],
            [-0.012242625079017,   0.120763641203289,   0.017926984887831,  -
             0.119994161883004,  -0.002360559954081,   0.017587217610626,   0.014852552685476],
            [-0.017150756785211,  -0.107504715465440,  -0.015919965384146,   0.109331142534056,
             0.003473732842264,  -0.015536064306439,  -0.013981978365050],
            [0.107643360838928,  -0.009841289589716,  -0.001608328729764,
             0.000229928122967,  -0.005025407964735,  -0.001890273551869,   0.001679686929325],
            [-0.042117112091402,   0.089285193551084,   0.013299815606543,  -
             0.085755711775609,  -0.000127472787789,   0.013144614902517,   0.010084996239568],
            [-0.054982106209116,  -0.029760748085215,  -0.004337715722665,   0.034764146132454,   0.003419413690335,  -0.004085590441956,  -0.005231985976821]]


t0000001_id = [[0.429344585058962,  -0.091189790915859,  -0.015791204034826,   0.051761197377502,  -0.017597891708074,  -0.021954593843835,  -0.005791698760249],
               [-0.091189790915859,   0.235319409383764,   0.028171405670886,  -
                   0.203605682755306,  -0.000836786195517,   0.024066781623767,   0.020853661614733],
               [-0.015791204034826,   0.028171405670886,   0.003432858882073,  -
                   0.024039033583605,   0.000121543217779,   0.003037397946478,   0.002468185898638],
               [0.051761197377502,  -0.203605682755306,  -0.024039033583605,   0.178035305112079,
                   0.001958484312936,  -0.019953493199711,  -0.018200930983438],
               [-0.017597891708074,  -0.000836786195517,   0.000121543217779,   0.001958484312936,
                0.000818198744478,   0.000488844076400,  -0.000178292760628],
               [-0.021954593843835,   0.024066781623767,   0.003037397946478,  -
                0.019953493199711,   0.000488844076400,   0.002866130293993,   0.002059384989662],
               [-0.005791698760249,   0.020853661614733,   0.002468185898638,  -
                0.018200930983438,  -0.000178292760628,   0.002059384989662,   0.001861323732282],
               [-0.037801129909660,   0.001605144727482,   0.000652113124910,   0.001172060542543,
                0.001685454151081,   0.001355793435687,  -0.000073786329199],
               [0.004640301897171,  -0.003933788461995,  -0.000509483460627,
                0.003189014412343,  -0.000127744193182,  -0.000502187637662,  -0.000330501414323],
               [0.005764077918058,  -0.003000140582059,  -0.000416089708818,
                0.002278867154738,  -0.000198638545983,  -0.000454315226300,  -0.000239130844893],
               [-0.041363519961569,   0.050730732109738,   0.006341773487039,  -
                0.042398805618043,   0.000806878332403,   0.005884031444008,   0.004369567070031],
               [-0.002828536499848,   0.046781697275388,   0.005411218166124,  -
                0.041530844152062,  -0.000862306358215,   0.004294112693215,   0.004234627698884],
               [-0.010036622716895,   0.019316868035344,   0.002344090216917,  -
                0.016537840825249,   0.000047349206205,   0.002057354561607,   0.001697009526074],
               [-0.009662374178172,   0.026868091821741,   0.003207258709176,  -
                0.023298729209033,  -0.000129630310850,   0.002723856244031,   0.002385365489277],
               [-0.032882476262503,   0.036458336790305,   0.004596646406643,  -
                0.030253098481682,   0.000723431476362,   0.004329793635214,   0.003121911084645],
               [-0.002499543876369,   0.135680869118975,   0.015623579609726,  -
                0.120844722572712,  -0.002760405218975,   0.012271385876268,   0.012314826618822],
               [-0.011989238034243,  -0.128129880750311,  -0.014576563843410,   0.115107803504952,
                0.003259503634988,  -0.011128529152436,  -0.011712854755212],
               [0.126079711952281,  -0.000406593969518,  -0.001606490585656,  -
                0.008321667481612,  -0.005726360467353, -0.004077524579717,   0.000695647948520],
               [-0.052996764615582,   0.085208493221730,   0.010447929400519,  -
                0.072349021280843,   0.000605702621926,   0.009354804448048,   0.007434972995635],
               [-0.072055460372667,  -0.046089147893377,  -0.004405220346244,   0.046071121906292,   0.004253875919199,  -0.001831772304881,  -0.004606814432589]]


VVt_s = VVt[:20, :7]
np.set_printoptions(precision=15, suppress=True, threshold=sys.maxsize)
# print(VVt_s)
norm = np.linalg.norm(VVt_s-t0001_id, ord='fro')
print("This is the norm of the difference")
print(norm)
