image: python:latest

lint:
  stage: test
  before_script:
    - pip install black flake8 isort flake8-bugbear flake8-builtins flake8-comprehensions flake8-tidy-imports flake8-eradicate flake8-print flake8-return flake8-use-fstring git+https://github.com/derrix060/flake8-expression-complexity.git
  script:
    - black --check src/
    - flake8 src/
    - isort -c src/

deploy_to_pypi:
  stage: deploy
  only:
    - master
  before_script:
    - pip install build twine
  script:
    - python -m build
    - TWINE_PASSWORD=$PYPI_PASSWORD TWINE_USERNAME=$PYPI_USERNAME python3 -m twine upload dist/*
