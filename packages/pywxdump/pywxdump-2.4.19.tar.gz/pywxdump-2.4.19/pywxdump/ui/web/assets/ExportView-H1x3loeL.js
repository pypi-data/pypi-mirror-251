import{d as D,r as c,w as B,e as s,o as x,m as E,_ as I,c as w,f as a,g as u,a as o,j as _,F as S,l as A,h as R,t as q,x as z}from"./index-vogySW5l.js";import{C as G,_ as L}from"./ChatRecprdsHeader-4nWUsd6i.js";const N=D({__name:"DateTimeSelect",emits:["datetime"],setup(y,{emit:p}){const i=[new Date(2e3,1,1,0,0,0),new Date(2e3,2,1,23,59,59)],m=[{text:"全部",value:()=>{const t=new Date;return[new Date(2010,0,1,0,0,0),t]}},{text:"最近一周",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*7),[e,t]}},{text:"最近一个月",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*30),[e,t]}},{text:"最近三个月",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*90),[e,t]}},{text:"最近半年",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*180),[e,t]}},{text:"最近一年",value:()=>{const t=new Date,e=new Date;return e.setTime(e.getTime()-3600*1e3*24*365),[e,t]}},{text:"去年一整年",value:()=>{const t=new Date;t.setFullYear(t.getFullYear()-1),t.setMonth(0),t.setDate(1),t.setHours(0,0,0);const e=new Date;return e.setFullYear(e.getFullYear()-1),e.setMonth(11),e.setDate(31),e.setHours(23,59,59),[t,e]}}],r=c([Date,Date]),h=p;return B(()=>r.value,(t,e)=>{let v=t[0].getTime(),g=t[1].getTime();h("datetime",[v,g])}),(t,e)=>{const v=s("el-date-picker");return x(),E(v,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=g=>r.value=g),type:"datetimerange",shortcuts:m,"range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","default-time":i,format:"YYYY-MM-DD HH:mm"},null,8,["modelValue"])}}}),O=I(N,[["__scopeId","data-v-320582f6"]]),W={id:"chat_export",style:{"background-color":"#d2d2fa",padding:"0"}},J={style:{"background-color":"#d2d2fa",height:"calc(100vh - 65px)",display:"grid","place-items":"center"}},K={style:{"background-color":"#fff",width:"70%",height:"70%","border-radius":"10px",padding:"20px",overflow:"auto"}},P=o("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}},[o("div",{style:{"font-size":"20px","font-weight":"bold"}},"导出与备份(未完待续...）"),o("div",{style:{display:"flex","justify-content":"space-between","align-items":"center"}})],-1),Q={style:{"margin-top":"20px"}},X=o("br",null,null,-1),Z=o("br",null,null,-1),ee=o("br",null,null,-1),te=D({__name:"ChatExportMain",props:{userData:{type:Object,required:!0}},setup(y){const p=y,i=c(""),m=c([]),r=c(["文本"]),h=c(""),t=c(""),e=["文本","图片","语音","视频","动画表情","文件","卡片式链接","用户上传的GIF表情","转账消息","赠送红包封面","语音通话","系统通知","拍一拍","系统通知","其他"],v=c(!1),g=c(!0),V=d=>{r.value=d?e:[],g.value=!1},C=d=>{const l=d.length;v.value=l===e.length,g.value=l>0&&l<e.length},T=d=>{m.value=d},F=async()=>{try{if(i.value===""){t.value="导出类型不能为空";return}const d=await R.post("/api/export",{export_type:i.value,start_time:m.value[0],end_time:m.value[1],chat_type:r.value,username:p.userData.username,wx_path:h.value});t.value=d}catch(d){console.error("Error fetching data:",d),t.value=String(d)}};return(d,l)=>{const U=s("el-header"),f=s("el-option"),Y=s("el-select"),b=s("el-checkbox"),$=s("el-checkbox-group"),k=s("el-input"),j=s("el-button"),H=s("el-divider"),M=s("el-main");return x(),w("div",W,[a(U,{style:{height:"65px","max-height":"65px",width:"100%","padding-top":"5px"}},{default:u(()=>[a(G,{userData:y.userData},null,8,["userData"])]),_:1}),a(M,{style:{"overflow-y":"auto",height:"calc(100vh - 65px)",padding:"0"}},{default:u(()=>[o("div",J,[o("div",K,[P,o("div",Q,[_(" 导出类型: "),a(Y,{modelValue:i.value,"onUpdate:modelValue":l[0]||(l[0]=n=>i.value=n),placeholder:"请选择导出类型",style:{width:"50%"}},{default:u(()=>[a(f,{label:"加密文件(可还原回微信)-开发中",value:"endb"}),a(f,{label:"解密文件-开发中",value:"dedb"}),a(f,{label:"csv(只包含文字)-开发中",value:"csv"}),a(f,{label:"json(只包含文字)-开发中",value:"json"}),a(f,{label:"html-开发中",value:"html"}),a(f,{label:"pdf-开发中",value:"pdf"})]),_:1},8,["modelValue"]),X,Z,o("div",null,[_(" 选项:"),ee,o("div",null,[_(" ① 时间(默认全部)： "),a(O,{onDatetime:T})]),o("div",null,[_(" ② 消息类型： "),a(b,{modelValue:v.value,"onUpdate:modelValue":l[1]||(l[1]=n=>v.value=n),indeterminate:g.value,onChange:V},{default:u(()=>[_("全选 ")]),_:1},8,["modelValue","indeterminate"]),a($,{modelValue:r.value,"onUpdate:modelValue":l[2]||(l[2]=n=>r.value=n),onChange:C},{default:u(()=>[(x(),w(S,null,A(e,n=>a(b,{key:n,label:n},{default:u(()=>[_(q(n),1)]),_:2},1032,["label"])),64))]),_:1},8,["modelValue"])]),o("div",null,[_(" ③ 微信文件夹路径： "),a(k,{placeholder:"微信文件夹路径[可为空](eg: C:\\****\\WeChat Files\\wxid_**** )",modelValue:h.value,"onUpdate:modelValue":l[3]||(l[3]=n=>h.value=n),style:{width:"50%"}},null,8,["modelValue"])])]),a(j,{style:{"margin-top":"10px",width:"50%"},type:"success",onClick:F},{default:u(()=>[_("导出")]),_:1}),a(H),a(k,{type:"textarea",rows:8,readonly:"",placeholder:"导出结果",modelValue:t.value,"onUpdate:modelValue":l[4]||(l[4]=n=>t.value=n),style:{width:"100%"}},null,8,["modelValue"])])])])]),_:1})])}}}),ae={id:"chat_view",class:"common-layout"},le={key:0,style:{height:"calc(100vh)",width:"100%","background-color":"#d2d2fa"}},ne={key:1,style:{width:"100%",height:"100%"}},de=D({__name:"ExportView",setup(y){const p=c({account:"",describe:"",headImgUrl:"",nickname:"",remark:"",username:"",chat_count:0}),i=m=>{p.value=m};return(m,r)=>{const h=s("el-aside"),t=s("el-container");return x(),w("div",ae,[a(t,null,{default:u(()=>[a(h,{width:"266px",style:{"overflow-y":"auto",height:"calc(100vh)"}},{default:u(()=>[a(L,{onUserData:i})]),_:1}),p.value.username!=""?(x(),w("div",le,[a(te,{userData:p.value},null,8,["userData"])])):(x(),w("div",ne,[a(z)]))]),_:1})])}}});export{de as default};
