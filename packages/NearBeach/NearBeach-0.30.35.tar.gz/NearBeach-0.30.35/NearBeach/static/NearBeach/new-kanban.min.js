"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[3949],{6912:(e,o,r)=>{r.r(o),r.d(o,{default:()=>S});var t=r(6252),a=r(9963);const n={class:"card"},l={class:"card-body"},s=(0,t._)("h1",null,"New Kanban",-1),i=(0,t._)("hr",null,null,-1),d={class:"row"},u=(0,t._)("div",{class:"col-md-4"},[(0,t._)("strong",null,"Please note"),(0,t._)("p",{class:"text-instructions"},"Board names must be unique.")],-1),p={class:"col-md-8"},c={class:"form-group"},m={key:0,class:"error"},h={key:1,class:"error"},g=(0,t._)("hr",null,null,-1),y={class:"row"},v=(0,t._)("div",{class:"col-md-4"},[(0,t._)("h2",null,"Columns & Levels"),(0,t._)("p",{class:"text-instructions"}," Drag the cards around to sort out the columns how you want them. ")],-1),b={class:"col-md-4"},_={class:"col-md-4"},k=(0,t._)("hr",null,null,-1),M=(0,t._)("hr",null,null,-1),w={class:"row submit-row"},f={class:"col-md-12"};var N=r(5900),B=r(3532),$=r(5705),R=r(760),E=r(7939),K=r(3058),q=r(624);const P={name:"NewKanban",setup:()=>({v$:(0,$.ZP)()}),components:{GroupPermissions:B.Z,KanbanPropertyOrder:N.Z,ValidationRendering:E.Z},props:{groupResults:{type:Array,default:()=>[]},rootUrl:{type:String,default:"/"},theme:{type:String,default:""},userGroupResults:{type:Array,default:()=>[]}},mixins:[K.Z,q.Z],data:()=>({checkingKanbanBoardName:!1,columnModel:[{id:0,property:"Normal",title:"Backlog"},{id:1,property:"Blocked",title:"Blocked"},{id:2,property:"Normal",title:"In Progress"},{id:4,property:"Normal",title:"Review and QA"},{id:5,property:"Closed",title:"Completed"}],groupModel:[],kanbanBoardNameModel:"",levelModel:[{id:0,title:"Sprint 1"},{id:1,title:"Sprint 2"}],searchTimeout:"",uniqueKanbanBoardName:!0}),validations:{columnModel:{required:R.C1},groupModel:{required:R.C1},kanbanBoardNameModel:{required:R.C1},levelModel:{required:R.C1}},watch:{kanbanBoardNameModel(){this.checkingKanbanBoardName=!0,""!==this.searchTimeout&&clearTimeout(this.searchTimeout),void 0===this.kanbanBoardNameModel?this.searchTimeout=setTimeout(this.checkKanbanBoardName,500):this.kanbanBoardNameModel.length>=3&&(this.searchTimeout=setTimeout(this.checkKanbanBoardName,500,this.kanbanBoardNameModel,null))}},methods:{addNewKanban(){if(this.v$.$touch(),this.v$.$invalid||!this.uniqueKanbanBoardName||this.checkingKanbanBoardName)return void this.showValidationErrorModal();const e=new FormData;e.set("kanban_board_name",this.kanbanBoardNameModel),this.columnModel.forEach((o=>{e.append("column_title",o.title),e.append("column_property",o.property)})),this.levelModel.forEach((o=>{e.append("level_title",o.title)})),this.groupModel.forEach((o=>{e.append("group_list",o)})),this.axios.post(`${this.rootUrl}new_kanban_save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{}))},checkKanbanBoardName(){const e=new FormData;e.set("kanban_board_name",this.kanbanBoardNameModel),this.axios.post(`${this.rootUrl}kanban_information/check_kanban_board_name/`,e).then((e=>{this.uniqueKanbanBoardName=0===e.data.length,this.checkingKanbanBoardName=!1})).catch((e=>{}))},updateGroupModel(e){this.groupModel=e},updatePropertyList(e){this[e.source]=e.data}}},S=(0,r(3744).Z)(P,[["render",function(e,o,r,N,B,$){const R=(0,t.up)("validation-rendering"),E=(0,t.up)("kanban-property-order"),K=(0,t.up)("group-permissions"),q=(0,t.up)("n-config-provider");return(0,t.wg)(),(0,t.j4)(q,{theme:e.getTheme(r.theme)},{default:(0,t.w5)((()=>[(0,t._)("div",n,[(0,t._)("div",l,[s,i,(0,t._)("div",d,[(0,t.kq)(" DESCRIPTION "),u,(0,t.kq)(" BOARD NAME "),(0,t._)("div",p,[(0,t._)("div",c,[(0,t._)("label",null,[(0,t.Uk)("Kanban Board Name "),(0,t.Wm)(R,{"error-list":N.v$.kanbanBoardNameModel.$errors},null,8,["error-list"]),B.uniqueKanbanBoardName?(0,t.kq)("v-if",!0):((0,t.wg)(),(0,t.iD)("span",m," Please supply a unique name")),B.checkingKanbanBoardName?((0,t.wg)(),(0,t.iD)("span",h," Checking kanban name...")):(0,t.kq)("v-if",!0)]),(0,t.wy)((0,t._)("input",{type:"text",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=e=>B.kanbanBoardNameModel=e)},null,512),[[a.vModelText,B.kanbanBoardNameModel]])])])]),g,(0,t.kq)(" Properties for the drag and drop coloumns/levels "),(0,t._)("div",y,[v,(0,t._)("div",b,[(0,t.Wm)(E,{"property-name":"Column","property-list":B.columnModel,source:"columnModel","is-dirty":N.v$.columnModel.$dirty,onUpdate_property_list:o[1]||(o[1]=e=>$.updatePropertyList(e))},null,8,["property-list","is-dirty"])]),(0,t._)("div",_,[(0,t.Wm)(E,{"property-name":"Level","property-list":B.levelModel,source:"levelModel","is-dirty":N.v$.columnModel.$dirty,onUpdate_property_list:o[2]||(o[2]=e=>$.updatePropertyList(e))},null,8,["property-list","is-dirty"])])]),(0,t.kq)(" Group Permissions "),k,(0,t.Wm)(K,{"group-results":r.groupResults,destination:"kanban_board","user-group-results":r.userGroupResults,onUpdate_group_model:o[3]||(o[3]=e=>$.updateGroupModel(e)),"is-dirty":N.v$.groupModel.$dirty},null,8,["group-results","user-group-results","is-dirty"]),(0,t.kq)(" SAVE "),M,(0,t._)("div",w,[(0,t._)("div",f,[(0,t._)("button",{class:"btn btn-primary save-changes",onClick:o[4]||(o[4]=(...e)=>$.addNewKanban&&$.addNewKanban(...e))}," Add Kanban ")])])])])])),_:1},8,["theme"])}]])},3532:(e,o,r)=>{r.d(o,{Z:()=>b});var t=r(6252),a=r(3577);const n={class:"row"},l={class:"col-md-4"},s=(0,t._)("h2",null,"Group Permissions",-1),i={class:"text-instructions"},d=(0,t._)("p",{class:"text-instructions"}," If you do not add one of your own group(s), you will only get readonly access. ",-1),u={class:"col-md-8"},p=(0,t._)("br",null,null,-1),c={key:0,class:"alert alert-warning"};var m=r(2001),h=r(5705),g=r(760),y=r(7939);const v={name:"GroupPermissions",setup:()=>({v$:(0,h.ZP)()}),components:{NSelect:m.Z,ValidationRendering:y.Z},props:{destination:{type:String,default:""},displayGroupPermissionIssue:{type:Boolean,default:!1},groupResults:{type:Array,default:()=>[]},isDirty:{type:Boolean,default:!0},userGroupResults:{type:Array,default:()=>[]}},watch:{groupModel(){this.$emit("update_group_model",this.groupModel)}},data:()=>({groupFixResults:[],groupModel:[]}),validations:{groupModel:{required:g.C1}},mounted(){this.groupFixResults=this.groupResults.map((e=>({value:e.pk,label:e.fields.group_name}))),this.groupModel=this.userGroupResults.map((e=>e.group_id))}},b=(0,r(3744).Z)(v,[["render",function(e,o,r,m,h,g){const y=(0,t.up)("validation-rendering"),v=(0,t.up)("n-select");return(0,t.wg)(),(0,t.iD)("div",n,[(0,t._)("div",l,[s,(0,t._)("p",i," Add or remove groups from this "+(0,a.toDisplayString)(r.destination)+". Adding a group will allow users from that group to access this "+(0,a.toDisplayString)(r.destination)+". ",1),d]),(0,t._)("div",u,[(0,t._)("label",null,[(0,t.Uk)("Group List "),(0,t.Wm)(y,{"error-list":m.v$.groupModel.$errors},null,8,["error-list"])]),(0,t.Wm)(v,{options:h.groupFixResults,label:"group",value:h.groupModel,"onUpdate:value":o[0]||(o[0]=e=>h.groupModel=e),multiple:""},null,8,["options","value"]),(0,t.kq)(" ALERT FOR WHEN USER GROUPS ARE NOT INCLUDED "),p,r.displayGroupPermissionIssue?((0,t.wg)(),(0,t.iD)("div",c," None of your user groups were included. You will not have permissions to create this object. Please select one of your groups ")):(0,t.kq)("v-if",!0)])])}]])},7939:(e,o,r)=>{r.d(o,{Z:()=>l});var t=r(6252),a=r(3577);const n={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},l=(0,r(3744).Z)(n,[["render",function(e,o,r,n,l,s){return(0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(r.errorList,(e=>((0,t.wg)(),(0,t.iD)("span",{class:"error",key:e.$uid},(0,a.toDisplayString)(e.$message),1)))),128)}]])},3058:(e,o,r)=>{r.d(o,{Z:()=>a});var t=r(3138);const a={methods:{showErrorModal(e,o,r){const a=document.getElementById("loadingModal");if(null===a)return;new t.u_(a).hide();const n=document.getElementById("errorModalContent");if(void 0===n)return;if(n.innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${o}-${r}<hr>${e}`,null===document.getElementById("errorModal"))return;const l=new t.u_(l);l.show()},showValidationErrorModal(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new t.u_(document.getElementById("errorModal")).show()}}}}}]);