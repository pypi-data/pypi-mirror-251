"use strict";(self.webpackChunknearbeach=self.webpackChunknearbeach||[]).push([[6023],{4718:(e,t,o)=>{o.r(t),o.d(t,{default:()=>T});var a=o(6252);const s={class:"card"},r={class:"card-body"},l=(0,a._)("h1",null,"New Customer",-1),i=(0,a._)("hr",null,null,-1),n=(0,a._)("hr",null,null,-1),u={class:"row"},d=(0,a._)("div",{class:"col-md-4"},[(0,a._)("strong",null,"Customer Organisation"),(0,a._)("p",{class:"text-instructions"}," This field is optional. If this customer does not have any organisations attached, it will treat this customer as a freelancer. ")],-1),m={class:"col-md-8"},c={class:"form-group col-sm-8"},h=(0,a._)("label",null,"Organisation:",-1),g=(0,a._)("hr",null,null,-1),p={class:"row submit-row"},M={class:"col-md-12"};var f=o(3138),v=o(5705),_=o(760),w=o(3058),N=o(624),E=o(9113),C=o(160),y=o(2001);const k={name:"NewCustomer",setup:()=>({v$:(0,v.ZP)()}),components:{NewCustomerForm:C.Z,NSelect:y.Z},props:{organisationName:{type:String,default:""},rootUrl:{type:String,default:"/"},theme:{type:String,default:""},titleList:{type:Array,default:()=>[]}},mixins:[w.Z,N.Z,E.Z],data:()=>({customerEmailModel:"",customerFirstNameModel:"",customerLastNameModel:"",flagValidationCheck:!1,organisationFixList:[],organisationModel:"",titleModel:[]}),validations:()=>({customerEmailModel:{required:_.C1,email:_.Do},customerFirstNameModel:{required:_.C1},customerLastNameModel:{required:_.C1},titleModel:{required:_.C1}}),methods:{fetchOptions(e,t){this.searchTrigger({return_function:this.getOrganisationData,searchTimeout:this.searchTimeout,search:e,loading:t})},getOrganisationData(e,t){const o=new FormData;o.set("search",e),this.axios.post(`${this.rootUrl}search/organisation/data/`,o).then((e=>{const t=e.data;this.organisationFixList=t.map((e=>({value:e.pk,label:e.fields.organisation_name})))})).catch((e=>{this.showErrorModal(e,"Search Organisation Issues: can not get list of existing organisations","")}))},submitNewCustomer:async function(){if(this.flagValidationCheck=!0,setTimeout((()=>{this.flagValidationCheck=!1}),100),this.v$.$touch(),!await this.v$.$validate())return document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",void new f.u_(document.getElementById("errorModal")).show();const e=new FormData;e.set("customer_title",this.titleModel),e.set("customer_first_name",this.customerFirstNameModel),e.set("customer_last_name",this.customerLastNameModel),e.set("customer_email",this.customerEmailModel),""!==this.organisationModel&&null!==this.organisationModel&&e.set("organisation",this.organisationModel),this.axios.post(`${this.rootUrl}new_customer/save/`,e).then((e=>{window.location.href=e.data})).catch((e=>{this.showErrorModal(e,"customer","")}))},updateCustomerData(e){this[e.field]=e.value}},mounted(){this.$nextTick((()=>{this.getOrganisationData("","")}))}},T=(0,o(3744).Z)(k,[["render",function(e,t,o,f,v,_){const w=(0,a.up)("new-customer-form"),N=(0,a.up)("n-select"),E=(0,a.up)("n-config-provider");return(0,a.wg)(),(0,a.j4)(E,{theme:e.getTheme(o.theme)},{default:(0,a.w5)((()=>[(0,a._)("div",s,[(0,a._)("div",r,[(0,a.kq)(" HEADER "),l,i,(0,a.Uk)(" New Customer Form "),(0,a.Wm)(w,{"organisation-name":o.organisationName,"title-list":o.titleList,"flag-validation-check":v.flagValidationCheck,onUpdate_customer_data:t[0]||(t[0]=e=>_.updateCustomerData(e))},null,8,["organisation-name","title-list","flag-validation-check"]),(0,a.kq)(" CUSTOMER ORGANISATION "),n,(0,a._)("div",u,[d,(0,a._)("div",m,[(0,a._)("div",c,[h,(0,a.Wm)(N,{options:v.organisationFixList,filterable:"",placeholder:"Search Organisations",onSearch:_.fetchOptions,value:v.organisationModel,"onUpdate:value":t[1]||(t[1]=e=>v.organisationModel=e),label:"organisation_name",class:"get-stakeholders"},null,8,["options","onSearch","value"])])])]),(0,a.kq)(" REMEMBER TO ADD IN USER PERMISSIONS HERE!! "),(0,a.kq)(" Submit Button "),g,(0,a._)("div",p,[(0,a._)("div",M,[(0,a._)("a",{href:"javascript:void(0)",class:"btn btn-primary save-changes",onClick:t[2]||(t[2]=(...e)=>_.submitNewCustomer&&_.submitNewCustomer(...e))},"Submit Customer")])])])])])),_:1},8,["theme"])}]])},160:(e,t,o)=>{o.d(t,{Z:()=>w});var a=o(6252),s=o(9963);const r={class:"row"},l=(0,a._)("div",{class:"col-md-4"},[(0,a._)("strong",null,"New Customer"),(0,a._)("p",{class:"text-instructions"}," Please fill out the following details. "),(0,a._)("strong",null,"Please Note:"),(0,a._)("p",{class:"text-instructions"}," Customers do not go through a duplication process. Please search for the potential customer first before adding them into NearBeach. ")],-1),i={class:"col-md-8"},n={class:"row"},u={class:"form-group col-sm-3"},d={class:"form-group col-sm-4"},m={class:"form-group col-sm-5"},c=(0,a._)("br",null,null,-1),h={class:"form-group col-sm-8"},g=(0,a._)("br",null,null,-1);var p=o(2001),M=o(5705),f=o(760),v=o(7939);const _={name:"NewCustomerForm",setup:()=>({v$:(0,M.ZP)()}),components:{NSelect:p.Z,ValidationRendering:v.Z},props:{flagValidationCheck:{type:Boolean,default:!1},organisationName:{type:String,default:""},titleList:{type:Array,default:()=>[]}},data:()=>({customerEmailModel:"",customerFirstNameModel:"",customerLastNameModel:"",organisationModel:{},searchTimeout:"",titleFixList:[],titleModel:[]}),validations:{customerEmailModel:{required:f.C1,email:f.Do},customerFirstNameModel:{required:f.C1},customerLastNameModel:{required:f.C1},titleModel:{required:f.C1}},methods:{},watch:{customerEmailModel(){this.$emit("update_customer_data",{field:"customerEmailModel",value:this.customerEmailModel})},customerFirstNameModel(){this.$emit("update_customer_data",{field:"customerFirstNameModel",value:this.customerFirstNameModel})},customerLastNameModel(){this.$emit("update_customer_data",{field:"customerLastNameModel",value:this.customerLastNameModel})},flagValidationCheck(){this.flagValidationCheck&&this.v$.$touch()},titleModel(){this.$emit("update_customer_data",{field:"titleModel",value:this.titleModel})}},mounted(){this.titleFixList=this.titleList.map((e=>({value:e.pk,label:e.fields.title})))}},w=(0,o(3744).Z)(_,[["render",function(e,t,o,p,M,f){const v=(0,a.up)("validation-rendering"),_=(0,a.up)("n-select");return(0,a.wg)(),(0,a.iD)("div",r,[l,(0,a._)("div",i,[(0,a.kq)(" CUSTOMER DETAILS "),(0,a._)("div",n,[(0,a._)("div",u,[(0,a._)("label",null,[(0,a.Uk)(" Title: "),(0,a.Wm)(v,{"error-list":p.v$.titleModel.$errors},null,8,["error-list"])]),(0,a.Wm)(_,{options:M.titleFixList,label:"title",placeholder:"",value:M.titleModel,"onUpdate:value":t[0]||(t[0]=e=>M.titleModel=e)},null,8,["options","value"])]),(0,a._)("div",d,[(0,a._)("label",null,[(0,a.Uk)(" First Name: "),(0,a.Wm)(v,{"error-list":p.v$.customerFirstNameModel.$errors},null,8,["error-list"])]),(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[1]||(t[1]=e=>M.customerFirstNameModel=e)},null,512),[[s.vModelText,M.customerFirstNameModel]])]),(0,a._)("div",m,[(0,a._)("label",null,[(0,a.Uk)(" Last Name: "),(0,a.Wm)(v,{"error-list":p.v$.customerLastNameModel.$errors},null,8,["error-list"])]),(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[2]||(t[2]=e=>M.customerLastNameModel=e)},null,512),[[s.vModelText,M.customerLastNameModel]])])]),c,(0,a.kq)(" Customer Email "),(0,a._)("div",h,[(0,a._)("label",null,[(0,a.Uk)(" Email: "),(0,a.Wm)(v,{"error-list":p.v$.customerEmailModel.$errors},null,8,["error-list"])]),(0,a.wy)((0,a._)("input",{type:"text",class:"form-control","onUpdate:modelValue":t[3]||(t[3]=e=>M.customerEmailModel=e)},null,512),[[s.vModelText,M.customerEmailModel]])]),g])])}]])},7939:(e,t,o)=>{o.d(t,{Z:()=>l});var a=o(6252),s=o(3577);const r={name:"ValidationRendering",props:{errorList:{type:Array,default:()=>[]}}},l=(0,o(3744).Z)(r,[["render",function(e,t,o,r,l,i){return(0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.errorList,(e=>((0,a.wg)(),(0,a.iD)("span",{class:"error",key:e.$uid},(0,s.toDisplayString)(e.$message),1)))),128)}]])},3058:(e,t,o)=>{o.d(t,{Z:()=>s});var a=o(3138);const s={methods:{showErrorModal(e,t,o){const s=document.getElementById("loadingModal");if(null===s)return;new a.u_(s).hide();const r=document.getElementById("errorModalContent");if(void 0===r)return;if(r.innerHTML=`<strong>HTML ISSUE:</strong> We could not save the new ${t}-${o}<hr>${e}`,null===document.getElementById("errorModal"))return;const l=new a.u_(l);l.show()},showValidationErrorModal(){document.getElementById("errorModalContent").innerHTML="<strong>FORM ISSUE:</strong> Sorry, but can you please fill out the form completely.",new a.u_(document.getElementById("errorModal")).show()}}}},624:(e,t,o)=>{o.d(t,{Z:()=>s});var a=o(7449);const s={data:()=>({darkTheme:a.$}),methods:{getTheme:e=>"dark"===e?a.$:null}}},9113:(e,t,o)=>{o.d(t,{Z:()=>a});const a={methods:{searchTrigger(e){""!==e.searchTimeout&&clearTimeout(e.searchTimeout),void 0===e.search?this.searchUndefined(e):this.searchDefined(e)},searchDefined(e){e.search.length>=3&&(e.searchTimeout=setTimeout(e.return_function,500,e.search,e.loading))},searchUndefined(e){e.searchTimeout=setTimeout(e.return_function,500)}}}}}]);