import{x as le,E as he,bL as He,G as oe,aB as We,aA as F,K as ie,L as l,_ as U,R as d,O as w,aP as Ne,aF as ue,P as C,aQ as Re,am as X,bM as Qe,bN as Xe,h as v,bO as ke,J as fe,s as Se,r as ve,S as Ze,p as Je,av as Me,bP as et,i as Fe,aj as tt,z as W,bQ as at,bk as Ce,bl as lt,bR as st,bn as rt,bS as nt,bT as ot,az as Te,ax as it,al as be,ak as ne,bU as ut,bV as dt,M as te,aE as T,bW as ct,ab as Ee,aH as R,ae as V,bX as mt,b5 as De,aJ as m,aa as D,ad as ae,Q as Le,l as vt,b4 as $e,bx as ht,bY as ft,aD as bt,m as pt,be as gt,bf as yt,ba as we,N as me,k as _t,bb as kt,bd as St,aW as Ct,b1 as Tt,aN as wt,aO as Vt}from"./admin-drawer-panel-JjJ1iA6R.js";import{a as Bt,g as Pt,e as It,i as Nt}from"./VToolbar-BBzymioO.js";import{m as Rt,a as Mt,u as Ft,V as Ve,b as Et}from"./VSelectionControl-9CzKd8rG.js";import{C as Dt,u as Q,A as Lt}from"./main-fEXxBNBg.js";import{c as $t,d as Ot}from"./VSelect-Yw9YsgjJ.js";import{c as At}from"./to-case-FdEoSAB7.js";import{V as zt}from"./confirm-footer-IJHq21-K.js";const jt=le({...he(),...He({variant:"text"})},"VToolbarItems"),Tl=oe()({name:"VToolbarItems",props:jt(),setup(e,t){let{slots:a}=t;return We({VBtn:{color:F(e,"color"),height:"inherit",variant:F(e,"variant")}}),ie(()=>{var n;return l("div",{class:["v-toolbar-items",e.class],style:e.style},[(n=a.default)==null?void 0:n.call(a)])}),{}}}),Ut={name:"PaginationToolbar"};function qt(e,t,a,n,o,s){return d(),w(Bt,{class:"paginationToolbar codexToolbar",density:"compact",transform:"center bottom"},Ne({_:2},[ue(e.$slots,(i,r)=>({name:r,fn:C(c=>[Re(e.$slots,r,X({props:i},c),void 0,!0)])}))]),1024)}const wl=U(Ut,[["render",qt],["__scopeId","data-v-cfa8cce0"]]),pe=Symbol.for("vuetify:v-slider");function Gt(e,t,a){const n=a==="vertical",o=t.getBoundingClientRect(),s="touches"in e?e.touches[0]:e;return n?s.clientY-(o.top+o.height/2):s.clientX-(o.left+o.width/2)}function Kt(e,t){return"touches"in e&&e.touches.length?e.touches[0][t]:"changedTouches"in e&&e.changedTouches.length?e.changedTouches[0][t]:e[t]}const Yt=le({disabled:{type:Boolean,default:null},error:Boolean,readonly:{type:Boolean,default:null},max:{type:[Number,String],default:100},min:{type:[Number,String],default:0},step:{type:[Number,String],default:0},thumbColor:String,thumbLabel:{type:[Boolean,String],default:void 0,validator:e=>typeof e=="boolean"||e==="always"},thumbSize:{type:[Number,String],default:20},showTicks:{type:[Boolean,String],default:!1,validator:e=>typeof e=="boolean"||e==="always"},ticks:{type:[Array,Object]},tickSize:{type:[Number,String],default:2},color:String,trackColor:String,trackFillColor:String,trackSize:{type:[Number,String],default:4},direction:{type:String,default:"horizontal",validator:e=>["vertical","horizontal"].includes(e)},reverse:Boolean,...Qe(),...Xe({elevation:2}),ripple:{type:Boolean,default:!0}},"Slider"),xt=e=>{const t=v(()=>parseFloat(e.min)),a=v(()=>parseFloat(e.max)),n=v(()=>+e.step>0?parseFloat(e.step):0),o=v(()=>Math.max(ke(n.value),ke(t.value)));function s(i){if(i=parseFloat(i),n.value<=0)return i;const r=Me(i,t.value,a.value),c=t.value%n.value,h=Math.round((r-c)/n.value)*n.value+c;return parseFloat(Math.min(h,a.value).toFixed(o.value))}return{min:t,max:a,step:n,decimals:o,roundValue:s}},Ht=e=>{let{props:t,steps:a,onSliderStart:n,onSliderMove:o,onSliderEnd:s,getActiveThumb:i}=e;const{isRtl:r}=fe(),c=F(t,"reverse"),h=v(()=>t.direction==="vertical"),B=v(()=>h.value!==c.value),{min:y,max:b,step:L,decimals:q,roundValue:A}=a,x=v(()=>parseInt(t.thumbSize,10)),G=v(()=>parseInt(t.tickSize,10)),z=v(()=>parseInt(t.trackSize,10)),$=v(()=>(b.value-y.value)/L.value),K=F(t,"disabled"),E=v(()=>t.error||t.disabled?void 0:t.thumbColor??t.color),p=v(()=>t.error||t.disabled?void 0:t.trackColor??t.color),M=v(()=>t.error||t.disabled?void 0:t.trackFillColor??t.color),_=Se(!1),k=Se(0),P=ve(),I=ve();function f(u){var _e;const g=t.direction==="vertical",Ue=g?"top":"left",qe=g?"height":"width",Ge=g?"clientY":"clientX",{[Ue]:Ke,[qe]:Ye}=(_e=P.value)==null?void 0:_e.$el.getBoundingClientRect(),xe=Kt(u,Ge);let ce=Math.min(Math.max((xe-Ke-k.value)/Ye,0),1)||0;return(g?B.value:B.value!==r.value)&&(ce=1-ce),A(y.value+ce*(b.value-y.value))}const O=u=>{s({value:f(u)}),_.value=!1,k.value=0},Z=u=>{I.value=i(u),I.value&&(I.value.focus(),_.value=!0,I.value.contains(u.target)?k.value=Gt(u,I.value,t.direction):(k.value=0,o({value:f(u)})),n({value:f(u)}))},j={passive:!0,capture:!0};function J(u){o({value:f(u)})}function se(u){u.stopPropagation(),u.preventDefault(),O(u),window.removeEventListener("mousemove",J,j),window.removeEventListener("mouseup",se)}function S(u){var g;O(u),window.removeEventListener("touchmove",J,j),(g=u.target)==null||g.removeEventListener("touchend",S)}function N(u){var g;Z(u),window.addEventListener("touchmove",J,j),(g=u.target)==null||g.addEventListener("touchend",S,{passive:!1})}function Y(u){u.preventDefault(),Z(u),window.addEventListener("mousemove",J,j),window.addEventListener("mouseup",se,{passive:!1})}const H=u=>{const g=(u-y.value)/(b.value-y.value)*100;return Me(isNaN(g)?0:g,0,100)},ee=F(t,"showTicks"),re=v(()=>ee.value?t.ticks?Array.isArray(t.ticks)?t.ticks.map(u=>({value:u,position:H(u),label:u.toString()})):Object.keys(t.ticks).map(u=>({value:parseFloat(u),position:H(parseFloat(u)),label:t.ticks[u]})):$.value!==1/0?Ze($.value+1).map(u=>{const g=y.value+u*L.value;return{value:g,position:H(g)}}):[]:[]),de=v(()=>re.value.some(u=>{let{label:g}=u;return!!g})),ye={activeThumbRef:I,color:F(t,"color"),decimals:q,disabled:K,direction:F(t,"direction"),elevation:F(t,"elevation"),hasLabels:de,isReversed:c,indexFromEnd:B,min:y,max:b,mousePressed:_,numTicks:$,onSliderMousedown:Y,onSliderTouchstart:N,parsedTicks:re,parseMouseMove:f,position:H,readonly:F(t,"readonly"),rounded:F(t,"rounded"),roundValue:A,showTicks:ee,startOffset:k,step:L,thumbSize:x,thumbColor:E,thumbLabel:F(t,"thumbLabel"),ticks:F(t,"ticks"),tickSize:G,trackColor:p,trackContainerRef:P,trackFillColor:M,trackSize:z,vertical:h};return Je(pe,ye),ye},Wt=le({focused:Boolean,max:{type:Number,required:!0},min:{type:Number,required:!0},modelValue:{type:Number,required:!0},position:{type:Number,required:!0},ripple:{type:[Boolean,Object],default:!0},...he()},"VSliderThumb"),Qt=oe()({name:"VSliderThumb",directives:{Ripple:et},props:Wt(),emits:{"update:modelValue":e=>!0},setup(e,t){let{slots:a,emit:n}=t;const o=Fe(pe),{isRtl:s,rtlClasses:i}=fe();if(!o)throw new Error("[Vuetify] v-slider-thumb must be used inside v-slider or v-range-slider");const{thumbColor:r,step:c,disabled:h,thumbSize:B,thumbLabel:y,direction:b,isReversed:L,vertical:q,readonly:A,elevation:x,mousePressed:G,decimals:z,indexFromEnd:$}=o,{textColorClasses:K,textColorStyles:E}=tt(r),{pageup:p,pagedown:M,end:_,home:k,left:P,right:I,down:f,up:O}=nt,Z=[p,M,_,k,P,I,f,O],j=v(()=>c.value?[1,2,3]:[1,5,10]);function J(S,N){if(!Z.includes(S.key))return;S.preventDefault();const Y=c.value||.1,H=(e.max-e.min)/Y;if([P,I,f,O].includes(S.key)){const re=(q.value?[s.value?P:I,L.value?f:O]:$.value!==s.value?[P,O]:[I,O]).includes(S.key)?1:-1,de=S.shiftKey?2:S.ctrlKey?1:0;N=N+re*Y*j.value[de]}else if(S.key===k)N=e.min;else if(S.key===_)N=e.max;else{const ee=S.key===M?1:-1;N=N-ee*Y*(H>100?H/10:10)}return Math.max(e.min,Math.min(e.max,N))}function se(S){const N=J(S,e.modelValue);N!=null&&n("update:modelValue",N)}return ie(()=>{const S=W($.value?100-e.position:e.position,"%"),{elevationClasses:N}=at(v(()=>h.value?void 0:x.value));return l("div",{class:["v-slider-thumb",{"v-slider-thumb--focused":e.focused,"v-slider-thumb--pressed":e.focused&&G.value},e.class,i.value],style:[{"--v-slider-thumb-position":S,"--v-slider-thumb-size":W(B.value)},e.style],role:"slider",tabindex:h.value?-1:0,"aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":e.modelValue,"aria-readonly":!!A.value,"aria-orientation":b.value,onKeydown:A.value?void 0:se},[l("div",{class:["v-slider-thumb__surface",K.value,N.value],style:{...E.value}},null),Ce(l("div",{class:["v-slider-thumb__ripple",K.value],style:E.value},null),[[lt("ripple"),e.ripple,null,{circle:!0,center:!0}]]),l(st,{origin:"bottom center"},{default:()=>{var Y;return[Ce(l("div",{class:"v-slider-thumb__label-container"},[l("div",{class:["v-slider-thumb__label"]},[l("div",null,[((Y=a["thumb-label"])==null?void 0:Y.call(a,{modelValue:e.modelValue}))??e.modelValue.toFixed(c.value?z.value:1)])])]),[[rt,y.value&&e.focused||y.value==="always"]])]}})])}),{}}}),Xt=le({start:{type:Number,required:!0},stop:{type:Number,required:!0},...he()},"VSliderTrack"),Zt=oe()({name:"VSliderTrack",props:Xt(),emits:{},setup(e,t){let{slots:a}=t;const n=Fe(pe);if(!n)throw new Error("[Vuetify] v-slider-track must be inside v-slider or v-range-slider");const{color:o,parsedTicks:s,rounded:i,showTicks:r,tickSize:c,trackColor:h,trackFillColor:B,trackSize:y,vertical:b,min:L,max:q,indexFromEnd:A}=n,{roundedClasses:x}=ot(i),{backgroundColorClasses:G,backgroundColorStyles:z}=Te(B),{backgroundColorClasses:$,backgroundColorStyles:K}=Te(h),E=v(()=>`inset-${b.value?"block":"inline"}-${A.value?"end":"start"}`),p=v(()=>b.value?"height":"width"),M=v(()=>({[E.value]:"0%",[p.value]:"100%"})),_=v(()=>e.stop-e.start),k=v(()=>({[E.value]:W(e.start,"%"),[p.value]:W(_.value,"%")})),P=v(()=>r.value?(b.value?s.value.slice().reverse():s.value).map((f,O)=>{var j;const Z=f.value!==L.value&&f.value!==q.value?W(f.position,"%"):void 0;return l("div",{key:f.value,class:["v-slider-track__tick",{"v-slider-track__tick--filled":f.position>=e.start&&f.position<=e.stop,"v-slider-track__tick--first":f.value===L.value,"v-slider-track__tick--last":f.value===q.value}],style:{[E.value]:Z}},[(f.label||a["tick-label"])&&l("div",{class:"v-slider-track__tick-label"},[((j=a["tick-label"])==null?void 0:j.call(a,{tick:f,index:O}))??f.label])])}):[]);return ie(()=>l("div",{class:["v-slider-track",x.value,e.class],style:[{"--v-slider-track-size":W(y.value),"--v-slider-tick-size":W(c.value)},e.style]},[l("div",{class:["v-slider-track__background",$.value,{"v-slider-track__background--opacity":!!o.value||!B.value}],style:{...M.value,...K.value}},null),l("div",{class:["v-slider-track__fill",G.value],style:{...k.value,...z.value}},null),r.value&&l("div",{class:["v-slider-track__ticks",{"v-slider-track__ticks--always-show":r.value==="always"}]},[P.value])])),{}}}),Jt=le({...Rt(),...Yt(),...Mt(),modelValue:{type:[Number,String],default:0}},"VSlider"),ea=oe()({name:"VSlider",props:Jt(),emits:{"update:focused":e=>!0,"update:modelValue":e=>!0,start:e=>!0,end:e=>!0},setup(e,t){let{slots:a,emit:n}=t;const o=ve(),{rtlClasses:s}=fe(),i=xt(e),r=it(e,"modelValue",void 0,p=>i.roundValue(p??i.min.value)),{min:c,max:h,mousePressed:B,roundValue:y,onSliderMousedown:b,onSliderTouchstart:L,trackContainerRef:q,position:A,hasLabels:x,readonly:G}=Ht({props:e,steps:i,onSliderStart:()=>{n("start",r.value)},onSliderEnd:p=>{let{value:M}=p;const _=y(M);r.value=_,n("end",_)},onSliderMove:p=>{let{value:M}=p;return r.value=y(M)},getActiveThumb:()=>{var p;return(p=o.value)==null?void 0:p.$el}}),{isFocused:z,focus:$,blur:K}=Ft(e),E=v(()=>A(r.value));return ie(()=>{const p=Ve.filterProps(e),M=!!(e.label||a.label||a.prepend);return l(Ve,X({class:["v-slider",{"v-slider--has-labels":!!a["tick-label"]||x.value,"v-slider--focused":z.value,"v-slider--pressed":B.value,"v-slider--disabled":e.disabled},s.value,e.class],style:e.style},p,{focused:z.value}),{...a,prepend:M?_=>{var k,P;return l(be,null,[((k=a.label)==null?void 0:k.call(a,_))??(e.label?l(Et,{id:_.id.value,class:"v-slider__label",text:e.label},null):void 0),(P=a.prepend)==null?void 0:P.call(a,_)])}:void 0,default:_=>{let{id:k,messagesId:P}=_;return l("div",{class:"v-slider__container",onMousedown:G.value?void 0:b,onTouchstartPassive:G.value?void 0:L},[l("input",{id:k.value,name:e.name||k.value,disabled:!!e.disabled,readonly:!!e.readonly,tabindex:"-1",value:r.value},null),l(Zt,{ref:q,start:0,stop:E.value},{"tick-label":a["tick-label"]}),l(Qt,{ref:o,"aria-describedby":P.value,focused:z.value,min:c.value,max:h.value,modelValue:r.value,"onUpdate:modelValue":I=>r.value=I,position:E.value,elevation:e.elevation,onFocus:$,onBlur:K,ripple:e.ripple},{"thumb-label":a["thumb-label"]})])}})}),{}}}),ta={name:"PaginationSlider"};function aa(e,t,a,n,o,s){return d(),w(ea,X({"thumb-size":"36",class:"paginationSlider",density:"compact","hide-details":"auto",rounded:!0,"show-ticks":"always",step:1,"thumb-label":"always"},e.$attrs),null,16)}const Vl=U(ta,[["render",aa],["__scopeId","data-v-825b160e"]]),la={name:"PaginationNavButton"};function sa(e,t,a,n,o,s){return d(),w(ne,X({class:"paginationNavButton",height:"100%"},e.$attrs),Ne({_:2},[ue(e.$slots,(i,r)=>({name:r,fn:C(c=>[Re(e.$slots,r,X({props:i},c),void 0,!0)])}))]),1040)}const Bl=U(la,[["render",sa],["__scopeId","data-v-852fad11"]]),Be=Dt.browser.vuetifyNullCode,ra=new Set(["",Be,Be.toString(),void 0]),na=function(e){let t;return e===void 0?t=e:e instanceof Object?t={value:e.pk,title:e.name}:t={value:e,title:e.toString()},e.url&&(t.url=e.url),t},oa=function(e,t){return e.title<t.title?-1:e.title>t.title?1:0},ia=function(e,t){return Number.parseFloat(e.title)-Number.parseFloat(t.title)},ua=function(e,t,a=!1){const n=e||[],o=t&&t.toLowerCase();let s=[];for(const r of n){if(!r||ra.has(r.pk))continue;const c=na(r);c&&(!o||c.title&&c.title.toLowerCase().includes(o))&&s.push(c)}const i=a?ia:oa;return s.sort(i)},da={name:"PlaceholderLoading",props:{indeterminate:{type:Boolean,default:!0}}};function ca(e,t,a,n,o,s){return d(),w(ut,X({"aria-label":"loading",class:"codexProgressCircular",indeterminate:a.indeterminate},e.$attrs),null,16,["indeterminate"])}const Oe=U(da,[["render",ca],["__scopeId","data-v-7bb4cf22"]]),ma=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],va=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],ha=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],fa=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],Pe=(e,t,a)=>{let n=e;return typeof t=="string"||Array.isArray(t)?n=e.toLocaleString(t,a):(t===!0||a!==void 0)&&(n=e.toLocaleString(void 0,a)),n};function ba(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);t={bits:!1,binary:!1,space:!0,...t};const a=t.bits?t.binary?fa:ha:t.binary?va:ma,n=t.space?" ":"";if(t.signed&&e===0)return` 0${n}${a[0]}`;const o=e<0,s=o?"-":t.signed?"+":"";o&&(e=-e);let i;if(t.minimumFractionDigits!==void 0&&(i={minimumFractionDigits:t.minimumFractionDigits}),t.maximumFractionDigits!==void 0&&(i={maximumFractionDigits:t.maximumFractionDigits,...i}),e<1){const B=Pe(e,t.locale,i);return s+B+n+a[0]}const r=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),a.length-1);e/=(t.binary?1024:1e3)**r,i||(e=e.toPrecision(3));const c=Pe(Number(e),t.locale,i),h=a[r];return s+c+n+h}const pa=(e,t)=>e?`${dt(e)}/cover.webp?${t}`:window.CODEX.MISSING_COVER,ga={name:"BookCover",props:{group:{type:String,required:!0},childCount:{type:Number,default:1},finished:{type:Boolean},coverPk:{type:Number,required:!0}},data(){return{showPlaceholder:!1}},computed:{...te(Q,{coverSrc:function(e){return pa(this.coverPk,e.page.coversTimestamp)}})},mounted:function(){this.delayPlaceholder()},methods:{delayPlaceholder:function(){setTimeout(()=>{this.showPlaceholder=!0},2e3)}}},ya={class:"bookCover"},_a={key:1,class:"childCount"};function ka(e,t,a,n,o,s){return d(),T("div",ya,[l(ct,{src:e.coverSrc,class:"coverImg"},null,8,["src"]),a.finished!==!0?(d(),T("div",{key:0,class:Ee({unreadFlag:!0,mixedreadFlag:a.finished===null})},null,2)):R("",!0),a.group!=="c"?(d(),T("span",_a,V(a.childCount),1)):R("",!0)])}const Ae=U(ga,[["render",ka],["__scopeId","data-v-9acb5f6a"]]),Sa={name:"MetadataTags",props:{label:{type:String,required:!0},values:{type:Array,default(){return[]}},filter:{type:String,required:!1,default:void 0}},data(){return{mdiFilter:mt,mdiOpenInNew:De}},computed:{...te(Q,{filterValues:function(e){const t=this.filter||this.label.toLowerCase();return e.settings.filters[t]}}),model(){return ua(this.values)}},methods:{chipColor:function(e){return this.filterValues&&this.filterValues.includes(e)?this.$vuetify.theme.current.colors["primary-darken-1"]:""}}},Ca={key:0,class:"tags"},Ta={class:"label"},wa=["href"],Va={key:1};function Ba(e,t,a,n,o,s){return s.model&&s.model.length>0?(d(),T("div",Ca,[l(Ot,{value:s.model,multiple:"",class:"chipGroup"},{default:C(()=>[m("div",Ta,V(a.label),1),(d(!0),T(be,null,ue(s.model,i=>(d(),w($t,{key:`${a.label}/${i.value}`,color:s.chipColor(i.value),value:i.value},{default:C(()=>[i.url?(d(),T("a",{key:0,href:i.url,target:"_blank"},[D(V(i.title),1),l(ae,null,{default:C(()=>[D(V(o.mdiOpenInNew),1)]),_:1})],8,wa)):(d(),T("span",Va,V(i.title),1))]),_:2},1032,["color","value"]))),128))]),_:1},8,["value"])])):R("",!0)}const ge=U(Sa,[["render",Ba],["__scopeId","data-v-59c9d373"]]),Pa={name:"MetadataTextBox",props:{label:{type:String,required:!0},value:{type:[Object,String,Number,Boolean],default:void 0},link:{type:[Boolean,String],default:!1},group:{type:String,default:""},obj:{type:Object,default:void 0}},data(){return{mdiOpenInNew:De}},computed:{computedValue(){return this.value!=null&&this.value instanceof Object?this.value.name:this.value},linkValue(){return this.link===!0?this.computedValue:this.link?this.link:!1},highlight(){var e;return((e=this.obj)==null?void 0:e.group)===this.group},pathArray(){if(this.computedValue)return this.computedValue.split("/")},folderPath(){if(this.pathArray)return this.pathArray.slice(0,-1).join("/")},basePath(){if(this.pathArray)return this.pathArray.at(-1)},groupTo(){const e=Q();if(this.group!=="f"&&!e.settings.show[this.group]||this.group==="f"&&!e.page.adminFlags.folderView)return;let t;if(t=this.obj&&this.obj.group==this.group?this.obj.pk:this.value.pk,!t)return;const a=this.$router.currentRoute.value.params;if(!(a.group===this.group&&+a.pk===t))return{name:"browser",params:{group:this.group,pk:t}}}}},Ia={class:"textLabel"},Na={class:"textValue"},Ra=["href"],Ma={key:3,class:"textContent"},Fa={key:4,id:"basePath"};function Ea(e,t,a,n,o,s){const i=Le("router-link");return s.computedValue?(d(),T("div",{key:0,class:Ee(["text",{highlight:s.highlight}])},[m("div",Ia,V(a.label),1),m("div",Na,[s.groupTo&&a.group==="f"?(d(),w(i,{key:0,id:"folderPath",to:s.groupTo,title:"Browse Folder"},{default:C(()=>[D(V(s.folderPath)+"/",1)]),_:1},8,["to"])):s.groupTo?(d(),w(i,{key:1,class:"textContent",to:s.groupTo,title:`Browse ${a.label}`},{default:C(()=>[D(V(s.computedValue),1)]),_:1},8,["to","title"])):a.link?(d(),T("a",{key:2,href:s.linkValue,target:"_blank"},[D(V(s.computedValue)+" ",1),l(ae,{size:"small"},{default:C(()=>[D(V(o.mdiOpenInNew),1)]),_:1})],8,Ra)):(d(),T("div",Ma,V(s.computedValue),1)),s.groupTo&&a.group==="f"?(d(),T("span",Fa,V(s.basePath),1)):R("",!0)])],2)):R("",!0)}const ze=U(Pa,[["render",Ea],["__scopeId","data-v-0d27e6b3"]]),Da={name:"MetadataContributorsTable",props:{value:{type:Array,default:void 0}},data(){return{}},computed:{contributorsDict(){const e={};for(const{role:n,person:o}of this.value){const s=At(n.name)+"s";e[s]||(e[s]=[]),e[s].push(o)}const t=Object.keys(e).sort((n,o)=>n.localeCompare(o)),a={};for(const n of t)a[n]=e[n].sort((o,s)=>o.name.localeCompare(s.name));return a}}},La={key:0},$a=m("h3",null,"Contributors",-1);function Oa(e,t,a,n,o,s){const i=ge;return Object.keys(s.contributorsDict).length>0?(d(),T("div",La,[$a,(d(!0),T(be,null,ue(Object.entries(s.contributorsDict),([r,c])=>(d(),w(i,{key:r,values:c,label:r,filter:"contributors"},null,8,["values","label"]))),128))])):R("",!0)}const Aa=U(Da,[["render",Oa]]),je=new Set("rtl","btt");Object.freeze(je);const za=({pk:e,page:t,readingDirection:a,pageCount:n})=>{if(n){if(t)t=Number(t);else if(je.has(a)){const o=Number(n)-1;t=Math.max(o,0)}else t=0;return{name:"reader",params:{pk:e,page:t}}}},Ie=vt("metadata",{state:()=>({md:void 0}),actions:{async loadMetadata({group:e,pk:t}){const a=Q();await Lt.getMetadata({group:e,pk:t},a.settings).then(n=>(this.md=n.data,!0)).catch(n=>{console.error(n),this.clearMetadata()})},clearMetadata(){this.md=void 0}}}),ja=1160,Ua=.05,qa=250,Ga={name:"MetadataButton",components:{BookCover:Ae,CloseButton:$e,MetadataContributorsTable:Aa,MetadataTags:ge,MetadataText:ze,PlaceholderLoading:Oe},props:{group:{type:String,required:!0},pk:{type:Number,required:!0},children:{type:Number,default:1}},data(){return{mdiDownload:ht,mdiTagOutline:ft,dialog:!1,progress:0}},computed:{...bt(pt,["isUserAdmin"]),...te(Q,{twentyFourHourTime:e=>e.settings.twentyFourHourTime,readingDirectionTitles:e=>e.choices.static.readingDirection,identifierTypes:e=>e.choices.static.identifierType}),...te(Ie,{md:e=>e.md,downloadFileName:e=>{const t=e.md;return e.md.path?t.path.split("/").at(-1):Pt({seriesName:t.series.name,volumeName:t.volume.name,issueNumber:t.issueNumber,issueSuffix:t.issueSuffix})+"."+(void 0).fileType.toLowerCase()}}),...te(Q,{q:e=>e.settings.q}),downloadURL(){return It(this.pk)},isReadButtonShown(){return this.group==="c"&&this.$route.name!="reader"},isReadButtonEnabled(){return this.$route.name==="browser"&&!!this.readerRoute},readButtonIcon(){return this.isReadButtonEnabled?gt:yt},readerRoute(){return za(this.md)},formattedIssue(){if(!((this.md.issueNumber===null||this.md.issueNumber===void 0)&&!this.md.issueSuffix))return Nt(this.md)},readingDirectionText(){return this.readingDirectionTitles[this.md.readingDirection]},pages(){let e="";if(this.md.page){const a=we.format(this.md.page);e+=`Read ${a} of `}const t=we.format(this.md.pageCount);return e+=`${t} pages`,this.md.progress>0&&(e+=` (${Math.round(this.md.progress)}%)`),e},size(){return this.md.size>0?ba(this.md.size):0},fileType(){return this.md.fileType||"Unknown"},titledIdentifiers(){if(!this.md.identifiers)return this.md.identifiers;const e=[];for(const t of this.md.identifiers){const a=t.name.split(":"),n=a[0],o=a[1],s=this.identifierTypeTitle(n);let i="";s&&s!=="None"&&(i+=s+":"),i+=o,e.push({...t,name:i})}return e}},watch:{dialog(e){e?this.dialogOpened():this.clearMetadata()}},methods:{...me(Ie,["clearMetadata","loadMetadata"]),...me(_t,["downloadIOSPWAFix"]),...me(Q,["identifierTypeTitle"]),dialogOpened(){this.loadMetadata({group:this.group,pk:this.pk}),this.startProgress()},startProgress(){this.startTime=Date.now(),this.estimatedMS=Math.max(Ua,this.children/ja)*1e3,this.updateProgress()},updateProgress(){const e=Date.now()-this.startTime;this.progress=e/this.estimatedMS*100,!(this.progress>=100||this.md)&&setTimeout(()=>{this.updateProgress()},qa)},formatDateTime(e){return kt(e,this.twentyFourHourTime)},download(){this.downloadIOSPWAFix(this.downloadURL,this.md.filename)}}},Ka=e=>(wt("data-v-274e2a70"),e=e(),Vt(),e),Ya={id:"metadataHeader"},xa={id:"metadataBookCoverWrapper"},Ha={class:"inlineRow"},Wa={class:"inlineRow"},Qa={class:"inlineRow"},Xa={key:1,class:"inlineRow"},Za={id:"metadataBody"},Ja={class:"mdSection"},el={class:"quintRow"},tl={class:"mdSection"},al={class:"quarterRow"},ll={class:"lastSmallRow"},sl={class:"halfRow mdSection"},rl={class:"mdSection"},nl={class:"mdSection"},ol={class:"mdSection"},il={class:"mdSection"},ul={class:"mdSection"},dl={class:"mdSection inlineRow"},cl={class:"inlineRow"},ml={id:"footerLinks"},vl={id:"bottomRightButtons"},hl={key:1,id:"placeholderContainer"},fl=Ka(()=>m("div",{id:"placeholderTitle"},"Tags Loading",-1));function bl(e,t,a,n,o,s){const i=$e,r=ze,c=Ae,h=ge,B=Le("MetadataContributorsTable"),y=Oe;return d(),w(zt,{modelValue:o.dialog,"onUpdate:modelValue":t[5]||(t[5]=b=>o.dialog=b),fullscreen:"",transition:"dialog-bottom-transition"},{activator:C(({props:b})=>[l(ne,X({"aria-label":"tags",class:"tagButton cardControlButton",icon:"",title:"Tags",variant:"text"},b,{onClick:t[0]||(t[0]=St(()=>{},["prevent"]))}),{default:C(()=>[l(ae,null,{default:C(()=>[D(V(o.mdiTagOutline),1)]),_:1})]),_:2},1040)]),default:C(()=>[e.md?(d(),T("div",{key:0,id:"metadataContainer",onKeyup:t[3]||(t[3]=Tt(b=>o.dialog=!1,["esc"]))},[m("header",Ya,[l(i,{class:"closeButton",title:"Close Metadata (esc)",size:"x-large",onClick:t[1]||(t[1]=b=>o.dialog=!1)}),e.q?(d(),w(r,{key:0,id:"search",value:e.q,label:"Search Query",highlight:!0},null,8,["value"])):R("",!0),m("div",xa,[l(c,{id:"bookCover","cover-pk":e.md.coverPk,group:a.group,"child-count":e.md.childCount,finished:e.md.finished},null,8,["cover-pk","group","child-count","finished"]),l(Ct,{class:"bookCoverProgress","model-value":e.md.progress,rounded:"","background-color":"inherit",height:"2","aria-label":"% read"},null,8,["model-value"])]),m("div",Ha,[l(r,{id:"publisher",value:e.md.publisher,group:"p",label:"Publisher",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),l(r,{id:"imprint",value:e.md.imprint,group:"i",label:"Imprint",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"])]),m("div",Wa,[l(r,{id:"series",value:e.md.series,label:"Series",group:"s",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"])]),m("div",Qa,[l(r,{id:"volume",value:e.md.volume,label:"Volume",group:"v",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),l(r,{value:e.md.seriesVolumeCount,label:"Volume Count"},null,8,["value"]),l(r,{id:"issue",value:s.formattedIssue,label:"Issue",group:"c",obj:{pk:e.md.id,group:e.md.group}},null,8,["value","obj"]),l(r,{value:e.md.volumeIssueCount,label:"Issue Count"},null,8,["value"]),l(r,{value:e.md.name,label:"Title"},null,8,["value"])]),e.md.year||e.md.month||e.md.day?(d(),T("div",Xa,[l(r,{value:e.md.year,label:"Year",class:"datePicker",type:"number"},null,8,["value"]),l(r,{value:e.md.month,label:"Month",class:"datePicker"},null,8,["value"]),l(r,{value:e.md.day,label:"Day",class:"datePicker"},null,8,["value"])])):R("",!0)]),m("div",Za,[m("section",Ja,[m("div",el,[l(r,{value:s.pages,label:"Pages"},null,8,["value"]),l(r,{label:"Finished",value:(!!e.md.finished).toString()},null,8,["value"]),l(r,{label:"Reading Direction",value:s.readingDirectionText},null,8,["value"]),l(r,{value:(!!e.md.monochrome).toString(),label:"Monochrome"},null,8,["value"]),l(r,{value:e.md.original_format,label:"Original Format"},null,8,["value"])])]),m("section",tl,[m("div",al,[e.md.createdAt?(d(),w(r,{key:0,value:s.formatDateTime(e.md.createdAt),label:"Created at",class:"mtime"},null,8,["value"])):R("",!0),e.md.updatedAt?(d(),w(r,{key:1,value:s.formatDateTime(e.md.updatedAt),label:"Updated at",class:"mtime"},null,8,["value"])):R("",!0),l(r,{value:s.size,label:"Size"},null,8,["value"]),l(r,{value:s.fileType,label:"File Type"},null,8,["value"])]),m("div",ll,[l(r,{group:"f",value:{pk:e.md.parentFolderPk,name:e.md.path},label:"Path"},null,8,["value"])])]),m("section",sl,[l(r,{value:e.md.country,label:"Country"},null,8,["value"]),l(r,{value:e.md.language,label:"Language"},null,8,["value"])]),m("section",rl,[l(h,{values:s.titledIdentifiers,label:"Identifiers"},null,8,["values"])]),m("section",nl,[l(r,{value:e.md.summary,label:"Summary"},null,8,["value"]),l(r,{value:e.md.review,label:"Review"},null,8,["value"])]),m("section",ol,[l(r,{value:e.md.communityRating,label:"Community Rating"},null,8,["value"]),l(r,{value:e.md.criticalRating,label:"Critical Rating"},null,8,["value"]),l(r,{value:e.md.ageRating,label:"Age Rating"},null,8,["value"])]),m("section",il,[l(h,{values:e.md.genres,label:"Genres"},null,8,["values"]),l(h,{values:e.md.characters,label:"Characters"},null,8,["values"]),l(h,{values:e.md.teams,label:"Teams"},null,8,["values"]),l(h,{values:e.md.locations,label:"Locations"},null,8,["values"]),l(h,{values:e.md.seriesGroups,label:"Series Groups"},null,8,["values"]),l(h,{values:e.md.stories,label:"Stories"},null,8,["values"]),l(h,{values:e.md.storyArcNumbers,label:"Story Arcs"},null,8,["values"]),l(h,{values:e.md.tags,label:"Tags"},null,8,["values"])]),m("section",ul,[l(B,{value:e.md.contributors},null,8,["value"])]),m("section",dl,[l(r,{value:e.md.notes,label:"Notes"},null,8,["value"])]),m("section",cl,[l(r,{value:e.md.tagger,label:"Tagger"},null,8,["value"]),l(r,{value:e.md.scanInfo,label:"Scan"},null,8,["value"])])]),m("footer",ml,[a.group==="c"?(d(),w(ne,{key:0,id:"downloadButton",title:"Download Comic Archive",onClick:s.download},{default:C(()=>[a.group==="c"?(d(),w(ae,{key:0},{default:C(()=>[D(V(o.mdiDownload),1)]),_:1})):R("",!0),D(" Download ")]),_:1},8,["onClick"])):R("",!0),s.isReadButtonShown?(d(),w(ne,{key:1,to:s.readerRoute,title:"Read Comic",disabled:!s.isReadButtonEnabled},{default:C(()=>[l(ae,null,{default:C(()=>[D(V(s.readButtonIcon),1)]),_:1}),D(" Read ")]),_:1},8,["to","disabled"])):R("",!0),m("span",vl,[l(i,{class:"closeButton",title:"Close Metadata (esc)",size:"x-large",onClick:t[2]||(t[2]=b=>o.dialog=!1)})])])],32)):(d(),T("div",hl,[l(i,{class:"closeButton",title:"Close Metadata (esc)",onClick:t[4]||(t[4]=b=>o.dialog=!1)}),fl,l(y,{"model-value":o.progress,indeterminate:o.progress>=100,class:"placeholder"},null,8,["model-value","indeterminate"])]))]),_:1},8,["modelValue"])}const Pl=U(Ga,[["render",bl],["__scopeId","data-v-274e2a70"]]);export{ra as N,Oe as P,Tl as V,Bl as _,Vl as a,wl as b,Pl as c,Ae as d,za as g,ba as p,ua as t};
