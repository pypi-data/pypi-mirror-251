"use strict";(self.webpackChunkpromptmanager=self.webpackChunkpromptmanager||[]).push([[7405],{67728:function(e,n,t){t.d(n,{B6:function(){return c},qC:function(){return a},rQ:function(){return s}});var i=t(74165),o=t(15861),r=function(e){var n=document.cookie.split(";").find((function(n){return n.trim().startsWith("".concat(e,"="))}));return n?n.split("=")[1]:null},s=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n,t,o,r){var s,a;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t(!0),e.next=4,fetch(n);case 4:if((s=e.sent).ok){e.next=7;break}throw new Error(s.statusText);case 7:return e.next=9,s.json();case 9:a=e.sent,o(a),t(!1),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),r(e.t0.message),t(!1);case 18:case"end":return e.stop()}}),e,null,[[0,14]])})));return function(n,t,i,o){return e.apply(this,arguments)}}(),a=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n,t,o,s,a){var c,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-CSRFToken":r("csrftoken")},body:JSON.stringify(t)});case 3:return c=e.sent,e.next=6,c.json();case 6:l=e.sent,s(l),o(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),a(e.t0.message),o(!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,t,i,o,r){return e.apply(this,arguments)}}(),c=function(){var e=(0,o.Z)((0,i.Z)().mark((function e(n,t,o,s,a){var c,l;return(0,i.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch(n,{method:"PATCH",headers:{"Content-Type":"application/json","X-CSRFToken":r("csrftoken")},body:JSON.stringify(t)});case 3:return c=e.sent,e.next=6,c.json();case 6:l=e.sent,s(l),o(!1),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),a(e.t0.message),o(!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(n,t,i,o,r){return e.apply(this,arguments)}}()},65246:function(e,n,t){t.r(n),t.d(n,{default:function(){return _e}});var i=t(1413),o=t(29439),r=t(63130),s=t(18791),a=t(24578),c=t(65173),l=t(7458),u=t(85535),d=t(66161),p=t(44390),v=t(44570),h=t(20495),f=t(52720),_=t(6334),g=t(31586),x=t(31342),y=t(77801),Z=t(13366),j=t(83960),m=t(7276),k=t(9229),b=t(2146),C=t(79921),w=t(25926),S=t(3442),E=(t(74042),t(54560)),A=t(969),T=t(46650),P=t(10567),I=t(78735),O=t(60103),R=t(26235),N=t(49321),L=t(34160),D=t(98085),M=t(89678),B=t(82778),W=t(45263);var U=function(e){var n=e.wsUrl,t=e.timeout,i=e.onClose,r=(0,m.useRef)(null),s=(0,m.useRef)(null),a=(0,m.useState)(!1),c=(0,o.Z)(a,2),l=c[0],d=c[1],p=(0,m.useState)(!1),v=(0,o.Z)(p,2),h=v[0],f=v[1],_=(0,m.useState)(t),g=(0,o.Z)(_,2),y=g[0],Z=g[1],j=(0,m.useCallback)((function(){if(r.current&&!s.current){var e=n.split("@")[0].split("://")[1];s.current=new B.Z(r.current,n,{credentials:{username:e.split(":")[0],password:e.split(":")[1]},scaleViewport:!0}),s.current.addEventListener("connect",(function(){console.log("Connected"),d(!0)})),s.current.addEventListener("disconnect",(function(){d(!1),f(!1),i()})),s.current.addEventListener("credentialsrequired",(function(){console.log("Credentials required")})),s.current.addEventListener("securityfailure",(function(){console.log("Security failure")})),s.current.addEventListener("capabilities",(function(){console.log("Capabilities")})),s.current.addEventListener("clipboard",(function(e){e.detail.text&&navigator.clipboard.writeText(e.detail.text)})),s.current.addEventListener("bell",(function(){console.log("Bell")})),s.current.addEventListener("desktopname",(function(){console.log("Desktop name")})),s.current.addEventListener("resize",(function(){console.log("Resize")})),s.current.addEventListener("focus",(function(){console.log("Focus")})),s.current.addEventListener("blur",(function(){console.log("Blur")}))}}),[n,i]);return(0,m.useEffect)((function(){if(n&&t&&!s.current){f(!0);var e=0,i=setInterval((function(){s.current||(j(),e++),(e>=10||s.current)&&clearInterval(i)}),1e3)}}),[n,t,j]),(0,m.useEffect)((function(){t&&i&&l&&setTimeout((function(){f(!1),i()}),1e3*t)}),[t,i,l]),(0,m.useEffect)((function(){t&&y>0&&setTimeout((function(){s.current&&Z(y-1)}),1e3)}),[t,y]),(0,W.jsxs)(E.Z,{open:h,onClose:i,fullWidth:!0,PaperProps:{style:{minWidth:"1070px",overflow:"scroll"}},children:[(0,W.jsxs)(A.Z,{children:["Remote Browser - ",y,"s left",(0,W.jsx)("br",{}),(0,W.jsx)(u.Z,{variant:"caption",children:"Login to your account and press DONE when you are finished."})]}),(0,W.jsxs)(T.Z,{children:[(0,W.jsx)("div",{ref:r}),!l&&"Connecting..."]}),(0,W.jsx)(L.Z,{children:(0,W.jsx)(x.Z,{onClick:function(){return i()},variant:"contained",children:"Done"})})]})};var z=function(e){var n=e.open,t=e.onCancelCb,r=e.onSaveCb,s=e.connection,a=(0,k.sJ)(w.w1),c=(0,m.useState)(a[0]||""),l=(0,o.Z)(c,2),u=l[0],d=l[1],v=(0,m.useState)((null===s||void 0===s?void 0:s.name)||""),h=(0,o.Z)(v,2),f=h[0],_=h[1],y=(0,m.useState)((null===s||void 0===s?void 0:s.description)||""),b=(0,o.Z)(y,2),C=b[0],B=b[1],z=(0,m.useState)((null===s||void 0===s?void 0:s.configuration)||{}),G=(0,o.Z)(z,2),F=G[0],K=G[1],q=(0,m.useState)(s||{}),J=(0,o.Z)(q,2),H=J[0],Y=J[1],V=(0,m.useState)([]),X=(0,o.Z)(V,2),Q=X[0],$=X[1],ee=(0,m.useState)(!1),ne=(0,o.Z)(ee,2),te=ne[0],ie=ne[1],oe=(0,m.useState)(!1),re=(0,o.Z)(oe,2),se=re[0],ae=re[1],ce=(0,m.useState)(""),le=(0,o.Z)(ce,2),ue=le[0],de=le[1],pe=(0,m.useState)(10),ve=(0,o.Z)(pe,2),he=ve[0],fe=ve[1],_e=(0,m.useState)(null),ge=(0,o.Z)(_e,2),xe=ge[0],ye=ge[1],Ze=(0,k._8)((function(e){var n=e.set;return function(){(0,S.o)().get("/api/connections").then((function(e){n(w.rN,e.data)})).catch((function(e){(0,j.yv)("Error loading connections",{variant:"error"})}))}})),je=function(){var e=[];return f||e.push("Connection name is required"),u||e.push("Connection type is required"),0===Object.keys(F).length&&"oauth2"!==u.base_connection_type&&e.push("Configuration is required"),!(e.length>0)||($(e),!1)},me=function(){_(""),B(""),K({}),t()},ke=function(e){return function(){je()&&r(e).then((function(e){if(Y(e),e.id){var n=new D.Ws("".concat("https:"===window.location.protocol?"wss":"ws","://").concat(window.location.host,"/ws/connections/").concat(e.id,"/activate"));n&&(ye(n),n.setOnMessage((function(e){var i=JSON.parse(e.data);"success"===i.event&&((0,j.yv)("Connection test successful",{variant:"success"}),ie(!0),n.close(),t(),Ze()),"error"===i.event&&((0,j.yv)("Connection test failed".concat(i.error?": ".concat(i.error):""),{variant:"error"}),n.close()),"output"===i.event&&i.output&&i.output.ws_url&&(de(i.output.ws_url),fe(i.output.timeout),ae(!0))})),n.send(JSON.stringify({event:"activate"})))}}))}};return(0,m.useEffect)((function(){setTimeout((function(){return K((null===s||void 0===s?void 0:s.configuration)||{})}),500)}),[s]),(0,m.useEffect)((function(){n&&$([])}),[n,f,C,F]),(0,m.useEffect)((function(){n&&(Y(s||{}),_((null===s||void 0===s?void 0:s.name)||""),B((null===s||void 0===s?void 0:s.description)||""),K((null===s||void 0===s?void 0:s.configuration)||{}),d(s?a.find((function(e){return e.provider_slug===(null===s||void 0===s?void 0:s.provider_slug)&&e.slug===(null===s||void 0===s?void 0:s.connection_type_slug)})):a[0]||""))}),[s,a,n]),(0,W.jsxs)(E.Z,{open:n,onClose:me,fullWidth:!0,children:[(0,W.jsx)(A.Z,{children:"".concat(s?"Edit":"Add"," Connection")}),(0,W.jsxs)(T.Z,{children:[Q.length>0&&(0,W.jsxs)(P.Z,{severity:"error",children:[(0,W.jsx)(I.Z,{children:"Errors in the form"}),(0,W.jsx)("ul",{children:Q.map((function(e,n){return(0,W.jsx)("li",{children:e},n)}))})]}),(0,W.jsx)("br",{}),(0,W.jsxs)(O.Z,{fullWidth:!0,sx:{gap:"10px"},children:[(0,W.jsx)(p.Z,{label:"Name",value:f,placeholder:"Enter a name for your connection",onChange:function(e){_(e.target.value),Y((0,i.Z)((0,i.Z)({},H),{},{name:e.target.value}))},variant:"outlined"}),(0,W.jsx)(p.Z,{label:"Description",placeholder:"Enter a description for your connection",value:C,onChange:function(e){B(e.target.value),Y((0,i.Z)((0,i.Z)({},H),{},{description:e.target.value}))},multiline:!0,variant:"outlined"})]}),(0,W.jsxs)(O.Z,{fullWidth:!0,sx:{margin:"20px 0 20px 0"},children:[(0,W.jsx)(g.Z,{id:"connection-type-label",children:"Connection Type"}),(0,W.jsx)(R.Z,{label:"Connection Type",labelId:"connection-type-label",value:u?"".concat(null===u||void 0===u?void 0:u.provider_slug,":").concat(null===u||void 0===u?void 0:u.slug):"",onChange:function(e){return d(a.find((function(n){return n.provider_slug===e.target.value.split(":")[0]&&n.slug===e.target.value.split(":")[1]})))},children:a.map((function(e){return{label:e.name,value:"".concat(e.provider_slug,":").concat(e.slug)}})).map((function(e,n){return(0,W.jsx)(N.Z,{value:e.value,children:e.label},n)}))})]}),(0,W.jsx)(g.Z,{children:"Configuration"}),"oauth2"===(null===u||void 0===u?void 0:u.base_connection_type)?(0,W.jsx)("div",{children:(0,W.jsx)(p.Z,{fullWidth:!0,disabled:!0,value:JSON.stringify(F),minRows:3,maxRows:3,multiline:!0})}):(0,W.jsx)(M.Z,{schema:(null===u||void 0===u?void 0:u.config_schema)||{type:"object",properties:{}},validator:Z.ZP,uiSchema:(0,i.Z)((0,i.Z)({},(null===u||void 0===u?void 0:u.config_ui_schema)||{}),{"ui:submitButtonOptions":{norender:!0},"ui:DescriptionFieldTemplate":function(){return null},"ui:TitleFieldTemplate":function(){return null}}),formData:F,onChange:function(e){var n=e.formData;ie(!1),K(n),Y((0,i.Z)((0,i.Z)({},H),{},{configuration:n}))},disableAdvanced:!0}),se&&(0,W.jsx)(U,{wsUrl:ue,timeout:he,onClose:function(){ae(!1),de(null),xe.send(JSON.stringify({event:"input",input:"terminate"}))}})]}),(0,W.jsxs)(L.Z,{children:[(0,W.jsx)(x.Z,{onClick:me,children:"Cancel"}),function(){switch(null===u||void 0===u?void 0:u.base_connection_type){case"oauth2":return"Active"===(null===s||void 0===s?void 0:s.status)?(0,W.jsx)(x.Z,{variant:"contained",onClick:function(){je()&&r((0,i.Z)((0,i.Z)((0,i.Z)({},s),H),{provider_slug:null===u||void 0===u?void 0:u.provider_slug,connection_type_slug:null===u||void 0===u?void 0:u.slug,configuration:F,base_connection_type:null===u||void 0===u?void 0:u.base_connection_type})).then((function(e){Y(e),t()}))},children:"Save"}):(0,W.jsx)(x.Z,{variant:"contained",onClick:function(){je()&&r((0,i.Z)((0,i.Z)((0,i.Z)({},s),H),{provider_slug:null===u||void 0===u?void 0:u.provider_slug,connection_type_slug:null===u||void 0===u?void 0:u.slug,configuration:F,base_connection_type:null===u||void 0===u?void 0:u.base_connection_type})).then((function(e){var n;Y(e),window.open(null===u||void 0===u||null===(n=u.metadata)||void 0===n?void 0:n.BtnLink)}))},children:null===u||void 0===u||null===(e=u.metadata)||void 0===e?void 0:e.BtnText});var e;case"browser_login":return(0,W.jsxs)("div",{children:[!te&&(0,W.jsx)(x.Z,{onClick:ke((0,i.Z)((0,i.Z)((0,i.Z)({},s),H),{provider_slug:null===u||void 0===u?void 0:u.provider_slug,connection_type_slug:null===u||void 0===u?void 0:u.slug})),variant:"contained",children:"Test Connection"}),te&&(0,W.jsx)(x.Z,{onClick:function(){return e=(0,i.Z)((0,i.Z)((0,i.Z)({},s),H),{provider_slug:null===u||void 0===u?void 0:u.provider_slug,connection_type_slug:null===u||void 0===u?void 0:u.slug}),void(je()&&r(e).then((function(e){_(""),B(""),K({}),Y({}),t()})));var e},variant:"contained",children:"Save"})]});case"credentials":return(0,W.jsxs)("div",{children:[!te&&"promptly"!==u.provider_slug&&(0,W.jsx)(x.Z,{onClick:ke((0,i.Z)((0,i.Z)((0,i.Z)({},s),H),{provider_slug:null===u||void 0===u?void 0:u.provider_slug,connection_type_slug:null===u||void 0===u?void 0:u.slug,configuration:F,base_connection_type:null===u||void 0===u?void 0:u.base_connection_type})),variant:"outlined",children:"Test Connection"}),"\xa0",(0,W.jsx)(x.Z,{onClick:function(){je()&&r((0,i.Z)((0,i.Z)((0,i.Z)({},s),H),{provider_slug:null===u||void 0===u?void 0:u.provider_slug,connection_type_slug:null===u||void 0===u?void 0:u.slug,configuration:F,base_connection_type:null===u||void 0===u?void 0:u.base_connection_type})).then((function(e){Y(e),e.id&&r((0,i.Z)((0,i.Z)({},e),{status:"Active"})).then((function(){t()}))}))},variant:"contained",children:"Save"})]});default:return null}}()]})]})},G=t(23109),F=t(34753),K=t(9340),q=t(62154),J=t(73462),H=t(58735),Y=t(20888),V=t(34867),X=t(71516),Q={width:"10px",height:"10px"};function $(e){var n=e.connection,t=e.setConnection,o=e.setOpenConnectionModal,r=e.setDeleteConnectionModal;return(0,W.jsxs)(K.Z,{children:[(0,W.jsxs)(q.Z,{children:[(0,W.jsx)(u.Z,{variant:"h7",children:n.name}),(0,W.jsx)(u.Z,{variant:"caption",sx:{display:"block",color:"#999"},children:n.description})]}),(0,W.jsx)(q.Z,{sx:{textAlign:"center",width:"20px"},children:(0,W.jsx)(h.Z,{title:n.status,children:(0,W.jsxs)(d.Z,{children:["Created"===n.status&&(0,W.jsx)(J.Z,{sx:(0,i.Z)((0,i.Z)({},Q),{backgroundColor:"#ccc"})}),"Connecting"===n.status&&(0,W.jsx)(J.Z,{color:"warning",sx:Q}),"Active"===n.status&&(0,W.jsx)(J.Z,{color:"success",sx:Q}),"Failed"===n.status&&(0,W.jsx)(J.Z,{color:"error",sx:Q})]})})}),(0,W.jsx)(q.Z,{sx:{width:"20px"},children:(0,W.jsx)(v.Z,{size:"small",onClick:function(){t(n),o(!0)},children:(0,W.jsx)(G.Z,{})})}),(0,W.jsx)(q.Z,{sx:{width:"20px"},children:(0,W.jsx)(v.Z,{size:"small",onClick:function(){t(n),r(!0)},children:(0,W.jsx)(F.Z,{sx:function(e){return{color:e.palette.error.main}}})})})]})}var ee=function(e){var n=e.setConnection,t=e.setOpenConnectionModal,i=e.setDeleteConnectionModal,o=(0,k.sJ)(w.rN);return(0,W.jsxs)(f.Z,{sx:{width:"100%"},children:[!o||0===o.length&&(0,W.jsxs)(P.Z,{severity:"info",sx:{textAlign:"left"},children:[(0,W.jsx)(I.Z,{children:"No connections found"}),"Add a connection using the ",(0,W.jsx)("strong",{children:"+ Connection"})," button"]}),o&&o.length>0&&(0,W.jsx)(H.Z,{children:(0,W.jsxs)(Y.Z,{children:[(0,W.jsx)(V.Z,{children:(0,W.jsxs)(K.Z,{children:[(0,W.jsx)(q.Z,{children:(0,W.jsx)("strong",{children:"Name"})}),(0,W.jsx)(q.Z,{children:(0,W.jsx)("strong",{children:"Status"})}),(0,W.jsx)(q.Z,{children:(0,W.jsx)("strong",{children:"Edit"})}),(0,W.jsx)(q.Z,{children:(0,W.jsx)("strong",{children:"Delete"})})]})}),(0,W.jsx)(X.Z,{children:o.map((function(e){return(0,W.jsx)($,{connection:e,setConnection:n,setOpenConnectionModal:t,setDeleteConnectionModal:i},e.id)}))})]})})]})},ne=t(12283);var te=function(e){var n=e.open,t=e.onCancelCb,i=e.onDeleteCb,r=e.connection,s=(0,m.useState)(""),a=(0,o.Z)(s,2),c=a[0],l=a[1];return n&&r?(0,W.jsxs)(E.Z,{open:n,onClose:t,fullWidth:!0,children:[(0,W.jsx)(A.Z,{children:"Delete Connection"}),(0,W.jsxs)(T.Z,{children:[(0,W.jsx)(ne.Z,{children:(0,W.jsx)(P.Z,{severity:"warning",children:"Are you sure you want to delete ".concat(r.name,"? This action cannot\n            be undone.")})}),(0,W.jsx)(p.Z,{autoFocus:!0,margin:"dense",id:"name",label:"DELETE",placeholder:"Type DELETE to confirm",type:"text",fullWidth:!0,variant:"standard",value:c,required:!0,onChange:function(e){return l(e.target.value)}})]}),(0,W.jsxs)(L.Z,{children:[(0,W.jsx)(x.Z,{onClick:t,variant:"outlined",style:{textTransform:"none"},children:"Cancel"}),(0,W.jsx)(x.Z,{onClick:function(){return i(r).finally((function(){return t()}))},variant:"contained",style:{textTransform:"none"},disabled:"DELETE"!==c,children:"Delete"})]})]}):null};var ie=function(){var e=(0,m.useState)(!1),n=(0,o.Z)(e,2),t=n[0],i=n[1],r=(0,m.useState)(!1),s=(0,o.Z)(r,2),a=s[0],c=s[1],d=(0,m.useState)(null),p=(0,o.Z)(d,2),v=p[0],h=p[1],f=(0,k._8)((function(e){var n=e.set;return function(){(0,S.o)().get("/api/connections").then((function(e){n(w.rN,e.data)})).catch((function(e){(0,j.yv)("Error loading connections",{variant:"error"})}))}}));return(0,W.jsxs)(l.Z,{children:[(0,W.jsx)(u.Z,{variant:"h6",className:"section-header",children:"Connections"}),(0,W.jsx)(x.Z,{startIcon:(0,W.jsx)(b.Z,{}),variant:"contained",sx:{textTransform:"none",margin:"10px",marginLeft:"auto",marginRight:0},onClick:function(){h(null),i(!0)},children:"Connection"}),(0,W.jsx)(ee,{setConnection:h,setOpenConnectionModal:i,setDeleteConnectionModal:c}),(0,W.jsx)(z,{open:t,connection:v,onCancelCb:function(){i(!1),h(null)},onSaveCb:function(e){return function(e){return new Promise((function(n,t){if(!e||0===Object.keys(e).length)return(0,j.yv)("Invalid connection information provided",{variant:"error"}),void t(new Error("Invalid connection information provided"));e.id?(0,S.o)().patch("/api/connections/".concat(e.id),e).then((function(e){(0,j.yv)("Connection updated successfully",{variant:"success"}),f(),n(e.data)})).catch((function(e){(0,j.yv)("Error updating connection",{variant:"error"}),t(e)})):((0,S.o)().post("/api/connections",e).then((function(e){(0,j.yv)("Connection created successfully",{variant:"success"}),f(),n(e.data)})).catch((function(e){console.log(e),(0,j.yv)("Error creating connection",{variant:"error"}),t(e)})),C.ZP.event({category:"Connections",action:"Create Connection",label:e.connection_type_slug,transport:"beacon"}))}))}(e)}}),(0,W.jsx)(te,{open:a,onCancelCb:function(){return c(!1)},onDeleteCb:function(e){return function(e){return new Promise((function(n,t){if(!e||!e.id)return(0,j.yv)("Invalid connection information provided",{variant:"error"}),void t(new Error("Invalid connection information provided"));(0,S.o)().delete("/api/connections/".concat(e.id)).then((function(e){(0,j.yv)("Connection deleted successfully",{variant:"success"}),f(),n(e.data)})).catch((function(e){console.log(e),(0,j.yv)("Error deleting connection",{variant:"error"}),t(e)}))}))}(e)},connection:v})]})},oe=t(63716),re=t(96168),se=t(10981),ae=t(61280),ce=t(94224),le=t(72959),ue=function(e){var n=e.open,t=e.handleCloseCb,i=(0,m.useState)([]),r=(0,o.Z)(i,2),s=r[0],a=r[1],c=(0,m.useState)(""),d=(0,o.Z)(c,2),p=d[0],v=d[1],h=(0,m.useState)(!1),f=(0,o.Z)(h,2),g=f[0],y=f[1],Z=(0,m.useState)(!1),k=(0,o.Z)(Z,2),b=k[0],C=k[1],w=(0,m.useState)(!1),P=(0,o.Z)(w,2),I=P[0],R=P[1];return(0,m.useEffect)((function(){(0,S.o)().get("/api/subscriptions/prices").then((function(e){a(e.data.prices||[])})).catch((function(e){(0,j.yv)("Error loading subscription prices",{variant:"error"})}))}),[]),(0,W.jsxs)(E.Z,{open:n,onClose:t,fullWidth:!0,children:[(0,W.jsx)(A.Z,{children:"Upgrade Subscription"}),(0,W.jsxs)(T.Z,{children:[(0,W.jsxs)(u.Z,{variant:"body1",children:["Choose a subscription plan to upgrade to. To compare the features of each plan, please visit our"," ",(0,W.jsx)("a",{href:"https://www.trypromptly.com/#pricing",target:"_blank",rel:"noreferrer",children:"pricing page"}),"."]}),(0,W.jsx)("br",{}),(0,W.jsx)(O.Z,{children:(0,W.jsx)(re.Z,{overlay:!0,name:"subscriptions",defaultValue:"",row:!0,sx:{gap:4},children:s.map((function(e){return(0,W.jsxs)(se.Z,{component:"label",sx:{width:"150px",height:"150px"},children:[(0,W.jsx)(ae.Z,{title:e.product_name,subheader:(0,W.jsx)(_.Z,{}),sx:{padding:0}}),(0,W.jsx)(ce.Z,{children:(0,W.jsxs)(l.Z,{children:[(0,W.jsxs)(u.Z,{variant:"h5",children:["$",e.unit_amount," /"," ",e.recurring_interval]}),(0,W.jsx)(le.Z,{variant:"soft",value:e.id,onChange:function(e){v(e.target.value)},sx:{mb:4}})]})})]},e.id)}))})})]}),(0,W.jsxs)(L.Z,{children:[(0,W.jsx)(x.Z,{disabled:I,onClick:t,sx:{textTransform:"none"},children:"Cancel"}),(0,W.jsx)(oe.Z,{disabled:b||!p,loading:g,onClick:function(){var e;R(!0),C(!0),y(!0),(0,S.o)().post("/api/subscriptions/checkout",{price_id:p,rewardful_referral_id:(null===(e=window.Rewardful)||void 0===e?void 0:e.referral)||null}).then((function(e){(0,j.yv)("Loading Checkout Page",{variant:"success"}),window.location.href=e.data.checkout_session_url})).catch((function(e){})).finally((function(){R(!1),C(!1),y(!1)}))},variant:"contained",children:"Checkout"})]})]})};var de=function(e){var n=(0,m.useState)(!1),t=(0,o.Z)(n,2),i=t[0],r=t[1],s=(0,k.sJ)(w.Dg),a=(0,k.sJ)(w.bR);return(0,W.jsxs)(l.Z,{sx:{margin:"0 10px 60px 10px"},children:[(0,W.jsxs)(l.Z,{children:[(0,W.jsx)(u.Z,{variant:"h6",className:"section-header",sx:{marginBottom:"8px"},children:"Subscription"}),(0,W.jsx)(l.Z,{children:(0,W.jsx)(f.Z,{children:(0,W.jsxs)(l.Z,{children:[(0,W.jsxs)("p",{style:{display:s.IS_ORGANIZATION_MEMBER?"none":"block"},children:["Logged in as\xa0",(0,W.jsx)("strong",{children:e.user_email}),". You are currently subscribed to\xa0",(0,W.jsx)("strong",{children:s.IS_PRO_SUBSCRIBER?"Pro":s.IS_BASIC_SUBSCRIBER?"Basic":"Free"}),"\xa0tier. Click on the Manage Subscription button below to change your plan.\xa0",(0,W.jsx)("br",{}),(0,W.jsx)("br",{}),(0,W.jsx)("i",{children:"Note: You will be redirected to Stripe payment portal to complete the upgrade payment process."})]}),(0,W.jsxs)("p",{style:{display:s.IS_ORGANIZATION_MEMBER?"block":"none"},children:["Logged in as ",(0,W.jsx)("strong",{children:e.user_email}),". Your account is managed by your organization,\xa0",(0,W.jsx)("strong",{children:null===a||void 0===a?void 0:a.name}),". Please contact your admin to manage your subscription."]})]})})}),i&&(0,W.jsx)(ue,{open:i,handleCloseCb:function(){r(!1)}})]}),!s.IS_ORGANIZATION_MEMBER&&(0,W.jsx)(x.Z,{variant:"contained",sx:{marginTop:"10px",display:s.IS_ORGANIZATION_MEMBER?"none":"inherit",alignSelf:"end"},onClick:function(){r(!0)},disabled:s.IS_PRO_SUBSCRIBER,children:"Manage Subscription"})]})},pe=t(67728),ve=(0,y.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),he={type:"object",properties:{openai_key:{type:"string",title:"OpenAI API Key"},stabilityai_key:{type:"string",title:"StabilityAI API Key"},cohere_key:{type:"string",title:"Cohere API Key"},elevenlabs_key:{type:"string",title:"Elevenlabs API Key"},google_service_account_json_key:{type:"string",title:"Google Credentials"},azure_openai_api_key:{type:"string",title:"Azure OpenAI API Key"},anthropic_api_key:{type:"string",title:"Anthropic API Key"},localai_base_url:{type:"string",title:"LocalAI Base URL"},localai_api_key:{type:"string",title:"LocalAI API Key"}}},fe={openai_key:{"ui:widget":"password","ui:default":""},stabilityai_key:{"ui:widget":"password","ui:default":""},cohere_key:{"ui:widget":"password","ui:default":""},elevenlabs_key:{"ui:widget":"password","ui:default":""},google_service_account_json_key:{"ui:widget":"password","ui:help":"Add your Google Service Account JSON file content as base64 encoded string or paste the API key.","ui:default":""},azure_openai_api_key:{"ui:widget":"password","ui:default":""},localai_base_url:{"ui:widget":"text","ui:help":"LocalAI base URL here if you want to use a self-hosted LocalAI","ui:default":""},localai_api_key:{"ui:widget":"password","ui:help":"LocalAI API key if your instance needs authentication","ui:default":""},anthropic_api_key:{"ui:widget":"password","ui:default":""}},_e=function(){var e=(0,m.useState)({token:"",openai_key:"",stabilityai_key:"",cohere_key:"",forefrontai_key:"",elevenlabs_key:"",localai_api_key:"",localai_base_url:"",azure_openai_api_key:"",google_service_account_json_key:"",anthropic_api_key:"",logo:""}),n=(0,o.Z)(e,2),t=n[0],y=n[1],b=(0,m.useState)(!0),C=(0,o.Z)(b,2),S=C[0],E=C[1],A=(0,m.useState)(new Set),T=(0,o.Z)(A,2),P=T[0],I=T[1],O=(0,k.sJ)(w.Dg),R=(0,m.createRef)();(0,m.useEffect)((function(){(0,pe.rQ)("api/profiles/me",(function(){}),(function(e){y({token:e.token,openai_key:e.openai_key,stabilityai_key:e.stabilityai_key,cohere_key:e.cohere_key,forefrontai_key:e.forefrontai_key,elevenlabs_key:e.elevenlabs_key,google_service_account_json_key:e.google_service_account_json_key,azure_openai_api_key:e.azure_openai_api_key,localai_api_key:e.localai_api_key,localai_base_url:e.localai_base_url,anthropic_api_key:e.anthropic_api_key,logo:e.logo,user_email:e.user_email}),E(!1)}));var e=new URLSearchParams(window.location.search);e.get("showNotification")&&(0,j.yv)(e.get("notificationMessage")||"",{variant:e.get("notificationType")||"info"})}),[]);return(0,W.jsx)("div",{id:"setting-page",children:S?(0,W.jsx)(a.Z,{}):(0,W.jsxs)(c.ZP,{container:!0,sx:{m:1},children:[(0,W.jsx)(c.ZP,{item:!0,xs:12,md:6,children:(0,W.jsxs)(l.Z,{spacing:2,sx:{textAlign:"left"},children:[(0,W.jsx)(u.Z,{variant:"h6",className:"section-header",children:"Settings"}),(0,W.jsxs)(d.Z,{sx:{padding:"15px 0"},children:[(0,W.jsx)(p.Z,{label:"Promptly Token",value:t.token,fullWidth:!0,variant:"outlined",size:"medium",InputProps:{readOnly:!0,endAdornment:(0,W.jsx)(v.Z,{onClick:function(e){navigator.clipboard.writeText(t.token),(0,j.yv)("Token copied successfully",{variant:"success"})},children:(0,W.jsx)(h.Z,{title:"Copy Promptly API Token",children:(0,W.jsx)(r.Z,{fontSize:"small"})})})}}),(0,W.jsxs)(u.Z,{variant:"caption",children:["This is your API token. You can use this token to access",{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GA_MEASUREMENT_ID:"G-XZ40100Y5C"}.REACT_APP_SITE_NAME," API directly. Please do not share this token with anyone."]})]}),(0,W.jsx)(f.Z,{sx:{width:"100%"},children:(0,W.jsxs)(l.Z,{gap:2,padding:1,spacing:2,children:[(0,W.jsx)(M.Z,{schema:he,uiSchema:fe,formData:t,validator:Z.ZP,disableAdvanced:!0,onChange:function(e){var n=(0,i.Z)((0,i.Z)({},t),e.formData);I(new Set(Object.keys(n).filter((function(n){return e.formData[n]!==t[n]})))),y(n)},formRef:R,customValidate:function(e,n,t){return n}}),(0,W.jsx)(_.Z,{}),(0,W.jsxs)(d.Z,{sx:{my:2},children:[(0,W.jsx)(g.Z,{children:"Custom Logo"}),t.logo&&(0,W.jsx)("img",{src:t.logo,alt:"Logo",style:{height:50,margin:10,display:"block"}}),(0,W.jsx)(h.Z,{title:O.CAN_UPLOAD_APP_LOGO?"":"You need to be a Pro subscriber to upload a custom logo",children:(0,W.jsxs)(x.Z,{component:"label",variant:"outlined",startIcon:(0,W.jsx)(s.Z,{}),disabled:!O.CAN_UPLOAD_APP_LOGO,children:["Upload",(0,W.jsx)(ve,{type:"file",accept:"image/*",disabled:!O.CAN_UPLOAD_APP_LOGO,onChange:function(e){var n=e.target.files;if(n&&n.length>0){var o=new FileReader;o.readAsDataURL(n[0]),o.onload=function(e){var n;y((0,i.Z)((0,i.Z)({},t),{},{logo:null===(n=e.target)||void 0===n?void 0:n.result})),I(P.add("logo"))}}}})]})})]})]})}),(0,W.jsx)(x.Z,{variant:"contained",sx:{alignSelf:"end",width:"fit-content"},onClick:function(){!function(e){E(!0);var n={};e.forEach((function(e){n[e]=t[e]})),(0,pe.B6)("api/profiles/me",n,(function(e){E(e)}),(function(e){y({token:e.token,openai_key:e.openai_key,stabilityai_key:e.stabilityai_key,cohere_key:e.cohere_key,forefrontai_key:e.forefrontai_key,elevenlabs_key:e.elevenlabs_key,google_service_account_json_key:e.google_service_account_json_key,azure_openai_api_key:e.azure_openai_api_key,localai_api_key:e.localai_api_key,localai_base_url:e.localai_base_url,anthropic_api_key:e.anthropic_api_key,logo:e.logo}),E(!1),(0,j.yv)("Profile updated successfully",{variant:"success"})}),(function(){}))}(P)},children:"Update"})]})}),(0,W.jsx)(c.ZP,{item:!0,xs:12,md:6,sx:{p:0},children:(0,W.jsxs)(l.Z,{sx:{margin:"0 10px",marginBottom:"60px"},spacing:4,children:[(0,W.jsx)(ie,{}),"true"==={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_GA_MEASUREMENT_ID:"G-XZ40100Y5C"}.REACT_APP_ENABLE_SUBSCRIPTION_MANAGEMENT&&(0,W.jsx)(de,{user_email:t.user_email})]})})]})})}},98085:function(e,n,t){t.d(n,{Ws:function(){return r}});var i=t(15671),o=t(43144),r=function(){function e(n){(0,i.Z)(this,e),this.url=n,this.ws=null,this.onMessage=null,this.queue=[]}return(0,o.Z)(e,[{key:"status",value:function(){return this.ws.readyState}},{key:"connect",value:function(){var e=this;this.ws=new WebSocket(this.url),this.ws.onmessage=this.onMessage,this.ws.onopen=function(){e.queue.forEach((function(n){e.ws.send(n)})),e.queue=[]},this.ws.onclose=function(){console.log("Websocket closed")}}},{key:"send",value:function(e){null===this.ws&&this.connect(),this.ws.readyState===WebSocket.CONNECTING?this.queue.push(e):this.ws.readyState===WebSocket.OPEN?this.ws.send(e):(this.queue.push(e),this.connect())}},{key:"close",value:function(){this.ws.close()}},{key:"setOnMessage",value:function(e){this.onMessage=e}}]),e}()}}]);